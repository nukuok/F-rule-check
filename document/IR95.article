1 Introduction 

1.1 Overview 

This document describes a SIP/SDP profile for interconnection and roaming NNI between 
operators IMS networks for the purposes of exchanging traffic originating from and 
terminating to the respective operatorsÅf customers. This document profiles SIP/SDP for the 
GSMA defined IMS based services ( (VoLTE, Video Call, SMSoIP, and RCS services) as 
described in the relevant GSMA PRDs cited in clause 2. 

This profile is intended to be a generic NNI profile that may be applied to any such inter-
operator interconnect, including IPX and direct bilateral interconnect on regional and 
international basis, thereby promoting commonality and facilitating interoperability. Where 
options are supported based on bilateral agreement, such agreement is between the 
respective Operators or between Operator and IPX Provider dependent on the type of 
interconnect. 

It is also acknowledged that some organizations may still wish to define national specific 
interconnect profiles. Whilst it is hoped that such national specific variants can be avoided, 
this document may also be used as a basis for such national specific variants and thereby 
minimising duplication of effort. 

1.2 Relationship to Existing Standards 

This document is a profile of 3GPP Release-11 TS 29.165 [1] and provides clarifications and 
recommendations to that technical specification to facilitate inter-IMS NNI inter-operability. 
The requirements are derived from GSMA PRDs for the provision of IMS based voice, video 
and RCS services. 

The VoLTE, Video Call, SMSoIP,and RCS services are described in the following GSMA 
PRDs: 

. IR.92 . IMS Profile for Voice and SMS [2] 
. IR.94 . IMS Profile for Conversational Video Service [3] 
. IR.84 . Video Share Phase 2 Interoperability Specification [7] 
. IR.79 . Image Share Interoperability Specification [8] 
. RCC.07 . RCS Advanced Communications Services & Client Specification [44] 


The NNI aspects are described in the following GSMA PRDs: 

. IR.65 . IMS Roaming NNI and Interworking Guidelines [4] 
. IR.88 . LTE Roaming NNI Guidelines [6] 
. IR.90 . RCS Interworking Guidelines [5] 


1.3 Scope 

This document specifies a SIP/SDP profile across the inter-IMS NNI in support of VoLTE, 
Video Call, SMSoIP, and RCS services. The VoLTE and Video Call Services are based on 
3GPP MMTel, specifically the sub-set of MMTel services as described in GSMA PRDs IR.92 
[2] and IR.94 [3]. In the remainder of this document, the Voice and Video Call supplementary 
services shall be referred to as MMTel services. 


The exact set of services to be supported is determined by mutual agreement between 
operators. Where a reduced set of services is agreed, an appropriate subset of this profile is 
applicable. 

There are two aspects for the NNI profiled within this document, namely the Interconnect 
NNI and the Roaming NNI which are defined as below: 

. Interconnect-NNI . This term applies when the NNI is used to exchange traffic 
between the serving network (home or visited network) of the originating device, and 
the home network of the called party.. 
. Roaming NNI . This term applies when the NNI is used to exchange traffic between 
the home and visited networks of a roaming device, i.e. when using Local Break-Out 
(LBO) where the P-CSCF is in the Visited Network. It is also inclusive of a scenario 
whereby the IMS core network is under different administrative control to the home 
OperatorÅfs access network (i.e. hosted solution). 


Note: The use of the specification in support of fixed line access is not precluded. 

1.4 Definition of Terms 

Term 

Description 

3GPP 

3rd Generation Partnership Project 

AMR 

Adaptive Multi-Rate 

AMR-WB 

AMR Wide Band 

CONF 

Conference (MMTel Service) 

CPM 

Converged IP Messaging 

DTMF 

Dual Tone Multi Frequency 

ECT 

Explicit Communication Transfer (MMTel Service) 

EVRC 

Enhanced Variable Rate Codec 

GSMA 

GSM Association 

IBCF 

Interconnection Border Control Function 

IETF 

Internet Engineering Task Force 

II-NNI 

Inter-IMS Network to Network Interface 

IMDN 

Instant Message Delivery Notification 

IMS 

IP Multimedia Subsystem 

IP 

Internet Protocol 

IPX 

IP Exchange 

ISDN 

Integrated Services Digital Network 

ITU 

International Telecommunications Union 

ITU-T 

Telecoms Standardization Sector of ITU 

MCID 

Malicious Call Identification (MMTel Service) 

MIME 

Multipurpose Internet Mail Extensions 

MMTel 

Multimedia Telephony 

MSRP 

Message Sending Relay Protocol 




Term 

Description 

NNI 

Network-Network Interface 

OMA 

Open Mobile Alliance 

PRD 

Permanent Reference Document 

RAVEL 

Roaming Architecture for Voice over IMS with Local Breakout 

RCS 

Rich Communications Services 

RFC 

Request For Comments 

RTCP 

Real Time Control Protocol 

RTP 

Real Time Protocol 

SCTP 

Stream Control Transmission Protocol 

SDP 

Session Description Protocol 

SIP 

Session Initiation Protocol 

SMS 

Short Messaging Service 

SIMPLE 

SIP for Instant Messaging and Presence Leveraging Extensions 

SRVCC 

Single Radio Voice Call Continuity 

TCP 

Transmission Control Protocol 

TrGW 

Transition Gateway 

TS 

Technical Specification 

UDP 

User Datagram Protocol 

VBD 

Voice Band Data 

XDM 

XML Document Management 

XML 

Extended Mark-up Language 



1.5 Document Cross-

Ref 

Doc Number 

Title 

[1] 


3GPP TS 29.165 R11 

Inter-IMS Network-Network Interface (NNI) 

[2] 


GSMA PRD IR.92 

IMS Profile for Voice and SMS 

[3] 


GSMA PRD IR.94 

IMS Profile for Conversational Video Service 

[4] 


GSMA PRD IR.65 

IMS Roaming NNI and Interworking Guidelines 

[5] 


GSMA PRD IR.90 

RCS Interworking Guidelines 

[6] 


GSMA PRD IR.88 

LTE Roaming NNI Guidelines 

[7] 


GSMA PRD IR.84 

Video Share Phase 2 Interoperability Specification 

[8] 


GSMA PRD IR.79 

Image Share Interoperability Specification 

[9] 


3GPP TS 26.114 

IP Multimedia Subsystem (IMS); Multimedia Telephony; Media 
handling and interaction 

[10] 


ETSI TS 181 005 

Service & Capability Requirements 

[11] 


IETF RFC 3264 

An Offer/Answer Model with the Session Description Protocol 
(SDP) 

[12] 


IETF RFC 3261 

Session Initiation Protocol (SIP) 

[13] 


IETF RFC 4566 

Session Description Protocol (SDP) 




Ref 

Doc Number 

Title 

[14] 


IETF RFC 3262 

Reliability of Provisional Responses in the Session Initiation 
Protocol (SIP) 

[15] 


IETF RFC 3312 

Integration of Resource Management and Session Initiation 
Protocol (SIP) 

[16] 


IETF RFC 4028 

Session Timers in the Session Initiation Protocol (SIP) 

[17] 


3GPP TS 29.238 

Interconnection Border Control Function (IBCF) . Transition 
Gateway (TrGW) interface, Ix Interface; Stage 3 

[18] 


IETF RFC 3556 

SDP Bandwidth Modifiers for RTCP bandwidth 

[19] 


IETF RFC 3891 

The Session Initiation Protocol (SIP) ÅgReplacesÅh Header 

[20] 


IETF RFC 3327 

Session Initiation Protocol (SIP) Extension Header Field for 
Registering Non-Adjacent Contacts 

[21] 


IETF RFC 4488 

Suppression of Session Initiation Protocol (SIP) REFER Method 
Implicit Subscription 

[22] 


IETF RFC 4733 

RTP Payload for DTMF Digits, Telephony Tones and Telephony 
Signals 

[23] 


GSMA PRD IR.67 

DNS/ENUM Guidelines for Service Providers and GRX/IPX 
Providers 

[24] 


ITU-T Rec. T.140 
(1998) 

Text Conversation Protocol for multimedia application, with 
amendment 1 (2000) 

[25] 


IETF RFC 4013 

RTP Payload for Text Conversation 

[26] 


3GPP TS 33.210 

3G Security; Network Domain Security (NDS); IP Network Layer 
Security 

[27] 


IETF RFC 4303 

IP Encapsulating Security Payload (ESP) 

[28] 


IETF RFC 5368 

Referring to Multiple Resources in the Session Initiation 
Protocol (SIP) 

[29] 


ITU-T Rec. H.263 
(2005) 

Video Coding for low bit rate communication 

[30] 


IETF RFC 3984 

RTP Payload format for ITU-T Rec. H.264 Video 

[31] 


ITU-T Rec. H.264 
(2005) 

Advanced video coding for generic audiovisual services 
ISO/IEC 14496-10:2005: ÅgInformation technology . Coding of 
audio-visual objects . Part 10: Advanced Video CodingÅh 

[32] 


IETF RFC 3551 

RTP Profile for Audio Video Conferences with Minimal Control 

[33] 


IETF RFC 4585 

Extended RTP Profile for Real Time Control Protocol (RTCP)-
Based Feedback (RTP/AVPF) 

[34] 


OMA CPM 

OMA CPM Conversation Functions (OMA-CPM-
TS_Conv_Func-V1_0-20120612-A) 

[35] 


IETF RFC 5939 

Session Description Protocol (SDP) Capability Negotiation 

[36] 


IETF RFC 4103 

RTP Payload for Text Conversation 

[37] 


3GPP TS 29.079 

Optimal Media Routing within the IP Multimedia System (IMS); 
Stage 3 

[38] 


IETF RFC 5621 

Message Body Handling in the Session Initiation Protocol (SIP) 

[39] 


IETF RFC 5547 

A Session Description Protocol (SDP) Offer/Answer Mechanism 




Ref 

Doc Number 

Title 

to enable File Transfer 

[40] 


IETF RFC 4483 

A Mechanism for Content Indirection in Session Initiation 
Protocol (SIP) Messages 

[41] 


IETF RFC 5438 

Instant Message Disposition Notification 

[42] 


IETF RFC 3842 

A Message Summary and Message Waiting Indication Event 
Package for the Session Initiation Protocol (SIP) 

[43] 


IETF RFC 4575 

A Session Initiation Protocol (SIP) Event Package for 
Conference State 

[44] 


GSMA PRD RCC.07 

RCS Advanced Communications Services & Client 
Specification 

[45] 


3GPP TS 29.163 

Interworking between IP Multimedia (IM) Core Network (CN) 
subsystem and Circuit Switched networks 

[46] 


IETF RFC 3966 

The Tel URI for telephone numbers 

[47] 


3GPP TS 24.341 

Support of SMS over IP networks; Stage 3 

[48] 


IETF RFC 4244 

An extension to the Session Initiation Protocol (SIP) for Request 
History Information 

[49] 


IETF RFC 4916 

Connected Identity in the Session Initiation Protocol (SIP) 

[50] 


IETF RFC 3680 

A Session Initiation Protocol (SIP) Event Package for 
registration 

[51] 


IETF RFC 3515 

The Session Initiation Protocol (SIP) Refer method 

[52] 


IETF RFC 3840 

Indicating User Agent Capabilities in the Session Initiation 
Protocol (SIP) 

[53] 


IETF RFC 3856 

A Presence Event Package for the Session Initiation Protocol 
(SIP) 

[54] 


IETF RFC 3857 

A Watcher-Information Event Template Package for the 
Session Initiation Protocol (SIP) 

[55] 


IETF RFC 3858 

An Extensible Mark-Up Language (XML) based format for 
Watcher Information 

[56] 


IETF RFC 3863 

Presence Information Data Format (PIDF) 

[57] 


IETF RFC 4479 

A data model for Presence 

[58] 


IETF RFC 4975 

The Message Session Relay Protocol (MSRP) 

[59] 


IETF RFC 5364 

Extensible Markup Language (XML) Format Extension for 
Representing Copy Control Attributes in Resource Lists 

[60] 


IETF RFC 5366 

Conference Establishment Using Request-Contained Lists in 
the Session Initiation Protocol (SIP) 

[61] 


IETF RFC 5368 

Referring to Multiple Resources in the Session Initiation 
Protocol (SIP) 

[62] 


3GPP TS 29.658 

SIP Transfer of IP Multimedia Tariff Information; Protocol 
Specification. 

[63] 


3GPP TS 24.337 

IP Multimedia (IM) Core Network (CN) Subsystem; IP 
Multimedia Subsystem (IMS) Inter UE Transfer; Stage 3 

[64] 


3GPP TS 24.237 

IP Multimedia (IM) Core Network (CN) Subsystem; IP 




Ref 

Doc Number 

Title 

Multimedia Subsystem (IMS) Service Continuity; Stage 3 

[65] 


IETF RFC 5627 

Obtaining and using Globally Routable User Agent URIs 
(GRUUs) in the Session Initiation Protocol (SIP) 

[66] 


IETF RFC 4412 

Communications Resource Priority in the Session Initiation 
Protocol (SIP). 

[67] 


3GPP TS 24.628 

Common Basic Communication procedures using IP Multimedia 
(IM) Core Network (CN) subsystem; Protocol specification 

[68] 


3GPP TS 24.229 

IP multimedia call control protocol based on Session Initiation 
Protocol (SIP) and Session Description Protocol (SDP);Stage 3 

[69] 


3GPP TS 29.162 

Interworking between the IMS CN Subsystem and IP Networks 

[70] 


3GPP TS 26.071 

Mandatory speech CODEC speech processing functions; AMR 
speech Codec; General description 

[71] 


3GPP TS 26.090 

Mandatory Speech Codec speech processing functions; 
Adaptive Multi-Rate (AMR) speech codec; Transcoding 
functions 

[72] 


3GPP TS 26.073 

ANSI C code for the Adaptive Multi Rate (AMR) speech codec 

[73] 


3GPP TS 26.104 

ANSI-C code for the floating-point Adaptive Multi-Rate (AMR) 
speech codec 

[74] 


3GPP TS 26.093 

Mandatory speech codec speech processing functions Adaptive 
Multi-Rate (AMR) speech codec; Source controlled rate 
operation 

[75] 


3GPP TS 26.171 

Speech codec speech processing functions; Adaptive Multi-
Rate . Wideband (AMR-WB) speech codec; General 
description 

[76] 


3GPP TS 26.173 

ANSI-C code for the Adaptive Multi-Rate . Wideband (AMR-
WB) speech codec 

[77] 


3GPP TS 26.190 

Speech codec speech processing functions; Adaptive Multi-
Rate . Wideband (AMR-WB) speech codec; Transcoding 
functions 

[78] 


3GPP TS 26.193 

Speech codec speech processing functions; Adaptive Multi-
Rate . Wideband (AMR-WB) speech codec; Source controlled 
rate operation 

[79] 


3GPP TS 26.204 

Speech codec speech processing functions; Adaptive Multi-
Rate . Wideband (AMR-WB) speech codec; ANSI-C code 

[80] 


3GPP TS 23.228 

IP Multimedia Subsystem (IMS); Stage 2 

[81] 


IETF RFC 7329 

A Session Identifier for the Session Initiation Protocol (SIP) 

[82] 


IETF RFC 6086 

Session Initiation Protocol (SIP) INFO Method and Package 
Framework 



Note: Unless otherwise stated, the latest version of the referenced specifications applies. 

2 Applicable Services 

As stated previously, this profile supports VoLTE, Video Call, SMSoIP, and RCS services. 
The RCS Services include all of the following: 


. Capability Exchange based on SIP OPTIONS (Note 1) 
. Capability Exchange via Presence (Note 1) 
. Social Presence Information based on OMA SIMPLE Presence and XML Document 
Management (XDM) 
. Chat based on OMA SIMPLE IM and Converged IP Messaging (CPM) 
. Standalone messaging based on OMA CPM 
. File Transfer based on OMA SIMPLE IM and CPM 
. Video Share based on GSMA PRD IR.84 [7] 
. Image Share based on GSMA PRD IR.79 [8] 
. Geo-location sharing based on OMA File Transfer and Location Application 
Programming Interface 
. Audio Messaging 
. Extension to Extension services 


Note 1: If Capability Exchange via Presence is bilaterally agreed, then SIP OPTIONS need 
not to be supported for Capability Exchange, and vice versa. 

Note 2: RCS also cites Voice call and Video call. However, these are based on GSMA PRDs 
IR.92 [2] and IR.94 [3] respectively. 

3 IP Interconnection 

IP interconnection is described in GSMA PRD IR.65 [4] and may be accomplished via IPX or 
else via direct point-point connectivity. Whichever option is chosen is determined by mutual 
agreement of the operators and has no impact on the SIP/SDP profile across the NNI. The 
IMS inter-NNI reference architecture (from 3GPP TS 29.165 [1]) is as shown in Figure 1 
below. It is seen that the NNI interface consists of the Ici and Izi reference points between 
the peer IBCFs and TrGWs in the control and media planes respectively. 

 

 
IM CN subsystem network A IM CN subsystem network B 
Ici 
Izi 
II-NNI 
Mx 
Ix 
Mx 
Mx 
Mx 
TrGW 
Ix 
Mx 
TrGW 
IBCF 
S-CSCF I-CSCF 
P-CSCF 
S-CSCF I-CSCF 
MSC Server 
enhanced 
for ICS or 
SRVCC 
Mx 
IBCF 
Signalling 
Bearer 
ATCFF 
Mx 
ATCFF 
Mx 
MSC Server 
enhanced 
for ICS or 
SRVCC 
P-CSCF 
Mx 
Mx 
Mx 
Mx 
BGCF BGCF 
Mx 
TRF 
Mx 
TRF 
TF 
TF 
Mx 
Mx 
AS AS 

Figure 1 : Inter IMS NNI Reference Architecture 


 


As stated in 3GPP TS 29.165 [4], IMS roaming may be performed across the II-NNI subject 
to agreements between the operators. Such use of the NNI (the roaming-NNI) is in scope for 
this profile. 

4 SIP Methods & Headers 

Table 1 describes the SIP methods that are applicable in this profile. Each method is tagged 
as Mandatory / Optional where: 

. Mandatory means that the SIP method must be supported at each end, 
. Optional means that the SIP method must be supported dependent on a specific 
service or capability being applicable at the NNI. If no such service or capability is 
applicable, then the method is Not Applicable. Example services/capabilities are 
given. The list of example services/capabilities does not preclude others being 
applied via bilateral agreement. 


Method 

Status 

Additional Information 

INVITE 

Mandatory 

Includes both the initial INVITE and any subsequent re-
INVITE 

ACK 

Mandatory 

 

BYE 

Mandatory 

 

CANCEL 

Mandatory 

 

OPTIONS 

Mandatory 

May be used for RCS Capability Exchange. May also be 
used as a heartbeat mechanism on the NNI. 

INFO 

Optional 

May be used across the Roaming NNI for USSI (USSD 
over IMS). 

May also be used for MMTel features not included in 
GSMA PRD IR.92 [2] if bilaterally agreed (e.g. AOC, 
MCID etc. - see section 12 of 3GPP TS 29.165 [1]) 

Older implementations (pre-IETF RFC 4028 [16]) may 
use INFO as a session heartbeat via bilateral 
agreement. In this case, a 200 OK response must be 
sent in reply to an INFO request that is syntactically 
correct and well structured, as defined in IETF RFC 6086 
[82]. 

MESSAGE 

Mandatory 

Used for SMS over IP. 

Also used for RCS messaging (pager mode and IMDN) 

NOTIFY 

Mandatory 

Used for roaming NNI for ÅgregeventÅh notification. 

Used at the interconnect NNI for MMTel services (e.g. 
CONF status), RCS Social Presence, Group Chat and 
Capability Exchange via Social Presence. 

PRACK 

Mandatory 

PRACK shall be generated in response to any non-100 
provisional response to an INVITE message specifying 
the Åe100relÅf option tag in a Require header. 

PRACK may be generated in response to any non-100 




Method 

Status 

Additional Information 

provisional response to an INVITE message specifying 
the Åe100relÅf option tag in a Supported header. 

Note that this may only be specified in the provisional 
response if the corresponding INVITE message 
indicated support of reliable provisional responses via 
inclusion of a Åe100relÅf option tag in either a Supported or 
Require header. 

PUBLISH 

Mandatory 

Used for RCS Social Presence and applicable at the 
roaming NNI only. 

REFER 

Mandatory 

Used for MMTel services (e.g. CONF, ECT) and RCS 
Group Chat. 

REGISTER 

Mandatory 

Applicable for roaming NNI only. 

SUBSCRIBE 

Mandatory 

Applicable for roaming NNI for ÅgregeventÅh 

Also used at the interconnect NNI for RCS Social 
Presence, MMTel services (e.g. CONF status), RCS 
Group Chat and Capability Exchange via Social 
Presence. 

UPDATE 

Mandatory 

Used for offer/answer exchange, session timer refresh 
etc. 



Table 1: Applicable SIP Methods 


4.1 SIP Method Handling 

If a SIP method is received and recognized but not supported, it shall be rejected as defined 
in IETF RFC 3261 [12] with a SIP 405 "Method not allowed" response which shall include an 
ALLOW header field containing a list of supported methods. 

If a SIP method is received and is not recognized (i.e. not implemented), it shall be rejected 
as defined in IETF RFC 3261 [12] by a 501 "Not Implemented" response. 

Note: In order to prevent a given request being repeatedly re-sent, an IBCF may change a 
response code prior to forwarding the message across the NNI to a 403 ÅgForbiddenÅh 
response. 

4.2 SIP Status Code Handling 

SIP responses are handled according to IETF RFC 3261 [12]. 

As stated in IETF RFC 3261 [12], if a non-recognized final response is received in a SIP 
message then it shall be treated as being equivalent to the x00 response code of that class. 

As stated in IETF RFC 3261 [12], if a non-recognized 18x provisional response (i.e. not 
referenced in the section 4.3.4.3, Table 3), is received in a SIP message, then it shall be 
treated as being equivalent to a 183 ÅgSession ProgressÅh response. 


4.3 SIP Header Handling 

4.3.1 SIP Requests 

If a mandatory header is absent or malformed in the request, the request shall be rejected as 
defined in IETF RFC 3261 [12] with a SIP 400 ÅgBad RequestÅh response. 

If an unrecognized option tag is present in the Require header, the Request shall be rejected 
with a SIP 420 ÅgBad ExtensionÅh response. Other non-supported headers and parameters 
shall be ignored. 

The headers or parameters that are not mentioned in the tables from Section 4.4 are 
considered as not applicable headers or parameters and shall be ignored as defined in IETF 
RFC 3261 [12]. 

4.3.2 SIP Responses 

If a header necessary for processing the response is absent or malformed in a final 2XX 
response to an INVITE request, the response shall be acknowledged by sending an ACK 
and then the dialog shall be terminated with a SIP BYE. 

If a header necessary for processing the response is absent or malformed in a provisional 
response, the response shall be discarded. 

If a header necessary for processing the response is absent or malformed in other final 
responses (i.e. except a 2XX response), the response shall be treated as the 500 "Server 
Internal Failure" response. 

If a non-supported SIP header or parameter is received in a SIP response, it shall be 
ignored. Headers not listed in the subsequent tables in clause 4.4 and 4.5 are considered to 
be non-supported, unless there is a related bilateral agreement. 

4.4 SIP Header Support (Summary) 

This clause summarises the SIP headers that are supported across the NNI across all SIP 
methods and responses. The supported headers are as documented in Table A.1 of 3GPP 
TS 29.165 [1] with additions as shown in Table 2 below. All the cited additional headers in 
Table 2 below are applicable only to RCS services using OMA CPM. 

Header 

Status 

Additional Information 

Contribution-ID 

o 

Defined in OMA CPM [34] . not included in 3GPP TS 
29.165 [1] 

Conversation-
ID 

o 

Defined in OMA CPM [34] . not included in 3GPP TS 
29.165 [1] 

InReplyTo-
Contribution-ID 

o 

Defined in OMA CPM [34] . not included in 3GPP TS 
29.165 [1] 

Message-
Expires 

o 

Defined in OMA CPM [34] . not included in 3GPP TS 
29.165 [1] 

Message-UID 

o 

Defined in OMA CPM [34] . not included in 3GPP TS 
29.165 [1] 

Session-

o 

Defined in OMA CPM [34] . not included in 3GPP TS 




Header 

Status 

Additional Information 

Replaces 

29.165 [1] 

Note: Status meaning is as defined in Table A.2 of 3GPP TS 29.165 [1] 



Table 2: Supported SIP Headers (Overall) 


4.4.1 Trust Relationships 

Section 6.1.1.3.1 of 3GPP TS 29.165 [1] identifies the SIP headers that are subject to trust 
relationships. 

The basic assumption for an MNO interconnecting to another MNO or IPX service provider 
using this service profile should be that there is a trust relationship. Nevertheless, some 
services are mainly applied within a single network, and SIP header related to such service 
should therefore not be passed over the II-NNI. 

Table 3 below provides guidelines for trust relationships over the II-NNI to be used as 
complement to Table 6.2 of 3GPP TS 29.165 [1]. 

Note: The guidelines provided has taken an international II-NNI as the basis, 
When applied within a country, national regulatory requirements may also 
need to be considered. 

Item 

Header Field 

Suggested Trust 
Relationship 

Comment 

[1] 


P-Asserted-Identity 

Trusted 

Trust is mandatory at the 
roaming NNI 

[2] 


P-Access-Network-Info 

Trusted 

 

Should be trusted at the 
roaming NNI, even if ÅgNot 
TrustedÅh at the non-roaming NNI 

[3] 


Resource-Priority 

Not Trusted 

 

[4] 


History-Info 

Trusted 

 

[5] 


P-Asserted-Service 

Trusted 

 

[6] 


P-Charging-Vector 

Trusted 

 

[7] 


P-Charging-Function-
Addresses 

Not Trusted 

 

[8] 


P-Profile-Key 

Not Trusted 

Shall always be ÅgNot TrustedÅh 
at a non-Roaming NNI 

[9] 


P-Private-Network-
Indication 

Not Trusted 

 

[10] 


P-Served-User 

Trusted 

 

Not Trusted 

Shall always be ÅgTrustedÅh at the 
Roaming-NNI 

Shall always be ÅgNot TrustedÅh 
at a non-Roaming NNI 

[11] 


Reason 

Trusted 

 

[12] 


P-Early-Media 

Trusted 

 

[13] 


Feature-Caps 

Trusted 

Trust is mandatory at the 




Item 

Header Field 

Suggested Trust 
Relationship 

Comment 

roaming NNI 



Table 3: Guidelines for trust relationship for SIP headers at the II-NNI 


4.5 SIP Header Support (Per Method / Response) 

This clause provides header details on a per SIP Method / Response basis. The header 
details per method/response are as tables B.3.1 through B.16.2 in 3GPP TS 29.165 [1] with 
any modifications/clarifications as described in this section. 

4.5.1 Additional Headers 

There are a number of headers that are applicable only to RCS services using CPM that are 
defined in OMA CPM [34] and are not present in 3GPP TS 29.165 [1]. Table 4 below lists 
these headers and the methods/responses in which they may occur. 

Header 

Related Methods / Responses 

Contribution-ID 

INVITE request OR MESSAGE request 

Both with status do 

Conversation-ID 

INVITE request OR MESSAGE request . both with status do 

InReplyTo-
Contribution-ID 

INVITE request OR MESSAGE request . both with status do 

Message-Expires 

INVITE request . with status do 

Message-UID 

MESSAGE request OR 200 OK (MESSAGE) response OR 

BYE request . all with status do. 

Session-Replaces 

INVITE request . with status do 

Note: Status meaning is as defined in Table B.2.1 of 3GPP TS 29.165 [1] 



Table 4: Additional Headers 


Other headers that are not cited may be transited or removed at the NNI based on local 
operator policy and/or bi-lateral agreement. 

4.5.2 Header Manipulation 

This section provides options/mandated actions on the manipulation of certain headers by 
the IBCF at the NNI. Note that the listed headers are not an exhaustive list and that header 
manipulation by the IBCF is dependent on operator policy. 

Header 

Header Modification / Manipulation 

Call-ID 

May be overwritten by the IBCF for topology hiding at the Interconnect-NNI 
but must not be overwritten at the Roaming NNI (see section 5.10.1 of 
3GPP TS 24.229 [68]. 

Content-Length 

IBCF shall recalculate this number when message bodies are altered (e.g. 
SDP). 

From 

Can be anonymised by the IBCF based on the Privacy header. 

Max-Forwards 

May be overwritten by the IBCF. 




Header 

Header Modification / Manipulation 

Record-Route 

This header may be overwritten for topology hiding. 

Route 

IBCF may include the identity of its peer in this header. For Roaming NNI, 
this header may also include the identity of HPLMN S-CSCF or VPLMN P-
CSCF. 

Via 

May be overwritten by the IBCF for topology hiding. 



Table 5: IBCF Header Manipulation 


5 SIP Message Transport 

Both UDP and TCP transport are mandatory. If UDP is the transport of choice, then TCP 
should be used for large messages to avoid fragmentation as described in clause 18.1.1 of 
IETF RFC 3261 [12]. As stated in clause 18.1.1 of IETF RFC 3261 [12], it is recommended 
that an existing TCP connection be reused if a request is destined to an IP address, port, 
and transport to which an existing connection is already open. 

SCTP is optional and may be used if bilaterally agreed between the operators. As stated in 
3GPP TS 29.165 [1], this option is favourable if the operators would like to improve reliability 
over the Ici interface. 

Dependent on the nature of the connection, security may be applied at the NNI based on 
bilateral agreement. As stated in 3GPP TS 29.165 [1], the security mechanisms are as 
defined in 3GPP TS 33.210 [26]. It is recommended to use Network Domain Security (NDS) 
for IMS Protocols as defined in Annex C of 3GPP TS 33.210 [26] which mandates the use of 
IPSEC ESP [27]. 

6 SIP Signalling Mode 

En-bloc signalling shall apply to this profile. The format of the address is described in Clause 
7. 

7 Numbering & Addressing 

The routing of SIP signalling over the IMS NNI requires use of SIP URIs routable at the NNI 
per clause 6.4 of GSMA PRD IR.65 [7]. Three scenarios are possible for outgoing SIP 
sessions: 

. An identifier used for routing at the NNI may be formatted as a SIP URI whose user 
part is based on an E.164 format Public User Identity, and whose domain part is 
routable at the NNI. The Åguser=phoneÅh parameter must be appended to such a URI. 
. An identifier used for routing at the NNI may be formatted as a SIP URI whose user 
part is alphanumeric and whose domain part is routable at the NNI. 
. An identifier used for routing at the NNI may by bilateral agreement be formatted as a 
SIP URI whose user part is based on a local telephone number (as defined in IETF 
RFC 3966 [46]), and whose domain part is routable at the NNI. In this case, the local 
number must be qualified via the phone-context parameter as defined in IETF RFC 
3966 [46] which may be specified in terms of its global number (e.g. Åg+44Åh) or via a 
domain name. The format of the permitted phone-context is also subject to bi-lateral 
agreement. The Åguser=phoneÅh URI parameter must also be appended in this case. 



In all cases, if a SIP URI is entered by the user, its domain part may have to be converted by 
the originating network in order to be routable at the NNI. 

The originating Service Provider discovers the SIP point of contact (e.g. IMS IBCF) specified 
by the terminating Service Provider as described in clause 4.5.2 of GSMA PRD IR.67 [23]. 

As specified in IETF RFC 3261, the application layer address to which a SIP message is to 
be delivered is identified in the Request-URI. To reach that address the message may 
traverse a sequence of SIP-aware network elements belonging to one or more network. 

To constrain its path, a ÅgstackÅh of URIs may be encoded in one or more Route headers and 
appended to the SIP message. At each network element that performs SIP routing, a SIP-
aware network element toward which the message is to be forwarded is identified by the URI 
at the top of that stack. A network element that owns the resource identified by the topmost 
URI removes that URI from the stack; and removes the associated Route header if it 
contains no additional URIs. If a message contains no Route headers, it is forwarded based 
on the URI in the Request line (i.e., the Request-URI). 

8 SIP Message Bodies 

3GPP TS 29.165 [1] states that the MIME type "application/sdp" and multipart message 
bodies (multipart/mixed, multipart/related and multipart/alternative) shall be supported 
according to IETF RFC 5621 [38] over the NNI. 

3GPP TS 29.165 [1] also lists a number of other MIME types may be supported over the NNI 
based on agreement between operators. A number of these additional MIME types are 
related to MMTel or RCS services. 

Table 6 below lists the MIME types that are recommended to be supported in this profile, 
based on the related services in scope across the NNI: 

MIME Type 

Additional Info 

application/SDP 

Mandatory. Used to carry SDP bodies to describe MMTel 
audio/video sessions and RCS TCP/MSRP sessions. The 
IBCF (in conjunction with information received from the 
TrGW) manipulates SDP message bodies. 

multipart/mixed 

Mandatory to align with 3GPP TS 29.165 [1]. 

Used in RCS messaging where multiple message bodies 
are included to send an initial message as well as 
negotiate a TCP/MSRP session. The IBCF manipulates 
the SDP to reflect the TCP/MSRP session traversing the 
TrGW. 

multipart/related 

Mandatory to align with 3GPP TS 29.165 [1]. 

Used in RCS FT to enable multiple message bodies to be 
included to both negotiate a TCP/MSRP session and 
include a thumbnail file preview (see IETF RFC 5547 [39]). 

multipart/alternative 

Despite being mandatory in 3GPP TS 29.165 [1], not 
specifically used for MMTel or RCS at the current time. 




MIME Type 

Additional Info 

Need not be manipulated by the IBCF. May be transited or 
removed by the IBCF based on operator preference. 

message/external-body 

Used in RCS messaging/FT to pass a reference to stored 
content, identified via a URI (see IETF RFC 4483 [40]). 

Conditionally supported in this profile of RCS 
messaging/FT is in scope across the NNI. Conveyed 
unchanged by the IBCF. 

message/cpim 

Used in RCS standalone (pager mode) messaging. 

Conditionally supported in this profile if RCS messaging is 
in scope across the NNI. Conveyed unchanged by the 
IBCF. 

message/imdn+xml 

Used in RCS messaging to inform the sender of message 
delivery/read (see IETF RFC 5438 [41]). 

Conditionally supported in this profile if RCS messaging is 
in scope across the NNI. Conveyed unchanged by the 
IBCF. 

application/vnd.etsi.mcid+xml 

Used in the MMTel MCID service (see 3GPP TS 24.616). 
This service is not mandated in GSMA PRD IR.92 [2] and 
this message body is thus optional in this profile and may 
be supported if bilaterally agreed. 

application/vnd.3gpp.cw+xml 

Used in n/w based Communication Waiting, which is not 
required in GSMA PRD IR.92 [2] and this message body is 
thus optional in this profile and may be supported if 
bilaterally agreed. 

application/vnd.3gpp.comm-div-
info+xml 

Used in diversion notification, which is not required in 
GSMA PRD IR.92 [2] and this message body thus optional 
in this profile and may be supported if bilaterally agreed. 

application/vnd.etsi.aoc+xml 

Used for MMTel Advice of Charge Service, which is not 
required in GSMA PRD IR.92 [2] and this message body is 
thus optional in this profile and may be supported if 
bilaterally agreed. 

application/vnd.etsi.cug+xml 

Used for MMTel CUG Service, which is not required in 
GSMA PRD IR.92 [2] and this message body is thus 
optional in this profile and may be supported if bilaterally 
agreed. 

application/vnd.etsi.sci+xml 

Used for the transfer of real time charge information 
between the Charge Determination Point and Charge 
Recording Point (see 3GPP TS 29.658 [62]). Optional and 
may be supported if bilaterally agreed. 

application/vnd.etsi.pstn+xml 

Used to convey ISDN information (see 3GPP TS 29.163 
[45]). This is conditionally supported where IMS is used as 
a transit network to connect CS-networks. 




MIME Type 

Additional Info 

message/sipfrag 

Used to convey SIP session progress. This is conditionally 
supported if MMTel Ad-Hoc Conference / RCS Group Chat 
service is used. 

application/x-session-info 

Used to convey additional digits in a SIP INFO for overlap 
sending. Not applicable to this profile. 

application/pidf+xml, application/pidf-
diff+xml, 

application/watcherinfo+xml, 

application/xcap-diff+xml, 

application/vnd.oma.suppnot+xml, 

application/simple-filter+xml 

Conditionally supported in RCS Social Presence is 
applicable at the NNI. 

application/resource-lists+xml, 
application/rlmi+xml 

Used to convey a list of target users for MMTel Ad-Hoc 
Conference & RCS Group Chat. 

application/load-control+xml 

Used to exchange overload control information. The 
related internet draft is not yet agreed. Therefore, this is 
optional for this profile and may be supported if bilaterally 
agreed. 

application/im-iscomposing+xml 

Used to convey SIMPLE IM. Conditionally supported for 
RCS messaging services for interworking between 
SIMPLE IM and CPIM. 

application/simple-message-
summary+xml 

Conditionally supported at the roaming NNI if the MMTel 
Message Waiting service is used. This service is included 
in GSMA PRD PRD IR.92 [2]. 

application/vnd.3gpp.sms 

Conditionally supported at the NNI if the SMS over IP 
service is in scope . see 3GPP TS 24.341 [47]. 

application/vnd.3gpp.ussd 

Used for MMI at the roaming NNI. Optional to this 
profile and may be supported if bilaterally agreed. 

application/vnd.3gpp.iut+xml 

application/vnd.3gpp.replication+xml 

Used for inter-UE transfer. Optional in this profile and may 
be supported if bilaterally agreed. See 3GPP TS 24.337 
[63]. 

application/vnd.3gpp.access-transfer-
events+xml, 

application/vnd.3gpp.mid-call+xml, 

application/vnd.3gpp.srvcc-ext+xml, 

application/vnd.3gpp.srvcc-info+xml, 

application/vnd.3gpp.state-and-event-
info+xml 

Applicable to the roaming NNI and used for SRVCC. 
Optional in this profile and may be supported if bilaterally 
agreed. See 3GPP TS 24.237 [64]. 

application/3gpp-ims+xml 

Generic 3GPP XML body. This is optional in this profile 
and may be passed unaltered by the IBCF subject to 
bilateral agreement at the NNI. 

application/reginfo+xml 

Conditionally supported for the roaming NNI. 

application/conference-info+xml 

Conditionally supported if conference services are 
supported across the NNI (e.g. MMTel Ad-Hoc 




MIME Type 

Additional Info 

Conference, RCS Group Chat). 



Table 6: SIP Message Bodies 


The IBCF is primarily a transit point and may manipulate the application/SDP message body 

(e.g., due to its interaction with the TrGW to enable media flows to traverse the TrGW, and 
optionally to facilitate the media transcoding as described in 3GPP TS 23.228, Annex I, 
Section I.3.3 [80]). 

If media transcoding is provided, then it shall be done as described in Section 10.3 of this 
GSMA PRD. 

All other permitted message bodies are transited unchanged. The permitted MIME type of 
message bodies are selected based on local operator policy and/or bi-lateral agreement at 
the NNI dependent on the services supported at the NNI. 

The IBCF may limit the size of SIP message bodies and take remedial action should that 
size be exceeded. The limit is agreed on a bilateral basis. The remedial action as specified 
in clause 5.10.6.3 of 3GPP TS 24.229 [68]. 

Other (unrecognised) message bodies may be removed or transited based on local operator 
policy and/or bi-lateral agreement at the NNI. The default action in this profile would be to 
remove such a message body. 

9 SIP Options Tags 

SIP Option tags are not removed when transited across the NNI. 

Table 6.1.3.1 in 3GPP TS 29.165 [1] provides a list of capabilities supported across the NNI, 
a number of which are related to the use of SIP Option tags. All of the cited option tags are 
included in Table 6.1.3.1 of 3GPP TS 29.165 [1]. 

Table 7 below provides a list of the SIP Option Tags applicable to the scope/services of this 
profile based on GSMA PRD IR.65 [4] and GSMA PRD IR.90 [5] and carried in the SIP 
Supported or Require headers. 

This list below in Table 7 does not preclude other tags being transmitted across the NNI nor 
a given tag being used in relation to other services. 

Tag 

Additional Information 

timer 

Enables SIP session keep-alive . see RFC 4028 [16]. 

100rel 

Enables reliable provisional responses . see RFC 3262 
[14]. An example would be conveying SDP in a 18X 
response. 

precondition 

Enables negotiation of resource reservation for segmented 
QOS . see RFC 3312 [15] 

path 

Used for the roaming NNI scenario as part of IMS 
registration . see RFC 3327 [20]. 




Tag 

Additional Information 

replaces 

Applicable to MMTel services CONF and ECT . see RFC 
3891 [19]. 

histinfo 

Used in MMTel Call Forwarding . see RFC 4244 [48]. 

multiple-refer 

Used for the roaming NNI when referring to multiple parties 
to be added to an existing conference . see IETF RFC 
5368 [28] 

norefersub 

Used for the roaming NNI and enables implicit subscription 
to be notified of the progress of the associated REFER . 
see IETF RFC 4488 [21] 

from-change 

Related to the TIP service . see IETF RFC 4916 [49]. 

gruu 

Used for the roaming NNI as party of IMS registration . 
see IETF RFC 5627 [65]. 

recipient-list-invite 

Used for the roaming NNI when creating a conference via 
a list of URIs . see IETF RFC 5366 [60]. 

resource-priority 

Used to denote priority for a SIP session . see IETF RFC 
4412 [66]. 



Table 7: SIP Option Tags 


10 Media Control 

Media control shall follow the SIP SDP Offer/Answer model as documented in IETF RFC 
3264 [11] to control the underlying user plane during a SIP session. 

MMTel services shall negotiate voice, video or voice/video media flows. A single SIP 
session shall be able to negotiate a voice media flow, a video media flow or both a voice and 
video media flow. Video may be added to voice during a SIP session or subtracted from a 
multimedia (voice and video) session during a SIP session. 

If the RCS Video Share service is used, video flows shall be negotiated. If any other RCS 
service is used (with the exception of pager-mode messaging, which has no user plane), 
TCP/MSRP sessions shall be negotiated to support the required media plane flows. 

10.1 SIP SDP Offer / Answer 

SIP SDP information shall be supported in the body of INVITE, ACK, PRACK, UPDATE, 200 
OK (INVITE, PRACK, UPDATE) and 18x (INVITE) messages. 

In line with GSMA PRD IR.92 [2], SIP preconditions must be supported by the UE but may 
be disabled by the network operator. It is out of scope of this profile whether the IBCF or 
some other network element is responsible for removing the related SDP media attributes to 
disable preconditions. 

Irrespective of whether the network operator has disabled preconditions, the IBCF must 
support receiving SDP both with and without media attributes relating to preconditions. 

If SIP preconditions are permitted, then the IBCF shall transit the related SDP media 
attributes to enable preconditions to be negotiated end-to-end, and thus two offer/answer 


exchanges are typically required to establish the bearer (e.g., INVITE/18x plus UPDATE/200 
OK(UPDATE)). 

Media flows may be subsequently modified within an existing SIP session via a new offer 
carried within a SIP re-INVITE or SIP UPDATE message. 

As stated in GSMA PRD IR.92 [2], SIP forking is recommended to be supported for inter-
operability and forward-compatibility reasons, and the IBCF should be able to maintain at 
least seven (7) parallel early dialogues until receiving the final response on one of them. The 
IBCF/TrGW must support receiving media on one of these early dialogues as described in 
3GPP TS 24.628 [67]. 

10.2 RTP Profile 

As stated in GSMA PRD IR.92 [2] and GSMA PRD IR.88 [7], the Real Time Protocol (RTP) 
profile and Audio Video Profile (AVP) (IETF RFC 3551 [32]) shall be used for voice sessions 
and Video Share sessions respectively. 

As stated in GSMA PRD IR.94 [3], the Extended RTP Profile for Real Time Control Protocol 
(RTCP)-based Feedback (RTP/AVPF) (IETF RFC 4585 [33]) must be used for video 
telephony sessions. If the initial offer using RTP/AVPF is rejected, then a new offer shall be 
sent by the UE using RTP/AVP for the video telephony session. 

If any RCS service is used, except for pager-mode messaging (which has no user plane), 
and the Video Share service, TCP/MSRP sessions shall be negotiated to support the 
required media plane flows as defined by IETF RFC 4975 [58] and described by GSMA PRD 
RCC.07 [44]. 

10.3 Codecs 

The codecs in this profile are based on those mandated in the cited GSMA PRDs. 

In general, whilst codec negotiation takes place end-end, the codecs supported at the NNI 
are subject to bi-lateral agreement. This profile defines a number of mandatory codecs at the 
NNI. 

Further, this profile does not preclude other codecs being bilaterally agreed and nor should 
the IBCF unnecessarily remove codecs from a list received in an offer/answer as codec 
negotiation is an end-end negotiation. 

Where possible, transcoding is to be avoided at the NNI. However, it is acknowledged that 
the IBCF/TrGW may need to perform transcoding at a given NNI where the in-hand codec(s) 
are exclusive of a bi-laterally agreed codec list. See clause 10.2.5. 

10.3.1 Audio Codecs 

For this profile, the following audio codecs are mandatory, in line with GSMA PRD IR.92 [3]: 

. Adaptive Multi-Rate (AMR) speech codec (described in 3GPP TS 26.071 [70], 3GPP 
TS 26.090 [71], 3GPP TS 26.073 [72], and 3GPP TS 26.104 [73]). 
. Adaptive Multi-Rate Wideband (AMR-WB) codec (described in 3GPP TS 26.114 [9], 
3GPP TS 26.171 [75], 3GPP TS 26.190 [77], 3GPP TS 26.173 [76] and 3GPP TS 
26.204 [79]). 



In addition, to support interoperability with non-3GPP access inter-connect, the following 
audio codecs are also recommended for this profile: 

. G.711 (see IETF RFC 3551 [32]) 


 

Other audio codecs may be supported (e.g., G.729A and G.722 (see IETF RFC 3551 [32])) 
based on bilateral agreement and are out of scope of this profile. 

10.3.2 Video Codecs 

As mandated in GSMA PRD IR.94 [3], the following video codec is mandatory: 

. ITU-T Recommendation H.264 Constrained Baseline Profile (CBP) Level 1.2 as 
specified in 3GPP Release 10 TS 26.114 [9] section 5.2.2 


As mandated in GSMA PRD IR.84 [7], the following video codecs are mandatory: 

. ITU-T Recommendation H.264 Constrained Baseline Profile (CBP) level 1.3 is 
mandatory. RTP payload format for H.264 is used as specified in IETF RFC 3984 
[30]. 
. ITU-T Recommendation H.263-2000 [29] profile 0 level 45. Note that the indication of 
H.263 profile 0 level 45 in SDP implies support of H.263 profile 0 level 10. When 
using the H.263 video codec, only QCIF resolution video must be supported for Video 
Share. The recommended frame rate is 15fps. The ÅeframerateÅf and ÅeframesizeÅf media-
level SDP attributes are used as specified in IETF RFC 4566 [13], to indicate the 
same. 


Other video codecs may be supported based on bilateral agreement and are out of scope of 
this profile. 

10.3.3 Codec Negotiation/Handling at the NNI 

The network shall have the ability to perform transcoding between the media types and 
codecs it supports. The network may implement these capabilities in various network 
elements; however, the remainder of this section assumes they are provided by the IBCF / 
TrGW. 

To facilitate interoperability, the IBCF shall not preclude other codecs being offered across 
the NNI. To this end, the following behaviour is applicable to this profile: 

10.3.4 Global Text Telephony (GTT) 

If supported, Global Text Telephony (GTT) messages must use ITU-T Recommendation 
T.140 [24] real-time text according to the rules and procedures specified in 3GPP TS 26.114 
[9] and with clarifications in Annex B.2 in GSMA PRD IR.92 [2]. 

10.3.5 DTMF 

DTMF digits shall be conveyed across the II-NNI via the ÅgNamed Telephone EventÅh payload 
format defined in IETF RFC 4733 [22], as specified in Annex G of 3GPP TS 26.114 [9]. 

See 3GPP TS 26.114 [9] and clause 3.2 of GSMA PRD IR.92 [2] for further guidance on the 
encoding and transport of DTMF events. 


10.4 Early Media Detection 

Early media shall be supported in this profile. 

As stated in GSMA PRD IR.92 [2], early media may be indicated by the presence of a P-
Early-Media header in a re-INVITE/UPDATE/PRACK request or a 18x (INVITE) response. A 
P-Early-Media shall be transited across the NNI and all values of the P-Early-Media header 
shall be supported at the NNI. In addition, the IBCF shall configure its TrGW in a manner 
consistent with the P-Early-Media header to ensure that the related media traverses the 
TrGW. 

10.5 SDP Contents 

SDP is defined in IETF RFC 4566 [13]. 

SDP usage shall be compliant with the Offer/Answer rules in IETF RFC 4566 [13] 

NAT may be performed at the NNI in the user plane via the TrGW under the control of the 
IBCF via the Ix reference point as defined in 3GPP TS 29.238 [17]. 

The SDP contents applicable to the MMTel and RCS services in this document are 
summarized in Table 8 below. 

SDP Attribute 

Profile Settings 

Version 

(v-line) 

The value must always be equal to zero: 

v=0. 

Origin 

(o-line) 

The origin line consists of six fields: 

 (<username>, <sess-id>, <sess-version>, <nettype>, <addrtype> and <unicast-
address>). 

 

- <user name> should contain an hyphen 

- <session ID> and <version> should contain one or mode digits as described in 
IETF RFC 4566 [8] 

- <network type> shall be set to IN 

- <address type> shall be set to IP4 or IP6 The Address Type shall be set to 
"IP4" or "IP6" depending on the addressing scheme. 

- <address> should contain the fully qualified domain name or IP address of the 
media end point (typically the TrGW). 

 

Example: 

Ågo=- 0 0 IN IP4 10.1.2.3Åh 

Session 

(s-line) 

The session name "s=" line contains a single field 

s= <session name>. 

Example: 

"s=-" 

Time 

(t-line) 

The time "t=" line consists of two fields 

t= <start time> and <stop time>. 

 

Example: 

"t=0 0" 

Connection 

(c-line) 

The connection Ågc=Åh line consists of three fields, 

c=<nettype> <addr type> <connection-address> 

The <nettype> shall be ÅgINÅh 

The <addr type> shall be ÅgIP4Åh or ÅgIP6Åh 




SDP Attribute 

Profile Settings 

The <connection-address> shall be an IPv4 or IPv6 address as signified by the 
<addr type>. 

 

Example: 

Ågc=IN IP4 10.10.1.1Åh 

Media 

(m-line) 

The media Ågm=Åh line consists of four fields <media>, <port>, <proto> and <fmt> 

 

The <media> field shall be set to "audio" or "video"or "message" or ÅgtextÅh or 
ÅgimageÅh. 

 

The <port> is set to the port number that shall send/receive the media. The port 
number must be even for audio/video/text/image. 

The <proto> is set to ÅgRTP/AVPFÅh for video and to ÅgRTP/AVPÅh for 
audio/video/text media and to ÅgTCP/MSRPÅh for message media. 

 

The <fmt> is set to one or more RTP payload numbers for RTP/AVP and to Åg*Åh for 
TCP/MSRP. 

 

Examples: 

Ågm=audio 1234 RTP/AVP 100 8 0Åh 

Ågm=video 1234 RTP/AVPF 100 102Åh 

Ågm=video 1234 RTP/AVP 100 102Åh 

Ågm=message 1239 TCP/MSRP *Åh 

Ågm=text 1234 RTP/AVP 99Åh 

Media Attributes 

(a-lines) 

The attribute Åga=Åh line consists of one or two fields <attribute> or 
<attribute>:<value>. Many attribute lines are defined, of which most are related to 
a specific payload. 

 

One or more media attribute lines may be included dependent on the payload 
type. In general, attribute lines should be transited at the NNI to facilitate media 
interworking. Some common media attribute lines are shown below:- 

 

(for stream activity) 

a=inactive/recvonly/sendonly/sendrecv 

Example :- Åga=inactiveÅh 

 

(for identifying RTP dynamic payload numbers) 

a= rtpmap: <payload type> <encoding name>/<clock rate> [/<encoding 
parameters>] 

Example: Åga=rtpmap: 100 AMR-WB/16000Åh 

 

(for providing payload specific parameter) 

a= fmtp:<format> <format specific parameters> 

Example:- Åga=fmtp: 100 octet-align 1Åh 

 

(for defining packetization rate) 

a= ptime: <time> 

Example: a=ptime: 20 

 

(for segmented QOS indication as per RFC 3312 [15]) 

a=curr: <precondition type> <status-type> <direction> 

a=des: <precondition type> <strength> <status-type> <direction> 

a=conf <precondition type> <status-type> <direction> 

Example :- 

a=curr: qos local none 

a=des: qos mandatory local sendrecv 

a=curr qos remote none 




SDP Attribute 

Profile Settings 

a=des: qos optional remote sendrecv 

a=conf: qos remote sendrecv 

 

(for OMR as per 3GPP TS 29.079 [37]) 

a=visited-realm: <instance> <realm> <addrtype> <addr> <port> 

a=omr-m-cksum: <hexNumber> 

a=omr-s-cksum: <hexNumber> 

a=omr-codecs:<instance>:<proto> 1*<codec> 

a=omr-m-att: <instance>:1* <attribute> 

a=omr-s-att: <instance>:1* <attribute> 

a=omr-m-bw:<instance>:<bandwidth> 

a=omr-s-bw:<instance>:<bandwidth> 

Example :- 

a=visited-realm:1 Xa.operatorX.net IN IP4 192.0.2.1 49170 

a=visited-realm:2 XY.operator.netX IN IP4 13.24.1.1 66000 

a=omr-m-cksum: 89 

a=omr-s-cksum: 0 

 

(for RTP Profile Negotiation) 

a=tcap:1 

a=pcfg:1 t=1 

 

(for RTCP Feedback as per IETF RFC 4585 [33]) 

a=rtcp-fb:98 nack rpsi 

Bandwidth 

(b-line) 

The bandwidth Ågb=Åh line consists two fields <bwtype>:<bandwdith>. 

 

For voice and video call sessions, as mandated in GSMA PRDs IR.92 [2] and 
IR.94 [3] the <bwtype> is set to RS / RR. 

 

For GTT sessions, as mandated in GSMA PRD IR.92[2], the <bwtype> is set to 
AS, with RS and RR set to zero. 

 

For video share and RCS sessions, the <bwtype> is set to AS. 

 

The <bandwidth> defines the peak bandwidth in units of kbits/sec (for AS) or 
bits/sec (for RS/RR) and includes up to and including the IP layer as defined in 
IETF RFC 4566 [13] and IETF RFC 3566 [18]. 

 

Examples: 

Ågb=RR:100Åh , Ågb=AS:100Åh 



Table 8: SDP Contents 


10.6 RTP/RTCP Packet Source 

In a SIP session, the same IP address and port number shall be used to send and receive 
RTP packets (symmetric IP address and port number). Further, the port number for 
sending/receiving RTCP packets shall be equal to "the port number negotiated for RTP" + 1. 

SDP Bandwidth Modifiers for RTCP (see IETF RFC 3556 [18]) are supported on the NNI. 

11 IP Version 

As stated in 3GPP TS 29.165 [1], the supported IP version at the NNI may be IPv4 only, 
IPv6 only or both IPv4 and IPv6. 


In case IPv4 only and IPv6 only networks are interconnected, the involved IBCF and TrGWs 
shall apply the IP version interworking procedures as indicated in 3GPP TS 29.162 [69]. 

 


Appendix A SIP Header Examples (Informational) 

Table 9 below provides examples and references to the relevant RFCs etc. for the SIP 
headers in scope in this profile. 

Header 

Reference(s) 

Example Header 

Accept 

IETF RFC 3261 

Accept:application/sdp,message/cpim 

Accept-Contact 

IETF RFC 3841 

Accept-Contact:*;mobility="mobile";methods="INVITE" 

 

Accept-
Encoding 

IETF RFC 3261 

Accept-Encoding:gzip 

Accept-
Language 

IETF RFC 3261 

Accept-Language: da, en-gb;q=0.8, en;q=0.7 

Accept-
Resource-
Priority 

IETF RFC 4412 

Accept-Resource-Priority:ets.0 

Alert-Info 

IETF RFC 3261 

Alert-Info:<urn:alert:service:call-waiting> 

Allow 

IETF RFC 3261 

Allow:INVITE, ACK, UPDATE, PRACK, CANCEL, PUBLISH, 
MESSAGE, OPTIONS,SUBSCRIBE,NOTIFY 

Allow-Events 

IETF RFC 6665 

Allow-Events: conference 

Answer-Mode 

IETF RFC 5373 

Answer-Mode: Auto 

Authentication-
Info 

IETF RFC 3261 

IETF RFC 3310 

Authentication-Info: 
nextnonce="47364c23432d2e131a5fb210812c" 

Authorization 

IETF RFC 3261 

IETF RFC 3310 

3GPP TS 24.229 

Authorization: Digest, username="jon.dough@mobile.biz", 

realm="RoamingUsers@mobile.biz", 

nonce="CjPk9mRqNuT25eRkajM09uTl9nM09uTl9nMz5OX25PZz==", 

uri="sip:home.mobile.biz",qop=auth-int, 
nc=00000001,cnonce="0a4f113b", 

response="6629fae49393a05397450978507c4ef1", 

opaque="5ccc069c403ebaf9f0171e9517f40e41" 

Call-Id 

IETF RFC 3261 

Call-Id:12345@mydomain.com 

Call-Info 

IETF RFC 3261 

Call-Info: <http://wwww.example.com/alice/photo.jpg> 
;purpose=icon 

Contact 

IETF RFC 3261 

Contact:<sip:ibcf4@operator1.com:5060> 

Content-
Disposition 

IETF RFC 3261 

Content-Disposition:session 

Content-
Encoding 

IETF RFC 3261 

Content-Encoding:gzip 

Content-
Language 

IETF RFC 3261 

Content-Language:fr 

Content-Length 

IETF RFC 3261 

Content-Length:146 

Content-Type 

IETFRFC 3261 

Content-Type:application/sdp 

Contribution-ID 

OMA CPM 

Contribution-ID: abcdef-1234-5678-90ab-cdef01234567 

Converstaion-
ID 

OMA CPM 

Conversation-ID: f81d4fae-7dec-11d0-a765-00a0c91e6bf6 




Header 

Reference(s) 

Example Header 

CSeq 

IETF RFC 3261 

CSeq:2 CANCEL 

Date 

IETF RFC 3261 

Date Sat,13 Nov 2010 23:29:00 GMT 

Error-Info 

IETF RFC 3261 

Error-Info: <sip:announcement10@example.com> 

Event 

IETF RFC 6665 
IETF RFC 6446 

IETF RFC 3680 

Event:reg 

Expires 

IETF RFC 3261 

Expires:3600 

Feature-Caps 

IETF RFC 6809 
3GPP TS 24.229 

Feature-Caps:+3gpp.trf=sip:trf3.operator3.com 

Flow-Timer 

IETF RFC 5626 

Flow-Timer: 30 

From 

IETF RFC 3261 

From: <sip:+12125551212@operator1.com;user=phone>; 
tag=145688 

Geolocation 

IETF RFC 6442 

Geolocation:<user1@operator1.com> 

Geolocation-
Error 

IETF RFC 6442 

Geolocation-Error:100;code="Cannot Process Location" 

Geolocation-
Routing 

IETF RFC 6442 

Geolocation-Routing:yes 

History-Info 

IETF RFC 4244 

History-Info: <sip:Bob@P1.example.com>;index=1, 

<sip:Bob@P2.example.com>; index=1.1, 

<sip:User3@UA3.example.com? 
Reason=SIP%3Bcause%3D486%3Btext%3D"Busy 
Here">;index=1.2, 

<sip:User5@UA5.example.com>;index=1.3 

Info-Package 

IETF RFC 6086 

Info-Package:foo 

InReplyTo-
Contribution-ID 

OMA CPM 

InReplyTo-Contribution-ID: 01234567-89ab-cdef-0123-
456789abcdef 

Join 

IETF RFC 3911 

Join: 1234@example.com;to-tag=3456;from-tag=6789 

Max-Breadth 

IETF RFC 5393 

Max-Breadth:20 

Max-Forwards 

IETF RFC 3261 

Max-Forwards:70 

Message-
Expires 

OMA CPM 

Message-Expires: 259200 

Message-UID 

OMA CPM 

Message-UID: 4392 

MIME-Version 

IETF RFC 3261 

MIME-Version:1.0 

Min-Expires 

IETF RFC 3261 

Min-Expires:40 

Min-SE 

IETF RFC 4028 

Min-SE:60 

Organization 

IETF RFC 3261 

Organization:My Company 

P-Acces-
Network-Info 

IETF RFC 3455 

P-Access-Network-Info:3GPP-E-UTRAN-FDD;e-utran-cell-id-
3gpp=1234 

P-Answer-State 

IETF RFC 4964 

P-Answer-State: Unconfirmed 

P-Asserted-
Identity 

IETF RFC 3325 

P-Asserted-Identity: 
sip:+14085264000@operator1.com;user=phone 

P-Asserted-

IETF RFC 6050 

P-Asserted-Service: urn:urn-7:3gpp-service.ims.icsi.mmtel 




Header 

Reference(s) 

Example Header 

Service 

P-Associated-
URI 

IETF RFC 3455 

P-Associated-URI:sip:user2@operator3.com 

P-Called-Party-
ID 

IETF RFC 3455 

P-Called-Party-ID: sip:user1-business@example.com 

P-Charging-
Vector 

IETF RFC 3455 

P-Charging-Vector: icid-value=1234bc9876e; 

icid-generated-at=192.0.6.8; 

orig-ioi=home1.net 

P-Early-Media 

IETF RFC 5009 

P-Early-Media:supported 

P-Preferred-
Service 

IETF RFC 6050 

P-Preferred-Service: urn:urn-7:3gpp-service.ims.icsi.mmtel 

P-Private-
Network-
Indication 

IETF RFC 7316 

P-Private-Network-Indication: example.com 

P-Profile-Key 

IETF RFC 5002 

P-Profile-Key:sip:user3@operator4.com 

P-Refused-
URI-List 

IETF RFC 5318 

P-Refused-URI-List: sip:friends-list@example.net; 

members=<cid:an3bt8jf03@example.net> 

P-Served-User 

IETF RFC 5502 

P-Served-User:sip:user1@operator2.com;sescase=orig 

P-Visited-
Network-ID 

IETF RFC 3455 

P-Visited-Network-ID:"Visited network number 1" 

Path 

IETF RFC 3327 

Path:<sip:P2.example.com;lr>,<sip:P1.example.com;lr> 

Permission-
Missing 

IETF RFC 5360 

Permission-Missing: userC@example.com 

Policy-Contact 

IETF RFC 6794 

Policy-Contact: sip:server5@example.com 

Priority 

IETF RFC 3261 

Priority: emergency 

Priv-Answer-
Mode 

IETF RFC 5373 

Priv-Answer-Mode: Auto 

Privacy 

IETF RFC 3323 
IETF RFC 3325 

Privacy:user 

Privacy:id 

Proxy-
Authenticate 

IETF RFC 3261 

Proxy-Authenticate: Digest realm="atlanta.com", 

domain="sip:ss1.carrier.com", qop="auth", 

nonce="f84f1cec41e6cbe5aea9c8e88d359", 

opaque="", stale=FALSE, algorithm=MD5 

Proxy-
Authorization 

IETF RFC 3261 

Proxy-Authorization: Digest username="Alice", 
realm="atlanta.com", 

nonce="c60f3082ee1212b402a21831ae", 

response="245f23415f11432b3434341c022" 

Proxy-Require 

IETF RFC 3261 

Proxy-Require: foo 

Rack 

IETF RFC 3262 

Rack:10 

Reason 

IETF RFC 3326 

Reason:Q.850;cause=16;text="Terminated" 

Record-Route 

IETF RFC 3261 

Record-Route: <sip:server10.biloxi.com;lr>, 
<sip:bigbox3.site3.atlanta.com;lr> 

Recv-Info 

IETF RFC 6086 

Recv-Info: bar 




Header 

Reference(s) 

Example Header 

Referred-By 

IETF RFC 3892 

Referred-By: <sip:alice@phone1.example.org> 

Refer-Sub 

IETF RFC 4488 

Refer-Sub=false 

Refer-To 

IETF RFC 3515 

Refer-To: <sip:dave@bobster.example.org? 
Replaces=425928%40bobster.example.com.3%3B 

to-tag%3D7743%3Bfrom-tag%3D6472> 

Reject-Contact 

IETF RFC 3841 

Reject-Contact: *;actor="msg-taker";video 

Replaces 

IETF RFC 3891 

Replaces: 425928@bobster.example.org;to-tag=7743;from-
tag=6472 

Reply-To 

IETF RFC 3261 

Reply-To: Bob <sip:user4@example.com> 

Request-
Disposition 

IETF RFC 3841 

Request-Disposition: proxy 

Require 

IETF RFC 3261 

Require:Path 

Resource-
Priority 

IETF RFC 4412 

Resource-Priority:ets.1 

Retry-After 

IETF RFC 3261 

Retry-After: 3600 

Route 

IETF RFC 3261 

Route: <sip:bigbox3.site3.atlanta.com;lr>, 

<sip:server10.biloxi.com;lr> 

RSeq 

IETF RFC 3262 

RSeq:10 

Security-Client 

IETF RFC 3329 

Security-Client: ipsec-ike 

Security-Server 

IETF RFC 3329 

Security-Server: ipsec-ike 

Security-Verify 

IETF RFC 3329 

Security-Verify:ipsec-ike; q=0.1 

Service-Route 

IETF RFC 3608 

Service-
Route:<sip:P1.example.com;lr>,<sip:P2.example.com;lr> 

Session-
Expires 

IETF RFC 4028 

Session-Expires:3600;refresher=uac 

Session-
Replaces 

OMA CPM 

Session-Replaces: abcdef-1234-5678-90ab-cdef01234567 

Session-ID 

IETF RFC 7329 

Session-ID: 0123456789abcdef123456789abcdef0 

SIP-Etag 

IETF RFC 3903 

SIP-Etag:12345 

SIP-If-Match 

IETF RFC 3903 

SIP-If-Match:12345 

Subscription-
State 

IETF RFC 6665 

Subscription-State:active 

Supported 

IETF RFC 3261 

Supported:100Rel,timer,precondition 

Suppress-If-
Match 

IETF RFC 5839 

Suppress-If-Match:34567 

Target-Dialog 

IETF RFC 4538 

Target-Dialog: 

Timestamp 

IETF RFC 3261 

Timestamp:64 

To 

IETF RFC 3261 

To: 
<sip:+12126661212@operator2.com;user=phone>;tag=1234s56 

Trigger-
Consent 

IETF RFC 5360 

Trigger-Consent: sip:user1@example.com; target-
uri=Åhsip:user2@example.xcomÅh 

Unsupported 

IETF RFC 3261 

Unsupported:100Rel 




Header 

Reference(s) 

Example Header 

User-Agent 

IETF RFC 3261 

User-Agent:Softphone Beta1.5 

Via 

IETF RFC 3261 

Via: SIP/2.0/UDP 
operator1.com:5060;branch=z9hG4bK87asdks7 

Warning 

IETF RFC 3261 

Warning: 307 isi.edu "Session parameter 'foo' not 
understood" 

WWW-
Authenticate 

IETF RFC 3261 
IETF RFC 3310 
3GPP TS 24.229 

WWW-Authenticate: Digest realm="atlanta.com", 

domain="sip:boxesbybob.com", qop="auth", 

nonce="f84f1cec41e6cbe5aea9c8e88d359", 

opaque="", stale=FALSE, algorithm=MD5 



Table 9: SIP Header Examples 


 


SIP ((((2P Offer) 

IBCF 

Ibcf2.operatorB.com 

`10.10.0.1 

 

 (DP Offer) 

IBCF 

Ibcf1.operatorA.com 

`10.0.0.1 

 

 (DP Offer) 

RTP 
((((2P Offer) 

TrGW 

10.10.1.1P Offer) 

TrGW 

10.0.1.1P Offer) 

 
Appendix B SIP Message Examples (Informational) 

Appendix B provides example message flows and message contents across the NNI. 

It is assumed that each operator has FQDNs of ibcf 1.operatorA.com at the NNI and 
ibcf2.operatorB.com and IP addresses of 10.0.0.1/10.0.1.1 and 10.10.0.1/10.10.1.1 for 
control and media respectively as shown in figure 2. In each case, the IBCF configures 
media pin holes on its respective TrGW. 

 

Operator- A Operator-B 

 

 

 

 

 

 

Figure 2 : NNI Configuration 



INVITE (SDP Offer #1) (1) (DP Offer) 

100 Trying (2) ((((2P 
Offer) 

183 Progress (SDP Answer #1) (3) 
((((((P 
Offer) 

PRACK (4) 

200 OK (PRACK) (5) 

UPDATE (SDP Offer #2) (6) ((SDP 
Offer) 

200 OK (UPDATE) (SDP Answer #2) (7) 

180 (Ringing) (8) 

200 OK (INVITE) (9) 

ACK (10) 

(Session established . media flowing) 

BYE (11) 

200 OK (BYE) (12) 

Appendix B.1 . Voice Session Establishment & Teardown 

Figure 3 illustrates the assumed message sequence for the establishment and teardown of a 
SIP session across the NNI. 

 

Operator- A Operator-B 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Figure 3 : NNI Session Establishment & Teardown 


 

Message 1 . INVITE (SDP Offer #1) 

INVITE sip:+447960306800@operatorB.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

To: <sip:+447960306800@operatorB.com;user=phone> 

CSeq: 1 INVITE 

Call-ID: dgh1234567@operatorA.com 

Allow: INVITE,PRACK,ACK, CANCEL, UPDATE, PUBLISH, OPTIONS, MESSAGE, BYE, REFER, 
SUBSCRIBE, NOTITY 

P-Asserted-Identity: Tel:+397850316900 


P-Access-Network-Info:3GPP-E-UTRAN-FDD;e-utran-cell-id-3gpp=1234 

Privacy: Id 

P-Charging-Vector: icid-value=Åhabch+23456yÅh; orig-ioi=operatorA.com 

Max-Forwards:70 

P-Early-Media: supported 

Supported: 100rel, timer, precondition, histinfo, from-change 

Session-Expires: 180;refresher=uac 

Min-SE:90 

P-Asserted-Service: urn:urn-7:3gpp-service.ims.icsi.mmtel 

Accept-Contact: +g.3gpp.icsi-ref=Åhurn%3Aurn-7%3A3gpp-service.ims.icsi.mmtelÅh 

Route: sip:10.10.0.1:5060;lr 

Contact: <sip:10.0.0.1:5060>;+g.3gpp.icsi - ref="urn%3Aurn-7%3gpp-service.ims.icsi.mmtel" 

Content-Type: application/sdp 

Content-Length: 440 

v=0 

s=- 

o=- 0 0 IN IP4 10.0.1.1 

t=0 0 

c=IN IP4 10.0.1.1 

m=audio 2000 RTP/AVP 98 99 100 

a=inactive 

a=rtpmap 98 AMR-WB/1600 

a=fmtp 98 octet-align=1 

a=rtpmap 99 AMR/8000 

a=fmtp 99 octet-align=1 

a=rtpmap 100 telephone-event/8000 

a=fmtp 100 0-15 

a=ptime 20 

a=maxptime 20 

a=curr qos local none 

a=des qos mandatory local sendrecv 

a=curr qos remote none 

a=des qos optional remote sendrecv 

a=conf qos remote sendrecv 

b=AS: 45 

 


Message 2 . 100 Trying 

SIP/2.0 100 Trying 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

To: <sip:+447960306800@operatorB.com;user=phone> 

CSeq: 1 INVITE 

Call-ID: dgh1234567@operatorA.com 

Content-Length: 0 

 


Message 3 . 183 Prpgress (SDP Answer #1) 

SIP/2.0 183 Progress 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=ade2345 

CSeq: 1 INVITE 

Call-ID: dgh1234567@operatorA.com 

Allow: INVITE,PRACK,ACK, CANCEL, UPDATE, PUBLISH, OPTIONS, MESSAGE, BYE, REFER, 
SUBSCRIBE, NOTIFY 

P-Asserted-Identity: Tel:+447960306800 

Privacy: none 

P-Access-Network-Info:3GPP-E-UTRAN-FDD;e-utran-cell-id-3gpp=5678910 

P-Early-Media: supported 

Require:100rel 

RSeq:1234 

Supported: 100rel, timer, precondition, histinfo, from-change 

P-Asserted-Service: urn:urn-7:3gpp-service.ims.icsi.mmtel 

P-Charging-Vector: icid-value=Åhabch+23456yÅh; orig-ioi=operatorA.com; term-ioi=OperatorB.com 

Accept-Contact: +g.3gpp.icsi-ref=Åhurn%3Aurn-7%3A3gpp-service.ims.icsi.mmtelÅh 

Contact: <sip:10.10.0.1:5060>;+g.3gpp.icsi - ref="urn%3Aurn-7%3gpp-service.ims.icsi.mmtel" 

Content-Type: application/sdp 

Content-Length: 392 

v=0 

s=- 

o=- 0 0 IN IP4 10.10.1.1 

t=0 0 

c=IN IP4 10.10.1.1 

m=audio 3000 RTP/AVP 98 100 

a=inactive 

a=rtpmap 98 AMR-WB/1600 

a=fmtp 98 octet-align=1 

a=rtpmap 100 telephone-event/8000 

a=fmtp 100 0-15 

a=ptime 20 

a=maxptime 20 

a=curr qos local none 

a=des qos mandatory local sendrecv 

a=curr qos remote none 

a=des qos optional remote sendrecv 

a=conf qos remote sendrecv 

b=AS: 45 

 


Message 4 . PRACK 

PRACK sip:+447960306800@operatorB.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=ade2345 

CSeq: 2 PRACK 

Call-ID: dgh1234567@operatorA.com 

RAck:1234 

Max-Forwards:70 

Route: sip:10.10.0.1:5060;lr 

Contact: <sip:10.0.0.1:5060> 

Content-Length: 0 

 

Message 5 . 200 OK (PRACK) 

SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=ade2345 

CSeq: 2 PRACK 

Call-ID: dgh1234567@operatorA.com 

Content-Type: application/sdp 

Content-Length: 0 

 


Message 6 . UPDATE (SDP Offer #2) 

UPDATE sip:+447960306800@operatorB.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=ade2345 

CSeq: 3 UPDATE 

Call-ID: dgh1234567@operatorA.com 

Max-Forwards:70 

Route: sip:10.10.0.1:5060;lr 

Contact: <sip:10.0.0.1:5060> 

Content-Type: application/sdp 

Content-Length: 394 

v=0 

s=- 

o=- 0 0 IN IP4 10.0.1.1 

t=0 0 

c=IN IP4 10.0.1.1 

m=audio 2000 RTP/AVP 98 100 

a=sendrecv 

a=rtpmap 98 AMR-WB/1600 

a=fmtp 98 octet-align=1 

a=rtpmap 100 telephone-event/8000 

a=fmtp 100 0-15 

a=ptime 20 

a=maxptime 20 

a=curr qos local sendrecv 

a=des qos mandatory local sendrecv 

a=curr qos remote none 

a=des qos optional remote sendrecv 

a=conf qos remote sendrecv 

b=AS: 45 

 


Message 7 . 200 OK (UPDATE) (SDP Answer #2) 

SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=ade2345 

CSeq: 3 UPDATE 

Call-ID: dgh1234567@operatorA.com 

Contact: <sip:10.10.0.1:5060> 

Content-Type: application/sdp 

Content-Length: 371 

v=0 

s=- 

o=- 0 0 IN IP4 10.10.1.1 

t=0 0 

c=IN IP4 10.10.1.1 

m=audio 3000 RTP/AVP 98 100 

a=sendrecv 

a=rtpmap 98 AMR-WB/1600 

a=fmtp 98 octet-align=1 

a=rtpmap 100 telephone-event/8000 

a=fmtp 100 0-15 

a=ptime 20 

a=maxptime 20 

a=curr qos local sendrecv 

a=des qos mandatory local sendrecv 

a=curr qos remote sendrecv 

a=des qos optional remote sendrecv 

b=AS: 45 

 


Message 8 . 180 Ringing 

SIP/2.0 180 Ringing 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=ade2345 

CSeq: 1 INVITE 

Call-ID: dgh1234567@operatorA.com 

Allow: INVITE,PRACK,ACK, CANCEL, UPDATE, PUBLISH, OPTIONS, MESSAGE, BYE, REFER, 
SUBSCRIBE, NOTIFY 

P-Asserted-Identity: Tel:+447960306800 

Privacy: none 

P-Access-Network-Info:3GPP-E-UTRAN-FDD;e-utran-cell-id-3gpp=5678910 

P-Charging-Vector: icid-value=Åhabch+23456yÅh; orig-ioi=operatorA.com; term-ioi=OperatorB.com 

Supported: 100rel, timer, precondition, histinfo, from-change 

P-Asserted-Service: urn:urn-7:3gpp-service.ims.icsi.mmtel 

Accept-Contact: +g.3gpp.icsi-ref=Åhurn%3Aurn-7%3A3gpp-service.ims.icsi.mmtelÅh 

Contact: <sip:10.10.0.1:5060>;+g.3gpp.icsi - ref="urn%3Aurn-7%3gpp-service.ims.icsi.mmtel" 

Content-Length: 0 

 

Message 9 . 200 OK (INVITE) 

SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=ade2345 

CSeq: 1 INVITE 

Call-ID: dgh1234567@operatorA.com 

Allow: INVITE,PRACK,ACK, CANCEL, UPDATE, PUBLISH, OPTIONS, MESSAGE, BYE, REFER, 
SUBSCRIBE, NOTIFY 

P-Asserted-Identity: Tel:+447960306800 

Privacy: none 

P-Access-Network-Info:3GPP-E-UTRAN-FDD;e-utran-cell-id-3gpp=5678910 

P-Charging-Vector: icid-value=Åhabch+23456yÅh; orig-ioi=operatorA.com; term-ioi=OperatorB.com 

Supported: 100rel, timer, precondition, histinfo, from-change 

Session-Expires: 150;refresher=uac 

Require:timer 

P-Asserted-Service: urn:urn-7:3gpp-service.ims.icsi.mmtel 

Accept-Contact: +g.3gpp.icsi-ref=Åhurn%3Aurn-7%3A3gpp-service.ims.icsi.mmtelÅh 

Contact: <sip:10.10.0.1:5060>;+g.3gpp.icsi - ref="urn%3Aurn-7%3gpp-service.ims.icsi.mmtel" 

Content-Length: 0 

 


Message 10 . ACK 

ACK sip:+447960306800@operatorB.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=ade2345 

CSeq: 4 ACK 

Call-ID: dgh1234567@operatorA.com 

Max-Forwards:70 

Route: sip:10.0.1.1:5060;lr 

Contact: <sip:10.0.0.1:5060> 

Content-Length:0 

 

Message 11 . BYE 

BYE sip:+447960306800@operatorB.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=ade2345 

CSeq: 5 BYE 

Call-ID: dgh1234567@operatorA.com 

Max-Forwards:70 

Route: sip:10.10.0.1:5060;lr 

Content-Length:0 

 

Message 12 . 200 OK (BYE) 

SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=ade2345 

CSeq: 5 BYE 

Call-ID: dgh1234567@operatorA.com 

Content-Length: 0 

 


Appendix B.2 . Multi-Media Session Establishment & Teardown 

This appendix covers the case of a voice and video multi-media session establishment and 
teardown. The message flow and numbering is identical to that of appendix B.1. The main 
difference is in the SDP exchange. In addition, the MMTel ICSI will reflect that video 
telephony is also possible. These differences will be highlighted in this sub-appendix with 
references made to messages in appendix B.1. 

 

Message 1 . INVITE (SDP Offer #1) 

As appendix B.1 with modified P-Asserted-Service, Contact & Accept-Contact headers plus multi-
media SDP in the message body. 

ÅcÅcÅcÅc 

P-Asserted-Service: urn:urn-7:3gpp-service.ims.icsi.mmtel;video 

Accept-Contact: +g.3gpp.icsi-ref=Åhurn%3Aurn-7%3A3gpp-service.ims.icsi.mmtel;videoÅh 

Contact: <sip:10.0.0.1:5060>;+g.3gpp.icsi - ref="urn%3Aurn-7%3gpp-service.ims.icsi.mmte;video" 

Content-Type: application/sdp 

Content-Length: 858 

v=0 

s=- 

o=- 0 0 IN IP4 10.0.1.1 

t=0 0 

c=IN IP4 10.0.1.1 

m=audio 2000 RTP/AVP 98 99 100 

a=inactive 

a=rtpmap: 98 AMR-WB/1600 

a=fmtp: 98 octet-align=1 

a=rtpmap: 99 AMR/8000 

a=fmtp: 99 octet-align=1 

a=rtpmap: 100 telephone-event/8000 

a=fmtp: 100 0-15 

a=ptime 20 

a=maxptime 20 

a=curr qos local none 

a=des qos mandatory local sendrecv 

a=curr qos remote none 

a=des qos optional remote sendrecv 

a=conf qos remote sendrecv 

b=AS: 45 

m=video 4000 RTP/AVP 101 102 

a=inactive 

a=rtpmap: 101 H264/90000 

a=fmtp: 101 profile-level-id=42C016; packetization-mode=1;sprop-parameter-sets=Z0LAFukDwKMg,aM4G4g== octet-align=1 

a=rtpmap: 102 H263-2000/90000 

a=fmtp 102 profile=0;level=10;QCIF=2 

a=curr qos local none 

a=des qos mandatory local sendrecv 


a=curr qos remote none 

a=des qos optional remote sendrecv 

a=conf qos remote sendrecv 

b=AS: 768 

 


Message 2 . 100 Trying 

As appendix B.1. 

 

Message 3 . 183 Prpgress (SDP Answer #1) 

As appendix B.1 with multi-media SDP in the message body. 

ÅcÅcÅcÅc 

P-Asserted-Service: urn:urn-7:3gpp-service.ims.icsi.mmtel;video 

Accept-Contact: +g.3gpp.icsi-ref=Åhurn%3Aurn-7%3A3gpp-service.ims.icsi.mmtel;videoÅh 

Contact: <sip:10.10.0.1:5060>;+g.3gpp.icsi - ref="urn%3Aurn-7%3gpp-service.ims.icsi.mmte;video" 

Content-Type: application/sdp 

Content-Length: 732 

v=0 

s=- 

o=- 0 0 IN IP4 10.10.1.1 

t=0 0 

c=IN IP4 10.10.1.1 

m=audio 3000 RTP/AVP 98 100 

a=inactive 

a=rtpmap 98 AMR-WB/1600 

a=fmtp 98 octet-align=1 

a=rtpmap 100 telephone-event/8000 

a=fmtp 100 0-15 

a=ptime 20 

a=maxptime 20 

a=curr qos local none 

a=des qos mandatory local sendrecv 

a=curr qos remote none 

a=des qos optional remote sendrecv 

a=conf qos remote sendrecv 

b=AS: 45 

m=video 6000 RTP/AVP 101 

a=inactive 

a=rtpmap: 101 H264/90000 

a=fmtp: 101 profile-level-id=42C016; packetization-mode=1;sprop-parameter-sets=Z0LAFukDwKMg,aM4G4g== octet-align=1 

a=curr qos local none 

a=des qos mandatory local sendrecv 

a=curr qos remote none 

a=des qos optional remote sendrecv 

a=conf qos remote sendrecv 

b=AS: 768 

 


Message 4 . PRACK 

As appendix B.1. 

 

Message 5 . 200 OK (PRACK) 

As appendix B.1. 

 

Message 6 . UPDATE (SDP Offer #2) 

As appendix B.1 with multi-media SDP in the message body. 

ÅcÅcÅcÅcÅc. 

Content-Type: application/sdp 

Content-Length: 738 

v=0 

s=- 

o=- 0 0 IN IP4 10.0.1.1 

t=0 0 

c=IN IP4 10.0.1.1 

m=audio 2000 RTP/AVP 98 100 

a=sendrecv 

a=rtpmap 98 AMR-WB/1600 

a=fmtp 98 octet-align=1 

a=rtpmap 100 telephone-event/8000 

a=fmtp 100 0-15 

a=ptime 20 

a=maxptime 20 

a=curr qos local sendrecv 

a=des qos mandatory local sendrecv 

a=curr qos remote none 

a=des qos optional remote sendrecv 

a=conf qos remote sendrecv 

b=AS: 45 

m=video 4000 RTP/AVP 101 

a=sendrecv 

a=rtpmap: 101 H264/90000 

a=fmtp: 101 profile-level-id=42C016; packetization-mode=1;sprop-parameter-sets=Z0LAFukDwKMg,aM4G4g== octet-align=1 

a=curr qos local sendrecv 

a=des qos mandatory local sendrecv 

a=curr qos remote none 

a=des qos optional remote sendrecv 

a=conf qos remote sendrecv 

b=AS: 768 

 


Message 7 . 200 OK (UPDATE) (SDP Answer #2) 

As appendix B.1 with multi-media SDP in the message body. 

ÅcÅcÅcÅc. 

Content-Type: application/sdp 

Content-Length: 690 

v=0 

s=- 

o=- 0 0 IN IP4 10.10.1.1 

t=0 0 

c=IN IP4 10.10.1.1 

m=audio 3000 RTP/AVP 98 100 

a=sendrecv 

a=rtpmap 98 AMR-WB/1600 

a=fmtp 98 octet-align=1 

a=rtpmap 100 telephone-event/8000 

a=fmtp 100 0-15 

a=ptime 20 

a=maxptime 20 

a=curr qos local sendrecv 

a=des qos mandatory local sendrecv 

a=curr qos remote sendrecv 

a=des qos optional remote sendrecv 

b=AS: 45 

m=video 6000 RTP/AVP 101 

a=sendrecv 

a=rtpmap: 101 H264/90000 

a=fmtp: 101 profile-level-id=42C016; packetization-mode=1;sprop-parameter-sets=Z0LAFukDwKMg,aM4G4g== octet-align=1 

a=curr qos local sendrecv 

a=des qos mandatory local sendrecv 

a=curr qos remote sendrecv 

a=des qos optional remote sendrecv 

b=AS: 768 

 

Message 8 . 180 Ringing 

As appendix B.1. with modified P-Asserted-Service, Contact & Accept-Contact headers. 

ÅcÅc.. 

P-Asserted-Service: urn:urn-7:3gpp-service.ims.icsi.mmtel;video 

Accept-Contact: +g.3gpp.icsi-ref=Åhurn%3Aurn-7%3A3gpp-service.ims.icsi.mmtel;videoÅh 

Contact: <sip:10.10.0.1:5060>;+g.3gpp.icsi - ref="urn%3Aurn-7%3gpp-service.ims.icsi.mmte;video" 

 


Message 9 . 200 OK (INVITE) 

As appendix B.1. with modified P-Asserted-Service, Contact & Accept-Contact headers. 

ÅcÅc.. 

P-Asserted-Service: urn:urn-7:3gpp-service.ims.icsi.mmtel;video 

Accept-Contact: +g.3gpp.icsi-ref=Åhurn%3Aurn-7%3A3gpp-service.ims.icsi.mmtel;videoÅh 

Contact: <sip:10.10.0.1:5060>;+g.3gpp.icsi - ref="urn%3Aurn-7%3gpp-service.ims.icsi.mmte;video" 

 

Message 10 . ACK 

As appendix B.1. 

 

Message 11 . BYE 

As appendix B.1. 

 

Message 12 . 200 OK (BYE) 

As appendix B.1. 

 


UPDATE (1) (DP Offer) 

200 OK (UPDATE) (2) 

(118 seconds elapse) 

BYE (3) 

200 OK (BYE) (4) 

Appendix B.3 . Use of session timer 

The session establishment sequence in appendix B.1 indicated that session timer (RFC 
4028 [16]) would be used with the UAC generating the refresh messages. The negotiated 
session time was 150 seconds. Therefore, the UAC shall generate a refresh message every 
75 seconds. In the event of the refresh not being sent, then the UAS would terminate the 
session after 118 seconds. 

. 

Operator- A Operator-B 

 

 

 

 

 

 

 

 

 

 

Figure 4 : Session Timer 


 

Message 1 . UPDATE 

UPDATE sip:+447960306800@operatorB.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=ade2345 

CSeq: 11 UPDATE 

Call-ID: dgh1234567@operatorA.com 

Supported: timer 

Session-Expires:150;refresher=uac 

Route: sip:10.10.0.1:5060;lr 

Contact: <sip:10.0.0.1:5060> 

Content-Length:0 

 


Message 2 . 200 OK (UPDATE) 

SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=ade2345 

CSeq: 11 UPDATE 

Call-ID: dgh1234567@operatorA.com 

Require: timer 

Session-Expires:150;refresher=uac 

Contact: <sip:10.10.0.1:5060> 

Content-Length:0 

 

Message 3 . BYE 

BYE sip:+397850316900@operatorA.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.10.0.1:5060;branch=5678910abc 

To: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=ade2345 

CSeq: 1 BYE 

Call-ID: dgh1234567@operatorA.com 

Route: sip:10.0.0.1:5060;lr 

Content-Length:0 

 

Message 4 . 200 OK (BYE) 

SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.10.0.1:5060;branch=5678910abc 

To: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=ade2345 

CSeq: 1 BYE 

Call-ID: dgh1234567@operatorA.com 

Content-Length: 0 

 


Appendix B.4 . Use of Early Media 

This appendix covers the case of early media being sent from the terminating side (e.g. the 
call break out into the CS network and ring tone is sent from the terminating side. The 
message flow and numbering is identical to that of appendix B.1. The only difference is in 
the 180 Ringing message, which is shown below:- 

 

Message 8 . 180 Ringing 

SIP/2.0 180 Ringing 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=ade2345 

CSeq: 1 INVITE 

Call-ID: dgh1234567@operatorA.com 

Allow: INVITE,PRACK,ACK, CANCEL, UPDATE, PUBLISH, OPTIONS, MESSAGE, BYE, REFER, 
SUBSCRIBE, NOTIFY 

P-Asserted-Identity: Tel:+447960306800@operatorB.com 

Privacy: none 

P-Early-Media: sendonly 

Supported: 100rel, timer, precondition, histinfo, from-change 

P-Asserted-Service: urn:urn-7:3gpp-service.ims.icsi.mmtel 

Accept-Contact: +g.3gpp.icsi-ref=Åhurn%3Aurn-7%3A3gpp-service.ims.icsi.mmtelÅh 

Contact: <sip:10.10.0.1:5060>;+g.3gpp.icsi-ref=Åhurn%3Aurn-7%3A3gpp-service.ims.icsi.mmtelÅh 

Content-Length: 0 

 

The presence of the P-Early-Media header causes the IBCF to ensure that RTP packets are 
conveyed in the backward direction via the TrGW. 

 


REGISTER (1) (DP Offer) 

401 Unauthorized (2) ((((2P 
Offer) 

REGISTER (3) 

200 OK (REGISTER) (4) 

SUBSCRIBE (5) ((SDP 
Offer) 

200 OK (SUBSCRIBE) (6) 

NOTIFY (7) 

200 OK (NOTIFY) (8) 

SUBSCRIBE (9) ((SDP 
Offer) 

200 OK (SUBSCRIBE) (10) 

NOTIFY (11) 

200 OK (NOTIFY) (12) 

Appendix B.5 . IMS Registration 

Figure 5 illustrates the assumed message sequence for IMS registration. This flow is 
applicable only to the roaming NNI (i.e. UE roaming in a visited network and performing IMS 
registration to its home network). The P-CSCF shall be in the visited network and the S-
CSCF in the home network with the Mw reference point crossing the NNI. The SUBSCRIBE 
message is sent from both the P-CSCF and UE in the visited network to the S-CSCF in the 
home network. In this example, the UE is assumed to support MMTel services as well as a 
number of RCS services. 

. 

Operator- A Operator-B 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Figure 5 : IMS Registration 


In the above flow, it is assumed that user +447960306800@operatorB.com is roaming in the 
network of operatorA. The message contents are below:- 

 


Message 1 . REGISTER 

REGISTER sip:operatorB.com SIP/2.0 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=7895ad34 

To: <sip:+447960306800@operatorB.com;user=phone> 

CSeq: 1 REGISTER 

Call-ID: dgh1234567@operatorB.com 

P-Access-Network-Info:3GPP-E-UTRAN-FDD;e-utran-cell-id-3gpp=1234 

P-Visited-Network-Id: ÅgoperatorA.comÅh 

Max-Forwards:70 

Authorization:Digest username=user1234567@operatorB.com, realm=Åhoperator.comÅh, 
uri=ÅhsipÅhoperator.comÅh, nonce=ÅhÅh, response=ÅhÅh 

P-Charging-Vector: icid-value=Åhabch+23456yÅh; orig-ioi=operatorA.com 

Require: path 

Supported: gruu 

Path: <sip:10.0.0.1:5060;lr> 

Route: sip:10.10.0.1:5060;lr 

Contact: <sip:10.0.0.1:5060>; +sip.instance=Åh<urn:gsma:imei:90420156-025763-0>Åh; +g.3gpp.smsip, 
+g.3gpp.icsi - ref="urn%3Aurn-7%3A3gpp-service.ims.icsi.mmtel;video, urn%3Aurn-7%3A3gpp-
service.ims.icsi.oma.cpm.msg; urn%3Aurn-7%3A3gpp-service.ims.icsi.oma.cpm.largemsgÅh; 
+g.3gpp.iari-ref="urn%3Aurn-7%3A3gpp-application.ims.iari.rcse.im, urn%3Aurn-7%3A3gpp-
application.ims.iari.rcse.ft, urn%3Aurn-7%3A3gpp-application.ims.iari.rcs.ftthumb, urn%3Aurn-
7%3A3gpp-application.ims.iari.gsma-is, urn:urn-7%3A3gpp-application.ims.iari.gsma-vs" 

Content-Length: 0 

 

Message 2 . 401 Unauthorised 

SIP/2.0 401 Unauthorised 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=7895ad34 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=34589012 

CSeq: 1 REGISTER 

Call-ID: dgh1234567@operatorB.com 

WWW-Authenticate:Digest realm=Åhscscf12.operator.comÅh, 
nonce=Åh12ab34bc4567b45RTFGH12323asdfghGHDe34500oOlP+Åh, algorithm=AKAv1-MD5, ik=2345, 
ck=5678 

Content-Length: 0 

 


Message 3 . REGISTER 

REGISTER sip:operatorB.com SIP/2.0 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=12345678778 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=56ad7111 

To: <sip:+447960306800@operatorB.com;user=phone> 

CSeq: 2 REGISTER 

Call-ID: dgh1234567@operatorB.com 

P-Access-Network-Info:3GPP-E-UTRAN-FDD;e-utran-cell-id-3gpp=1234 

P-Visited-Network-Id: ÅgoperatorA.comÅh 

Max-Forwards:70 

Authorization:Digest username=user1234567@operatorB.com, realm=Åhscscf12.operator.comÅh, 
uri=ÅhsipÅhoperator.com nonce=Åh12ab34bc4567b45RTFGH12323asdfghGHDe34500oOlP+Åh, 
response=Åh2345bcdef567bf54efÅh 

P-Charging-Vector: icid-value=Åhabch+236788aÅh; orig-ioi=operatorA.com 

Require: path 

Supported: gruu 

Path: <sip:10.0.0.1:5060;lr> 

Route: sip:10.10.0.1:5060;lr 

Contact: <sip:10.0.0.1:5060>;+sip.instance=Åh<urn:gsma:imei:90420156-025763-0>Åh; +g.3gpp.smsip, 
+g.3gpp.icsi - ref="urn%3Aurn-7%3A3gpp-service.ims.icsi.mmtel;video, urn%3Aurn-7%3A3gpp-
service.ims.icsi.oma.cpm.msg; urn%3Aurn-7%3A3gpp-service.ims.icsi.oma.cpm.largemsgÅh; 
+g.3gpp.iari-ref="urn%3Aurn-7%3A3gpp-application.ims.iari.rcse.im, urn%3Aurn-7%3A3gpp-
application.ims.iari.rcse.ft, urn%3Aurn-7%3A3gpp-application.ims.iari.rcs.ftthumb, urn%3Aurn-
7%3A3gpp-application.ims.iari.gsma-is, urn:urn-7%3A3gpp-application.ims.iari.gsma-vs" 

Content-Length: 0 

 

Message 4 . 200 OK (REGISTER) 

SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=12345678778 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=56ad7111 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=34578231 

CSeq: 2 REGISTER 

Call-ID: dgh1234567@operatorB.com 

P-Access-Network-Info:3GPP-E-UTRAN-FDD;e-utran-cell-id-3gpp=1234 

P-Charging-Vector: icid-value=Åhabch+236788aÅh; orig-ioi=operatorA.com; term-ioi=operatorB.com 

P-Associated-URI:sip:+447960306800@operatorB.com;user=phone 

Service-Route: <sip:10.10.0.1:5060;lr> 

Contact: <sip:10.10.0.1:5060>;expires=3600 

Content-Length: 0 

 


Message 5 . SUBSCRIBE 

SUBSCRIBE sip:+447960306800@operatorB.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=587903ab 

From: <sip: ibcf4@operatorA.com>;tag=123456 

To: <sip: +447960306800@operatorB.com;user=phone> 

CSeq: 10 SUBSCRIBE 

Call-ID: 5634567@operatorA.com 

Max-Forwards: 70 

P-Charging-Vector: icid-value=Åhabch+23456yÅh; orig-ioi=operatorA.com; term-ioi=operatorB.com 

Event: reg 

P-Asserted-Id: <sip:10.0.0.1:5060;lr> 

Expires:4000 

Accept: application/reginfo+xml 

Route: sip:10.10.0.1:5060;lr 

Contact: <sip:10.0.0.1:5060> 

Content-Length: 0 

 

Message 6 . 200 OK (SUBSCRIBE) 

SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=587903ab 

From: <sip: ibcf4@operatorA.com>;tag=123456 

To: <sip: +447960306800@operatorB.com;user=phone>;tag=7612345 

CSeq: 10 SUBSCRIBE 

Call-ID: 5634567@operatorA.com 

Event: reg 

Expires: 3600 

P-Charging-Vector: icid-value=Åhabch+23456yÅh; orig-ioi=operatorA.com; term-ioi=operatorB.com 

Contact: <sip:10.10.0.1:5060> 

Content-Length: 0 

 


Message 7 . NOTIFY 

NOTIFY sip:ibcf4@operatorA.com SIP/2.0 

Via: SIP/2.0/UDP 10.10.0.1:5060;branch=abc45678 

To: <sip: ibcf4@operatorA.com>;tag=123456 

From: <sip: +447960306800@operatorB.com;user=phone>;tag=7612345 

Call-ID: 5634567@operatorA.com 

CSeq: 20 NOTIFY 

Max-Forwards: 70 

Subscription-State: Active;Expires=3600 

Event: reg 

Accept: application/reginfo+xml 

Route: sip:10.0.0.1:5060;lr 

Contact: <sip:10.10.0.1:5060> 

Content-Type: application/reginfo+xml 

Content-Length: xx 

 

[Registration Info] - see RFC 3680 [50] 

 

Message 8 . 200 OK (NOTIFY) 

SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.10.0.1:5060;branch=abc45678 

To: <sip: ibcf4@operatorA.com>;tag=123456 

From: <sip: +447960306800@operatorB.com;user=phone>;tag=7612345 

Call-ID: 5634567@operatorA.com 

CSeq: 20 NOTIFY 

Contact: <sip:10.10.0.1:5060> 

Content-Length:0 

 

Messages 9-12 

As messages 5-8 apart from the CSeq and Call-Id headers and From/To tags changing accordingly. 

 


Appendix B.6 . MMTel Services 

This appendix covers the impacts on the NNI services due to the mandatory set of MMTel 
services as listed in GSMA PRD IR.92 [5]. Dependent on the impact of the service, 
references/changes to basic call messages or additional call flows will be listed. 

Originating Identification Presentation (OIP) 

There is no further impact on basic call signalling due to OIP. The OIP service uses the P-
Asserted-Identity and associated Privacy and From headers that are sent in the INVITE 
message. 

Originating Identification Restriction (OIR) 

There is no further impact on basic call signalling due to OIR. The OIR service causes the 
Privacy header in the INVITE message to be set to :- 

Privacy:Id 

Addditionally, the value ÅeuserÅf can be added to the Privacy header and/or the From header 
can be anonymized. 

 


UPDATE (1) (DP Offer) 

200 OK (UPDATE) (2) 

Terminating Identification Presentation (TIP) 

The TIP service uses the P-Asserted-Identity and associated Privacy headers that are sent 
in the 18X / 200 OK (INVITE) messages. There is one small change to the basic call 
signalling, namely that an additional option tag (Ågfrom-changeÅh - see IETF RFC 4916 [49]) 
may be exchanged across the NNI. This option indicates that it is possible to pass a 
connected party identity subsequent to the session being established (i.e. post 200 OK 
(INVITE)/ACK). The modified identity would be passed in a FROM header in the URI portion 
and re-using the previous FROM tag used in the initial dialog establishment. The updated 
FROM header may be sent in a SIP UPDATE or re-INVITE message. An example of the 
UPDATE exchange is shown in figure 6:- 

 

Operator- A Operator-B 

 

 

 

 

Figure 6 : TIP (from Change) 


 

The message contents are as follows (assuming session establishment as per appendix B.1) 
:- 

 

Message 1 . UPDATE 

UPDATE sip:+397850316900@operatorA.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.10.0.1:5060;branch=7654321 

To: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

From: <sip:+447960306812@operatorB.com;user=phone>;tag=ade2345 

CSeq: 1 UPDATE 

Call-ID: dgh1234567@operatorA.com 

Route: sip:10. 0.0.1:5060;lr 

Contact: <sip:10.10.0.1:5060> 

Content-Length:0 

Message 2 . 200 OK (UPDATE) 

SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.10.0.1:5060;branch=7654321 

To: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

From: <sip:+447960306812@operatorB.com;user=phone>;tag=ade2345 

CSeq: 1 UPDATE 

Call-ID: dgh1234567@operatorA.com 

Contact: <sip:10.0.0.1:5060> 

Content-Length:0 


INVITE (1) (DP Offer) 

603 Decline (2) 

ACK (3) 

Terminating Identification Restriction (TIR) 

There is no further impact on basic call signalling due to TIR. The TIR service causes the 
Pivacy headers in the 18X / 200 OK (INVITE) messages to be set as follows :- 

Privacy:Id 

Communication Waiting (CW) 

As stated in GSMA PRD IR.92 [5], it is assumed that the terminal based flavour of the 
service is used. The sole change is that the alert-info header is conveyed in the 180 Ringing 
message to inform the originating UE that this is a waiting communication, e.g. 

Alert-Info:<urn:alert:service:call-waiting> 

In addition, the AS may also (on receiving a 180 Ringing message with the Alert-Info header 
present) connect an indication which would be reflected as a modified Offer/Answer 
exchange between the AS/MRFC and UE. 

Outgoing Communication Barring (OCB) 

This includes a number of flavours, namely Barring of All Outgoing Calls, Barring of 
Outgoing International Calls & Barring of Outgoing Calls (ex Home Country). These features 
are only applicable at the NNI in the roaming NNI scenario. The message flow is shown in 
figure 7. Note that the MMTel AS may optionally connect an indication prior to generating the 
603 Decline response, which could result in related Offer/Answer exchanges between the 
AS/MRFC and UE. 

 

Operator- A Operator-B 

 

 

 

 

 

 

Figure 7 : OCB 


 

Message 1 . INVITE 

As Appendix B.1. 

 

Message 2 . 603 Decline 

SIP/2.0 603 Decline 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=ade2345 

CSeq: 1 INVITE 

Call-ID: dgh1234567@operatorA.com 

Content-Length: 0 


Message 3 . ACK 

As Appendix B.1. 

 


INVITE (1) (DP Offer) 

ACK (3) 

603 Decline (2) 

Incoming Communication Barring (ICB) 

This includes two flavours, namely Barring of All Incoming Calls & Barring of Incoming Calls 
when roaming. The message flow is shown in figure 8. Note that the MMTel AS may 
optionally connect an indication prior to generating the 603 Decline response, which could 
result in related Offer/Answer exchanges between the AS/MRFC and UE. 

 

Operator- A Operator-B 

 

 

 

 

 

 

Figure 8: ICB 


 

Message 1 . INVITE 

As Appendix B.1. 

 

Message 2 . 603 Decline 

SIP/2.0 603 Decline 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=ade2345 

CSeq: 1 INVITE 

Call-ID: dgh1234567@operatorA.com 

Content-Length: 0 

 

Message 3 . ACK 

As Appendix B.1. 

 


UPDATE (1) (DP Offer) 

200 OK (UPDATE) (2) 

Communication Hold (CH) 

This service is realised via an additional offer/answer exchange where the bi-driectional 
media (as established in appendix B.1) is set to sendonly. The message flow for CH is as 
shown in figure 9. Answer exchanges between the AS/MRFC and UE. 

 

Operator- A Operator-B 

 

 

 

 

Figure 9 : Communication Hold 


 

Message 1 . UPDATE (SDP Offer #2) 

UPDATE sip:+447960306800@operatorB.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=ade2345 

CSeq: 11 UPDATE 

Call-ID: dgh1234567@operatorA.com 

Route: sip:10.10.0.1:5060;lr 

Contact: <sip:10.0.0.1:5060> 

Content-Type: application/sdp 

Content-Length: 394 

v=0 

s=- 

o=- 0 0 IN IP4 10.0.1.1 

t=0 0 

c=IN IP4 10.0.1.1 

m=audio 2000 RTP/AVP 98 100 

a=sendonly 

a=rtpmap 98 AMR-WB/1600 

a=fmtp 98 octet-align=1 

a=rtpmap 100 telephone-event/8000 

a=fmtp 100 0-15 

a=ptime 20 

a=maxptime 20 

a=curr qos local sendrecv 

a=des qos mandatory local sendrecv 

a=curr qos remote none 

a=des qos optional remote sendrecv 

a=conf qos remote sendrecv 

b=AS: 45 


 


Message 2 . 200 OK (UPDATE) (SDP Answer #2) 

SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=ade2345 

CSeq: 11 UPDATE 

Call-ID: dgh1234567@operatorA.com 

Contact: <sip:10.10.0.1:5060> 

Content-Type: application/sdp 

Content-Length: 371 

v=0 

s=- 

o=- 0 0 IN IP4 10.10.1.1 

t=0 0 

c=IN IP4 10.10.1.1 

m=audio 3000 RTP/AVP 98 100 

a=recvonly 

a=rtpmap 98 AMR-WB/1600 

a=fmtp 98 octet-align=1 

a=rtpmap 100 telephone-event/8000 

a=fmtp 100 0-15 

a=ptime 20 

a=maxptime 20 

a=curr qos local sendrecv 

a=des qos mandatory local sendrecv 

a=curr qos remote sendrecv 

a=des qos optional remote sendrecv 

b=AS: 45 

Note that the MMTel AS may insert an announcement, in which case the new offer/answer would 
reflect the presence of the MRFP. 

The session may be resumed to duplex speech with a further offer answer exchange with the media 
attribute line restored to ÅgsendrecvÅh. 

 


INVITE (SDP Offer #1) (1) (DP Offer) 

100 Trying (2) ((((2P 
Offer) 

181 Call is being forwarded (2a) 
((((((P 
Offer) 

183 Progress (SDP Answer #1) (3) 
((((((P 
Offer) 

PRACK (4) 

200 OK (PRACK) (5) 

UPDATE (SDP Offer #2) (6) ((SDP 
Offer) 

200 OK (UPDATE) (SDP Answer #2) (7) 

180 (Ringing) (8) 

200 OK (INVITE) (9) 

ACK (10) 

Communication Forwarding (CFx) 

This service has a number of flavours, namely Unconditional (CFU), Not Logged In (CFNL), 
Busy (CFB), Not Reachable (CFNRc), Communication Deflection (CD) and No Reply 
(CFNR). Note that CD is not in scope in GSMA PRD IR.92 [5]. The service impacts both 
forward and backward SIP signalling across the NNI. In the example here, it is assumed that 
CFU is used. Further, it is assumed that an initial call forwarding occurs in the originating 
network with the call being offered across the NNI to the terminating network where a 
second call forwarding occurs. The message flow is as shown in figure 10 :- 

 

Operator- A Operator-B 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Figure 10: Call Forwarding 


 

The message contents are as shown below. Note that it is assumed that the originating party 
(+397850316900@operatorA) initially calls user +397850516900@operatorA and the call is 
forwarded (CFU) to +447960306800@operatorB. Subsequently, CFU is encountered in the 
terminating network and the call is re-targeted to its final destination of 
+447960306900@operatorB. 

The message contents are very close to the corresponding messages in appendix B.1 . and 
therefore only differences from appendix B.1 will be shown here. 

 


Message 1 . INVITE (SDP Offer #1) 

INVITE sip:+447960306800@operatorB.com;user=phone;cause=302 SIP/2.0 

History-Info:<sip:+397850516900@operatorA;user=phone?privacy=history>;index=1, 
<sip:+447960306800@operatorB;user=phone;cause=302>;index=1.1 

 

Message 2 . 100 Trying 

As appendix B.1. 

 

Message 2a . 181 Call is being forwarded 

SIP/2.0 181 Call is being forwarded 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=ade2345 

CSeq: 1 INVITE 

Call-ID: dgh1234567@operatorA.com 

Allow: INVITE,PRACK,ACK, CANCEL, UPDATE, PUBLISH, OPTIONS, MESSAGE, BYE, REFER, 
SUBSCRIBE, NOTIFY 

P-Asserted-Identity: Tel:+447960306900@operatorB.com 

Privacy: none 

History-Info:<sip:+397850516900@operatorA;user=phone?privacy=history>;index=1, 
<sip:+447960306800@operatorB;user=phone;cause=302>;index=1.1, 

<sip:+447960306900@operatorB;user=phone;cause=302>;index=1.1.1 

P-Access-Network-Info:3GPP-E-UTRAN-FDD;e-utran-cell-id-3gpp=9108910 

P-Early-Media: supported 

Supported: 100rel, timer, precondition, histinfo, from-change 

P-Asserted-Service: urn:urn-7:3gpp-service.ims.icsi.mmtel 

Accept-Contact: +g.3gpp.icsi-ref=Åhurn%3Aurn-7%3A3gpp-service.ims.icsi.mmtelÅh 

Contact: <sip:10.10.0.1:5060>;+g.3gpp.icsi - ref="urn%3Aurn-7%3gpp-service.ims.icsi.mmtel" 

Content-Length: 0 

 


Message 3 . 183 Prpgress (SDP Answer #1) 

P-Asserted-Identity: Tel:+447960306900@operatorB.com 

P-Access-Network-Info:3GPP-E-UTRAN-FDD;e-utran-cell-id-3gpp=9108910 

History-Info:<sip:+397850516900@operatorA;user=phone?privacy=history>;index=1, 
<sip:+447960306800@operatorB;user=phone;cause=302>;index=1.1, 

<sip:+447960306900@operatorB;user=phone;cause=302>;index=1.1.1 

 

Message 4 . PRACK 

PRACK sip:+447960306800@operatorB.com;user=phone;cause=302 SIP/2.0 

 

Message 5 . 200 OK (PRACK) 

As appendix B.1. 

 

Message 6 . UPDATE (SDP Offer #2) 

UPDATE sip:+447960306800@operatorB.com;user=phone;cause=302 SIP/2.0 

 

Message 7 . 200 OK (UPDATE) (SDP Answer #2) 

As appendix B.1. 

 

Message 8 . 180 Ringing 

P-Asserted-Identity: Tel:+447960306900@operatorB.com 

P-Access-Network-Info:3GPP-E-UTRAN-FDD;e-utran-cell-id-3gpp=9108910 

History-Info:<sip:+397850516900@operatorA;user=phone?privacy=history>;index=1, 
<sip:+447960306800@operatorB;user=phone;cause=302>;index=1.1, 

<sip:+447960306900@operatorB;user=phone;cause=302>;index=1.1.1 

 

Message 9 . 200 OK (INVITE) 

P-Asserted-Identity: Tel:+447960306900@operatorB.com 

P-Access-Network-Info:3GPP-E-UTRAN-FDD;e-utran-cell-id-3gpp=9108910 

History-Info:<sip:+397850516900@operatorA;user=phone?privacy=history>;index=1, 
<sip:+447960306800@operatorB;user=phone;cause=302>;index=1.1, 

<sip:+447960306900@operatorB;user=phone;cause=302>;index=1.1.1 

 

Message 10 . ACK 

ACK sip:+447960306800@operatorB.com;user=phone;cause=302 SIP/2.0 

 


SUBSCRIBE (1) (DP Offer) 

200 OK (SUBSCRIBE) (2) ((((2P 
Offer) 

NOTIFY (3) 
((((((P 
Offer) 

200 OK (NOTIFY) (4) 

Message Waiting Indication (MWI) 

As stated in GSMA PRD IR.92 [5], it is assumed that this service uses the Message Waiting 
Indication (see IETF RFC 3842 [42]). 

This service crosses the NNI only in the roaming NNI case (i.e. UE is visited network and 
MMTel AS in the home network. The message sequence is shown in figure 11. 

Operator- A Operator-B 

 

 

 

 

 

 

 

 

Figure 11 : Message Waiting 


 

The message contents are as shown below. 

 


Message 1 . SUBSCRIBE 

SUBSCRIBE sip:+447960306800@operatorB.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip: +447960306800@operatorB.com;user=phone>;tag=5678ab34 

To: <sip: +447960306800@operatorB.com;user=phone> 

CSeq: 1 SUBSCRIBE 

Call-ID: abc1234567@operatorB.com 

P-Asserted-Identity: Tel:+447960306800 

P-Access-Network-Info:3GPP-E-UTRAN-FDD;e-utran-cell-id-3gpp=1234 

Privacy: Id 

Max-Forwards: 70 

P-Charging-Vector: icid-value=Åhabch+23456yÅh; orig-ioi=operatorA.com; term-ioi=operatorB.com 

Expires:7200 

Event: message-summary 

Accept: application/simple-message-summary 

Route: sip:10.10.0.1:5060;lr 

Contact: <sip:10.0.0.1:5060> 

Content-Length: 0 

 

Message 2 . 200 OK (SUBSCRIBE) 

SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip: +447960306800@operatorB.com;user=phone>;tag=5678ab34 

To: <sip: +447960306800@operatorB.com;user=phone>;tag=123456 

CSeq: 1 SUBSCRIBE 

Call-ID: abc1234567@operatorB.com 

Event: message-summary 

Expires: 7200 

P-Charging-Vector: icid-value=Åhabch+23456yÅh; orig-ioi=operatorA.com; term-ioi=operatorB.com 

Contact: <sip:10.10.0.1:5060> 

Content-Length: 0 

 


Message 3 . NOTIFY 

NOTIFY sip:+447960306800@operatorB.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.10.0.1:5060;branch=567891234a 

To: <sip: +447960306800@operatorB.com;user=phone>;tag=5678ab34 

From: <sip: +447960306800@operatorB.com;user=phone>;tag=123456 

Call-ID: abc1234567@operatorB.com 

CSeq: 12 NOTIFY 

Max-Forwards: 70 

Subscription-State: Active;Expires=7200 

Event: Message-Summary 

Accept: application/simple-message-summary 

Route: sip:10.0.0.1:5060;lr 

Contact: <sip:10.10.0.1:5060> 

Content-Type: application/simple-message-summary 

Content-Length: 90 

Message-Waiting: yes 

Message-Account: sip:+447960306800@operatorB.com;user=phone 

Voice-Message: 4/1 (2/1) 

Video-Message: 0/0 (0/0) 

 

To: <+447960306800@operatorB.com;user=phone> 

From: <+442476452864@operatorC.com;user=phone> 

Subject: call me back! 

Date: 19 Apr 20013 21:45:31 -0700 

Priority: urgent 

Message-ID: 27775334485@operatorB.com 

Message-Context: voice-message 

 

To: <+447960306800@operatorB.com;user=phone> 

From: <+442476633123@operatorD.com;user=phone> 

Subject: Where are you that late??? 

Date: 19 Apr 2013 23:45:31 -0700 

Priority: urgent 

Message-ID: 27775334485@operatorB.com 

Message-Context: voice-message 

 

Message 4 . 200 OK (NOTIFY) 

SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.10.0.1:5060;branch=567891234a 

To: <sip: +447960306800@operatorB.com;user=phone>;tag=5678ab34 

From: <sip: +447960306800@operatorB.com;user=phone>;tag=123456 

Call-ID: abc1234567@operatorB.com 

CSeq: 12 NOTIFY 

Contact: <sip:10.0.0.1:5060> 

Content-Length: 0 

 


INVITE (SDP Offer #1) (1) (DP Offer) 

100 Trying (2) ((((2P 
Offer) 

183 Progress (SDP Answer #1) (3) 
((((((P 
Offer) 

PRACK (4) 

200 OK (PRACK) (5) 

UPDATE (SDP Offer #2) (6) ((SDP 
Offer) 

200 OK (UPDATE) (SDP Answer #2) (7) 

200 OK (INVITE) (8) 

ACK (9) 

Ad-Hoc Conference 

As stated in GSMA PRD IR.92 [5], this service is realised via the UE initiating a session with 
a conference factory and then adding further users (including those which currently have an 
active session with the initiating UE) via REFER requests to the conference factory. Assume 
that there is a session established as previously shown in appendix B.1. The originating 
party decides to initiate a conference. Separate flows are shown (see figures 12 to 14). i) to 
invoke the conference factory, ii) subscribe to the conference package and iii) to move/add 
other participants to the conference. In terms of the NNI, these actions are applicable only 
to the roaming NNI (UE in the visited network and the AS/ conference-factory in the home 
network). It should also be noted that the signalling to the other participants from the 
AS/conference-factory can cross the I-NNI. 

Operator- A Operator-B 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Figure 12 : Ad-Hoc Conference (Invoking the Conference-Factory) 


 

The above message sequence is very similar to that in appendix B.1 (essentially, the target 
is the conference factory rather than another UE and there is no 180 Ringing response). 
Therefore, for brevity, only differences from appendix B.1 are shown below. 

 


Message 1 . INVITE (SDP Offer #1) 

INVITE sip: conference-factory1@operatorB.com SIP/2.0 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=123456 

To: <sip:conference-factory1@operatorB.com> 

P-Charging-Vector: icid-value=Åhabch+23456yÅh; orig-ioi=operatorA.com; term-ioi=operatorB.com 

Call-ID: abc1234567@operatorB.com 

P-Asserted-Identity: Tel:+4479606306800 

 

Message 2 . 100 Trying 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=123456 

To: <sip:conference-factory1@operatorB.com> 

Call-ID: abc1234567@operatorB.com 

 

Message 3 . 183 Prpgress (SDP Answer #1) 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=123456 

To: <sip:conference-factory1@operatorB.com>;tag=8910123 

P-Charging-Vector: icid-value=Åhabch+23456yÅh; orig-ioi=operatorA.com; term-ioi=operatorB.com 

Call-ID: abc1234567@operatorB.com 

Contact: <sip:10.10.0.1:5060>;isfocus 

 

Message 4 . PRACK 

PRACK sip: conference-factory1@operatorB.com SIP/2.0 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=123456 

To: <sip:conference-factory1@operatorB.com>;tag=8910123 

 Call-ID: abc1234567@operatorB.com 

 

Message 5 . 200 OK (PRACK) 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=123456 

To: <sip:conference-factory1@operatorB.com>;tag=8910123 

 Call-ID: abc1234567@operatorB.com 

 

Message 6 . UPDATE (SDP Offer #2) 

UPDATE sip: conference-factory1@operatorB.com SIP/2.0 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=123456 

To: <sip:conference-factory1@operatorB.com>;tag=8910123 

Call-ID: abc1234567@operatorB.com 

 


SUBSCRIBE (1) (DP Offer) 

200 OK (SUBSCRIBE) (2) ((((2P 
Offer) 

NOTIFY (3) 
((((((P 
Offer) 

200 OK (NOTIFY) (4) 

Message 7 . 200 OK (UPDATE) (SDP Answer #2) 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=123456 

To: <sip:conference-factory1@operatorB.com>;tag=8910123 

Call-ID: abc1234567@operatorB.com 

Contact: <sip:10.10.0.1:5060>;isfocus 

 

Message 9 . 200 OK (INVITE) 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=123456 

To: <sip:conference-factory1@operatorB.com>;tag=8910123 

Call-ID: abc1234567@operatorB.com 

Contact: <sip:10.10.0.1:5060>;isfocus 

 

Message 9 . ACK 

UPDATE sip: conference-factory1@operatorB.com SIP/2.0 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=123456 

To: <sip:conference-factory1@operatorB.com>;tag=8910123 

Call-ID: abc1234567@operatorB.com 

 

There is now a session set up between the user +447960306800@operatorB.com and the 
conference factory. The user now subscribes to the conference event package as shown in 
figure 13. 

 

Operator- A Operator-B 

 

 

 

 

 

 

 

Figure 13 : Conference Package Subscription 


 

The message contents are as shown below. 

 


Message 1 . SUBSCRIBE 

SUBSCRIBE sip: conference-factory1@operatorB.com SIP/2.0 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=564321 

To: <sip:conference-factory1@operatorB.com> 

P-Charging-Vector: icid-value=Åhabch+23456yÅh; orig-ioi=operatorA.com; term-ioi=operatorB.com 

Call-ID: abc1234588@operatorB.com 

CSeq: 1 SUBSCRIBE 

P-Asserted-Identity: Tel:+447960306800 

P-Access-Network-Info:3GPP-E-UTRAN-FDD;e-utran-cell-id-3gpp=1234 

Privacy: Id 

Max-Forwards: 70 

Expires:7200 

Event: conference 

Accept: application/conference-info+xml 

Route: sip:10.10.0.1:5060;lr 

Contact: <sip:10.0.0.1:5060> 

Content-Length: 0 

 

Message 2 . 200 OK (SUBSCRIBE) 

SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=564321 

To: <sip:conference-factory1@operatorB.com>;tag=3467894a 

P-Charging-Vector: icid-value=Åhabch+23456yÅh; orig-ioi=operatorA.com; term-ioi=operatorB.com 

Call-ID: abc1234588@operatorB.com 

CSeq: 1 SUBSCRIBE 

Event:conference 

Expires: 7200 

P-Charging-Vector: icid-value=Åhabch+23456yÅh; orig-ioi=operatorA.com; term-ioi=operatorB.com 

Contact: <sip:10.10.0.1:5060> 

Content-Length: 0 

 


Message 3 . NOTIFY 

NOTIFY sip:+447960306800@operatorB.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.10.0.1:5060;branch=567891234a 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=564321 

From: <sip:conference-factory1@operatorB.com>;tag=3467894a 

Call-ID: abc1234588@operatorB.com 

CSeq: 12 NOTIFY 

Max-Forwards: 70 

Subscription-State: Active;Expires=7200 

Event: conference 

Accept: application/conference-info+xml 

Route: sip:10.0.0.1:5060;lr 

Contact: <sip:10.10.0.1:5060> 

Content-Type: application/conference-info+xml 

Content-Length: xx 

 

[Conference Info] - see RFC 4575 [43] 

 

Message 4 . 200 OK (NOTIFY) 

SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.10.0.1:5060;branch=567891234a 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=564321 

From: <sip:conference-factory1@operatorB.com>;tag=3467894a 

Call-ID: abc1234588@operatorB.com 

CSeq: 12 NOTIFY 

Contact: <sip:10.0.0.1:5060> 

Content-Length: 0 

 

The controlling party will now add/move participants to the conference. This is done via a 
REFER to the AS/Conference-Factory as shown in figure 13. There are 2 distinct cases, 
namely the moving of a party in an existing 2-way session and the adding of a new party. In 
the latter case, parties may be added piece-meal or en-bloc. Message contents are shown 
for the moving of an existing party and addition of a single new party. Note that multiple 
parties may also be added in a single step via an XML body containing a URI-List (see RFCs 
5364 [59] & 5368 [61]). 

The controlling party may be informed of the progress of the REFER request via SIP 
NOTIFY messages (there is an implicit subscription via the REFER request . see IETF RFC 
3515 [51]). However, in this case, as the UE has already subscribed to the conference event 
package, then it is assumed that the REFER contains the Refer-Sub header set to false 
which over-rides the implicit subscription. The NOTIFY messages thus carry information 
relating to the conference progress. 

 

... 


REFER (1) (DP Offer) 

202 Accepted (REFER) (2) ((((2P 
Offer) 

NOTIFY (3) 
((((((P 
Offer) 

200 OK (NOTIFY) (4) 

NOTIFY (5) 
((((((P 
Offer) 

200 OK (NOTIFY) (6) 

 

Operator- A Operator-B 

 

 

 

 

 

 

 

 

 

 

Figure 14 : Referring a User Into the Conference 


The message contents are as shown below. 

Message 1a . REFER (to an existing party) 

REFER sip: conference-factory1@operatorB.com SIP/2.0 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=564321 

To: <sip:conference-factory1@operatorB.com> 

P-Charging-Vector: icid-value=Åhabch+23456yÅh; orig-ioi=operatorA.com; term-ioi=operatorB.com 

Call-ID: 56789102@operatorB.com 

CSeq: 1 REFER 

P-Asserted-Identity: Tel:+447960306800 

P-Access-Network-Info:3GPP-E-UTRAN-FDD;e-utran-cell-id-3gpp=1234 

Privacy: Id 

Refer-Sub: false 

Accept: application/sdp, message/sipfrag 

Require: norefersub 

Max-Forwards: 70 

Refer-To:<sip: 
+397850316900@operatorA.com;user=phone;method=INVITE?Replaces=dgh123456 %40operatorA.
com%3Bto-tag%3Dade2345%3Bfrom-tag%3D5678ab34?Require=replaces> 

Referred-By: <sip:+447960306800@operatorB.com;user=phone> 

Route: sip:10.10.0.1:5060;lr 

Contact: <sip:10.0.0.1:5060> 

Content-Length: 0 

The above message causes the conference factory to initiate a session to the cited (Refer-To) target 
which will contain the following headers (copied/derived from the REFER message). 

Require: replaces 

Referred-By: <sip:+447960306800@operatorB.com;user=phone> 


Replaces: dgh1234565@operatorA.com;to-tag=ade2345;from-tag=5678ab34 

Contact: <conference-factory1@operatorB.com>;isfocus 

The target will accept this session and redirect the existing media endpoint to the conference factory, 
prior to sending a BYE to terminate the previous 2-way session. 

 


Message 1b . REFER (to a new single party) 

REFER sip: conference-factory1@operatorB.com SIP/2.0 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=564321 

To: <sip:conference-factory1@operatorB.com> 

P-Charging-Vector: icid-value=Åhabch+23456yÅh; orig-ioi=operatorA.com; term-ioi=operatorB.com 

Call-ID: 56789102@operatorB.com 

CSeq: 1 REFER 

P-Asserted-Identity: Tel:+447960306800 

P-Access-Network-Info:3GPP-E-UTRAN-FDD;e-utran-cell-id-3gpp=1234 

Privacy: Id 

Max-Forwards: 70 

Refer-To:<sip: +497789123456@operatorC.com;user=phone;method=INVITE> 

Referred-By: sip:+447960306800@operatorB.com;user=phone 

Refer-Sub: false 

Accept: application/sdp, message/sipfrag 

Require: norefersub 

Route: sip:10.10.0.1:5060;lr 

Contact: <sip:10.0.0.1:5060> 

Content-Length: 0 

The above message causes the conference factory to initiate a session to the cited (Refer-To) target 
which will add that party to the conference. The CONTACT header will contain the ÅgisfocusÅh 
parameter (RFC 3840 [52]). 

 

Message 2 . 202 ACCEPTED 

SIP/2.0 202 Accepted 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=564321 

To: <sip:conference-factory1@operatorB.com>;tag=7824567 

P-Charging-Vector: icid-value=Åhabch+23456yÅh; orig-ioi=operatorA.com; term-ioi=operatorB.com 

Call-ID: 56789102@operatorB.com 

CSeq: 1 REFER 

Refer-Sub: false 

Contact: <sip:10.10.0.1:5060> 

Content-Length: 0 

 


Message 3 . NOTIFY 

NOTIFY sip:+447960306800@operatorB.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.10.0.1:5060;branch=567891234a 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=564321 

From: <sip:conference-factory1@operatorB.com>;tag=7824567 

Call-ID: 56789102@operatorB.com 

CSeq: 13 NOTIFY 

Max-Forwards: 70 

Subscription-State: Active;Expires=7200 

Event: conference 

Accept: application/conference-info+xml 

Route: sip:10.0.0.1:5060;lr 

Contact: <sip:10.10.0.1:5060> 

Content-Type: application/conference-info+xml 

Content-Length: xx 

 

[Conference Info] - see RFC 4575 [43] 

 

Message 4 . 200 OK (NOTIFY) 

SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.10.0.1:5060;branch=567891234a 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=564321 

From: <sip:conference-factory1@operatorB.com>;tag=7824567 

Call-ID: 56789102@operatorB.com 

CSeq: 13 NOTIFY 

Contact: <sip:10.0.0.1:5060> 

Content-Length: 0 

 

Messages 5 & 6 . As for 3 & 4 (with modified CSeq and updated XML body) 

 

Note that if the implicit subscription to the progress of the REFER was not inhibited, then additional 
notifications would also be sent. For completeness, examples are shown below:- 

 


NOTIFY sip:+447960306800@operatorB.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.10.0.1:5060;branch=567891234a 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=564321 

From: <sip:conference-factory1@operatorB.com>;tag=7824567 

Call-ID: 56789102@operatorB.com 

CSeq: 13 NOTIFY 

Max-Forwards: 70 

Subscription-State: Active;Expires=7200 

Event: refer 

Route: sip:10.0.0.1:5060;lr 

Contact: <sip:10.10.0.1:5060> 

Content-Type: message/sip-frag;version=2.0 

Content-Length: 20 

SIP/2.0 100 Trying 

 

SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.10.0.1:5060;branch=567891234a 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=564321 

From: <sip:conference-factory1@operatorB.com>;tag=7824567 

Call-ID: 56789102@operatorB.com 

CSeq: 13 NOTIFY 

Contact: <sip:10.0.0.1:5060> 

Content-Length: 0 

 

NOTIFY sip:+447960306800@operatorB.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.10.0.1:5060;branch=567891234a 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=564321 

From: <sip:conference-factory1@operatorB.com>;tag=7824567 

Call-ID: 56789102@operatorB.com 

CSeq: 14 NOTIFY 

Max-Forwards: 70 

Subscription-State: terminated;reason=noresource 

Event: refer 

Route: sip:10.0.0.1:5060;lr 

Contact: <sip:10.10.0.1:5060> 

Content-Type: message/sip-frag;version=2.0 

Content-Length: 16 

SIP/2.0 200 OK 

 


SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.10.0.1:5060;branch=567891234a 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=564321 

From: <sip:conference-factory1@operatorB.com>;tag=7824567 

Call-ID: 56789102@operatorB.com 

CSeq: 14 NOTIFY 

Contact: <sip:10.0.0.1:5060> 

Content-Length: 0 

 


OPTIONS (1) (DP Offer) 

200 OK (OPTIONS) (2) 

Appendix B.7 . RCS Capability Exchange 

Figure 15 illustrates a RCS Capability Exchange via SIP OPTIONS. This interchange may 
be done as a stand-alone transaction or else as part of an active SIP session (e.g. a voice 
call). The example below is assumed to be a stand-alone transaction. 

. 

Operator- A Operator-B 

 

 

 

 

Figure 15 : RCS Capability Exchange 


 


Message 1 . OPTIONS (SDP Offer #1) 

OPTIONS sip:+447960306800@operatorB.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

To: <sip:+447960306800@operatorB.com;user=phone> 

CSeq: 11 OPTIONS 

Call-ID: dgh1234567@operatorA.com 

P-Asserted-Identity: Tel:+397850316900 

P-Access-Network-Info:3GPP-E-UTRAN-FDD;e-utran-cell-id-3gpp=1234 

Privacy: Id 

Accept: application/sdp, multipart/mixed, multipart/related, message/external-body, message/cpim, 
message/imdn+xml, application/pidf+xml, application/pidf-diff+xml, application/watcherinfo+xml, 

application/xcap-diff+xml,application/vnd.oma.suppnot+xml, application/simple-filter+xm, 
application/resource-lists+xml, application/rlmi+xml, application/im-iscomposing+xml, 
application/vnd.3gpp.sms 

Max-Forwards:70 

P-Asserted-Service: urn:urn-7:3gpp-service.ims.icsi.mmtel;video, urn-7:3gpp-
service.ims.icsi.oma.cpm.msg, urn:urn-7:3gpp-service.ims.icsi.oma.cpm.largemsg 

Accept-Contact: +g.3gpp.icsi - ref="urn%3Aurn-7%3gpp-service.ims.icsi.mmtel;video, urn%3Aurn-
7%3A3gpp-service.ims.icsi.oma.cpm.msg; urn%3Aurn-7%3A3gpp-
service.ims.icsi.oma.cpm.largemsg; urn%3Aurn-7%3A3gpp-service.ims.icsi.oma.cpm.sessionÅh; 
+g.3gpp.iari-ref="urn%3Aurn-7%3A3gpp-application.ims.iari.rcse.im, urn%3Aurn-7%3A3gpp-
application.ims.iari.rcse.ft, urn%3Aurn-7%3A3gpp-application.ims.iari.rcs.ftthumb, urn%3Aurn-
7%3A3gpp-application.ims.iari.gsma-is, urn:urn-7:3gpp-application.ims.iari.gsma-vs, urn%3Aurn-
7%3A3gpp-application.ims.iari.rcs.geopullft, urn%3Aurn-7%3A3gpp-application.ims.iari.rcs.geopush", 
+g.3gpp.smsip 

Route: sip:10.10.0.1:5060;lr 

Contact: <sip:10.0.0.1:5060>; +g.3gpp.icsi - ref="urn%3Aurn-7%3gpp-service.ims.icsi.mmtel;video, 
urn%3Aurn-7%3A3gpp-service.ims.icsi.oma.cpm.msg; urn%3Aurn-7%3A3gpp-
service.ims.icsi.oma.cpm.largemsg; urn%3Aurn-7%3A3gpp-service.ims.icsi.oma.cpm.filetransfer; 
urn%3Aurn-7%3A3gpp-service.ims.icsi.oma.cpm.sessionÅh; +g.3gpp.iari-ref="urn%3Aurn-7%3A3gpp-
application.ims.iari.rcse.im, urn%3Aurn-7%3A3gpp-application.ims.iari.rcse.ft, urn%3Aurn-
7%3A3gpp-application.ims.iari.rcs.ftthumb, urn%3Aurn-7%3A3gpp-application.ims.iari.gsma-is, 
urn:urn-7:3gpp-application.ims.iari.gsma-vs, urn%3Aurn-7%3A3gpp-application.ims.iari.rcs.geopullft, 
urn%3Aurn-7%3A3gpp-application.ims.iari.rcs.geopush, urn%3Aurn-7%3A3gpp-
application.ims.iari.rcse.sp ",+g.3gpp.smsip 

Content-Length: 0 

 


Message 2 . 200 OK (OPTIONS) 

SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=ade2345 

CSeq: 11 OPTIONS 

Call-ID: dgh1234567@operatorA.com 

P-Asserted-Identity: Tel:+447960306800 

Privacy: none 

P-Access-Network-Info:3GPP-E-UTRAN-FDD;e-utran-cell-id-3gpp=5678910 

P-Asserted-Service: urn:urn-7:3gpp-service.ims.icsi.mmtel, urn-7:3gpp-service.ims.icsi.oma.cpm.msg, 
urn:urn-7:3gpp-service.ims.icsi.oma.cpm.largemsg 

 

Accept: application/sdp, multipart/mixed, multipart/related, message/external-body, message/cpim, 
message/imdn+xml, application/im-iscomposing+xml, application/vnd.3gpp.sms 

Accept-Contact: +g.3gpp.icsi - ref="urn%3Aurn-7%3gpp-service.ims.icsi.mmtel, urn%3Aurn-
7%3A3gpp-service.ims.icsi.oma.cpm.msg; urn%3Aurn-7%3A3gpp-
service.ims.icsi.oma.cpm.largemsgÅh; +g.3gpp.iari-ref="urn%3Aurn-7%3A3gpp-
application.ims.iari.rcse.im, urn%3Aurn-7%3A3gpp-application.ims.iari.rcse.ft, urn%3Aurn-
7%3A3gpp-application.ims.iari.rcs.ftthumb, urn%3Aurn-7%3A3gpp-application.ims.iari.gsma-is, 
urn:urn-7:3gpp-application.ims.iari.gsma-vs",+g.3gpp.smsip 

Contact: <sip:10.10.0.1:5060>; +g.3gpp.icsi - ref="urn%3Aurn-7%3gpp-service.ims.icsi.mmtel, 
urn%3Aurn-7%3A3gpp-service.ims.icsi.oma.cpm.msg; urn%3Aurn-7%3A3gpp-
service.ims.icsi.oma.cpm.largemsgÅh; +g.3gpp.iari-ref="urn%3Aurn-7%3A3gpp-
application.ims.iari.rcse.im, urn%3Aurn-7%3A3gpp-application.ims.iari.rcse.ft, urn%3Aurn-
7%3A3gpp-application.ims.iari.rcs.ftthumb, urn%3Aurn-7%3A3gpp-application.ims.iari.gsma-is, 
urn:urn-7:3gpp-application.ims.iari.gsma-vs", +g.3gpp.smsip 

Content-Length: 0 

 

The above exchange indicates that:- 

. The sending party supports the following:- 
o Multimedia Telephony, CPM Standalone Messaging (Pager & Large Message 
mode), CPM Session, IM, FT, FT Thumbnail, Image Share, Video Share, 
Geo-location Push, Geo-Location Pull-FT, Social Presence and SMS. 


. The receiving party supports the following offered features :- 
o Voice Telephony, CPM Standalone Messaging (Pager & Large Message 
mode), IM, FT, FT Thumbnail, Image Share, Video Share and SMS. 




Subsequent sessions may be established for the common set of supported services 
between the two users. 

RCS sessions may be run standalone or in parallel with MMTel sessions. In the latter case, 
the RCS sessions may involve common endpoints (Ågin call servicesÅh) or different endpoints 
(Ågmulti-taskingÅh). In all cases, separate SIP sessions are set up to enable the RCS services. 

 


MESSAGE (1) (DP Offer) 

200 OK (MESSAGE) (2) 

Appendix B.8 . RCS CPM Messaging (Pager Mode) 

It is assumed that a Capability Exchange has occurred. The message flow for the RCS CPM 
Pager Mode Messaging is shown in figure 16. Pager mode is recommended to be used if the 
message size is <1300 bytes. 

 

Operator- A Operator-B 

 

 

 

 

Figure 16 : RCS Messaging (Pager Mode) 


 

The message contents are shown below:- 

 


Message 1 . MESSAGE 

INVITE sip:+447960306800@operatorB.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

To: <sip:+447960306800@operatorB.com;user=phone> 

CSeq: 23 MESSAGE 

Call-ID: dgh1234567@operatorA.com 

P-Asserted-Identity: Tel:+397850316900 

Privacy: Id 

Max-Forwards: 70 

Conversation-ID: 1234-5678-9abcd 

Contribution-ID: 0012-3456-123 

P-Early-Media: supported 

P-Asserted-Service: urn:urn-7:3gpp-service.ims.icsi.oma.cpm.msg 

Accept-Contact: +g.3gpp.icsi-ref=Åhurn%3Aurn-7%3A3gpp-service.ims.icsi.oma.cpm.messageÅh 

Route: sip:10.10.0.1:5060;lr 

Contact: <sip:10.0.0.1:5060>;+g.3gpp.icsi . ref ="urn%3Aurn-7%3gpp-
service.ims.icsi.oma.com.message" 

Content-Type: message/CPIM 

Content-Length: 338 

 

 From: Fred <sip+397850316900@operatorA.com;user=phone> 

To: Bob <sip:+447960306800@operatorB.com;user=phone> 

DateTime: 2000-12-13T13:40:00-08:00 

Subject: What are you doing tonight? 

 

Content-Type:text/xml; charset=utf8 

Content-ID:<1234567789> 

 <body> 

 Fancy going to the pub tonight? I think there may be a quiz on. 

 </body> 

Message 2 . 200 OK (MESSAGE) 

SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=ade2345 

CSeq: 23 MESSAGE 

Call-ID: dgh1234567@operatorA.com 

P-Asserted-Identity: Tel:+447960306800 

Privacy: none 

Content-Length: 0 

 


INVITE (SDP Offer) (1) (DP Offer) 

100 Trying (2) ((((2P 
Offer) 

200 OK (INVITE) (SDP Answer) (3) 
((((((P 
Offer) 

ACK (4) 

MSRP Send (5) ((SDP 
Offer) 

MSRP 200 OK (6) 

BYE (7) 

200 OK (BYE) (8) 

Appendix B.9 . RCS CPM Messaging (Large Message Mode) 

It is assumed that a Capability Exchange has occurred. The message flow and numbering 
for the RCS CPM Messaging for Large Message Mode is shown in figure 17. A SIP session 
is set up with the SDP Offer/Answer enabling a TCP connection to be established to carry 
MSRP. 

. 

Operator- A Operator-B 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Figure 17 : CPM Message (Large Message Mode) 


 

The message contents are shown below:- 

 


Message 1 . INVITE (SDP Offer) 

INVITE sip:+447960306800@operatorB.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

To: <sip:+447960306800@operatorB.com;user=phone> 

CSeq: 1 INVITE 

Call-ID: dgh1234567@operatorA.com 

Allow: INVITE,PRACK,ACK, CANCEL, UPDATE, PUBLISH, OPTIONS, MESSAGE, BYE, REFER, 
SUBSCRIBE, NOTITY 

P-Asserted-Identity: Tel:+397850316900 

P-Access-Network-Info:3GPP-E-UTRAN-FDD;e-utran-cell-id-3gpp=1234 

Privacy: Id 

Max-Forwards:70 

P-Early-Media: supported 

Conversation-ID: 1234-5678-9abcd 

Contribution-ID: 0012-3456-123 

Supported: 100rel, timer, precondition, histinfo, from-change 

Session-Expires: 180;refresher=uac 

Min-SE:90 

P-Asserted-Service: urn:urn-7:3gpp-service.ims.icsi.oma.cpm.largemsg 

Accept-Contact: +g.3gpp.icsi-ref=Åhurn%3Aurn-7%3A3gpp-service.ims.icsi.oma.cpm.largemsgÅh 

Route: sip:10.10.0.1:5060;lr 

Contact: <sip:10.0.0.1:5060>;+g.3gpp.icsi - ref="urn%3Aurn-7%3gpp-
service.ims.icsi.oma.cpm.largemsg" 

Content-Type: application/sdp 

Content-Length: 244 

v=0 

s=- 

o=- 0 0 IN IP4 10.0.1.1 

t=0 0 

c=IN IP4 10.0.1.1 

m=message 4000 TCP/MSRP * 

a=accept-types:message/cpim 

a=accept-wrapped-types: * 

a=path:msrp://10.0.1.1:4000/jshA7weztas;tcp 

a=sendonly 

a=file-selector:size:1500 

a=setup:active 

 


Message 2 . 100 Trying 

SIP/2.0 100 Trying 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

To: <sip:+447960306800@operatorB.com;user=phone> 

CSeq: 1 INVITE 

Call-ID: dgh1234567@operatorA.com 

Content-Length: 0 

 


Message 3 . 200 OK (INVITE) (SDP Answer) 

SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=ade2345 

CSeq: 1 INVITE 

Call-ID: dgh1234567@operatorA.com 

Allow: INVITE,PRACK,ACK, CANCEL, UPDATE, PUBLISH, OPTIONS, MESSAGE, BYE, REFER, 
SUBSCRIBE, NOTIFY 

P-Asserted-Identity: Tel:+447960306800 

Privacy: none 

P-Access-Network-Info:3GPP-E-UTRAN-FDD;e-utran-cell-id-3gpp=5678910 

Supported: 100rel, timer, precondition, histinfo, from-change 

Session-Expires: 150;refresher=uac 

Require:timer 

P-Asserted-Service: urn:urn-7:3gpp-service.ims.icsi.oma.cpm.largemsg 

Accept-Contact: +g.3gpp.icsi-ref=Åhurn%3Aurn-7%3A3gpp-service.ims.icsi.oma.cpm.largemsgÅh 

Contact: <sip:10.10.0.1:5060>;+g.3gpp.icsi - ref="urn%3Aurn-7%3gpp-
service.ims.icsi.oma.cpm.largemsg" 

Content-Type: application/sdp 

Content-Length: 244 

v=0 

s=- 

o=- 0 0 IN IP4 10.10.1.1 

t=0 0 

c=IN IP4 10.10.1.1 

m=message 6000 TCP/MSRP * 

a=accept-types:message/cpim 

a=accept-wrapped-types: * 

a=path:msrp://10.10.1.1:6000/abcA7wept654;tcp 

a=recvonly 

a=setup:passive 

 


Message 4 . ACK 

ACK sip:+447960306800@operatorB.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=ade2345 

CSeq: 2 ACK 

Call-ID: dgh1234567@operatorA.com 

Max-Forwards:70 

Route: sip:10.0.1.1:5060;lr 

Contact: <sip:10.0.0.1:5060> 

Content-Length:0 

 

Having exchanged the SDP, a TCP connection is created over which the MSRP messages 
will run (see IETF RFC 4975 [58]). 

 

.Message 5 . MSRP SEND 

MSRP d93kswow SEND 

To-Path: msrp://10.10.1.1:6000/abcA7wept654;tcp 

From-Path: msrp://10.0.1.1:4000/jshA7weztas;tcp 

Message-ID: 12339sdqwer 

Byte-Range: 1-1766 /*byte range includes the CPIM message contents*/ 

Content-Type: message/cpim 

 

From: Fred <sip+397850316900@operatorA.com;user=phone> 

To: Bob <sip:+447960306800@operatorB.com;user=phone> 

DateTime: 2000-12-13T13:40:00-08:00 

Subject: What are you doing tonight? 

 

Content-Type:text/xml; charset=utf8 

Content-ID:<1234567789> 

 <body> 

The message goes in here. Blah blah blah ÅcÅcÅcblah. 

 </body> 

 -------d93kswow+ 

 

Message 6 . MSRP 200 OK 

MSRP d93kswow 200 OK 

To-Path: msrp://10.0.1.1:4000/jshA7weztas;tcp 

From-Path: msrp://10.10.1.1:6000/abcA7wept654;tcp 

-------d93kswow+ 

 


Message 7 . BYE 

BYE sip:+447960306800@operatorB.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=ade2345 

CSeq: 3 BYE 

Call-ID: dgh1234567@operatorA.com 

Max-Forwards:70 

Route: sip:10.10.0.1:5060;lr 

Contact: <sip:10.0.0.1:5060> 

Content-Length:0 

 

Message 8 . 200 OK (BYE) 

SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+397850316900@operatorA.com;user=phone>;tag=5678ab34 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=ade2345 

CSeq: 3 BYE 

Call-ID: dgh1234567@operatorA.com 

Content-Length: 0 

 


Appendix B.10 . RCS Image Share (IS) 

It is assumed that a Capability Exchange has occurred. The message flow and numbering 
for the RCS Image Share (IS) is identical to that of appendix B.9. The main difference is in 
the feature tags that are exchanged and the contents of the SDP exchange and MSRP flow. 
These differences will be highlighted in this sub-appendix with references made to 
messages in appendix B.9. 

 

Message 1 . INVITE (SDP Offer) 

ÅcÅcÅcÅc 

P-Asserted-Service: urn:urn-7:3gpp-service.ims.icsi.mmtel 

Accept-Contact: +g.3gpp.iari-ref=Åhurn:urn-7:3gpp-application.ims.iari.gsma-is" 

Contact: <sip:10.0.0.1:5060>; +g.3gpp.iari-ref=Åhurn:urn-7:3gpp-application.ims.iari.gsma-is" 

Route: sip:10.10.0.1:5060;lr 

Content-Type: application/sdp 

Content-Length: 316 

v=0 

s=- 

o=- 0 0 IN IP4 10.0.1.1 

t=0 0 

c=IN IP4 10.0.1.1 

m=message 4000 TCP/MSRP * 

a=accept-types: * 

a=path:msrp://10.0.1.1:4000/jshA7weztas;tcp 

a=sendonly 

a=setup:active 

a=file-selector:name:"My cool picture.jpg" type:image/jpeg size:32349 

a=file-transfer-id:vBnG916bdberum2fF 

a=file-disposition:render 

 


Message 2 . 100 Trying 

As appendix B.9. 

 

Message 3 . 200 OK (INVITE) (SDP Answer) 

ÅcÅcÅc.. 

P-Asserted-Service: urn:urn-7:3gpp-service.ims.icsi.mmtel 

Accept-Contact: +g.3gpp.iari-ref=Åhurn:urn-7:3gpp-application.ims.iari.gsma-is" 

Contact: <sip:10.10.0.1:5060>;+g.3gpp.iari-ref=Åhurn:urn-7:3gpp-application.ims.iari.gsma-is" Content-
Type: application/sdp 

Content-Length: 244 

v=0 

s=- 

o=- 0 0 IN IP4 10.10.1.1 

t=0 0 

c=IN IP4 10.10.1.1 

m=message 6000 TCP/MSRP * 

a=accept-types:* 

a=path:msrp://10.10.1.1:6000/abcA7wept654;tcp 

a=recvonly 

a=setup:passive 

a=file-selector:name:"My cool picture.jpg" type:image/jpeg size:32349 

a=file-transfer-id:vBnG916bdberum2fF 

a=file-disposition:render 

 

Message 4 . ACK 

As appendix B.9. 

 

Having exchanged the SDP, a TCP connection is created over which the MSRP messages 
will run (see IETF RFC 4975 [58]) 

.Message 5 . MSRP SEND 

MSRP d93kswow SEND 

To-Path: msrp://10.10.1.1:6000/abcA7wept654;tcp 

From-Path: msrp://10.0.1.1:4000/jshA7weztas;tcp 

Message-ID: 12339sdqwer 

Byte-Range: 1-2048/32349 

Content-Type: image/jpeg 

(jpeg contents) 

 -------d93kswow+ 

 


Message 6 . MSRP 200 OK 

MSRP d93kswow 200 OK 

To-Path: msrp://10.0.1.1:4000/jshA7weztas;tcp 

From-Path: msrp://10.10.1.1:6000/abcA7wept654;tcp 

-------d93kswow+ 

In this case, there will be multiple MSRP chunks (assumed 16 . each with the same Message-ID) 
until the complete image is transferred. 

 

Message 7 . BYE 

As appendix B.9. 

 

Message 8 . 200 OK (BYE) 

As appendix B.9. 

 


Appendix B.11 . RCS Video Share (VS) 

It is assumed that a Capability Exchange has occurred. In this example, it is assumed that 
the users do not support multi-media telephony but do support RCS VS (note that if the 
users both supported multi-media telephony, then an MMTel uni-directional session would 
have been established). 

The message flow and numbering is identical to that of appendix B.2. The main difference is 
in the SDP exchange where a video codec is negotiated together with a uni-directional 
media path. In addition, the will reflect that video telephony is also possible. These 
differences will be highlighted in this sub-appendix with references made to messages in 
appendix B.2. 

 

Message 1 . INVITE (SDP Offer #1) 

As appendix B.2 with modified P-Asserted-Service, Contact & Accept-Contact headers plus a single 
media line (for video) in the SDP message body. 

ÅcÅcÅcÅc 

P-Asserted-Service: urn:urn-7:3gpp-service.ims.icsi.mmtel 

Accept-Contact: +g.3gpp.iari-ref=Åhurn:urn-7:3gpp-application.ims.iari.gsma-vs" 

Contact: <sip:10.0.0.1:5060>; +g.3gpp.iari-ref=Åhurn:urn-7:3gpp-application.ims.iari.gsma-vs" 

Content-Type: application/sdp 

Content-Length: 473 

v=0 

s=- 

o=- 0 0 IN IP4 10.0.1.1 

t=0 0 

c=IN IP4 10.0.1.1 

m=video 4000 RTP/AVP 101 102 

a=inactive 

a=rtpmap: 101 H264/90000 

a=fmtp: 101 profile-level-id=42C016; packetization-mode=1;sprop-parameter-sets=Z0LAFukDwKMg,aM4G4g== octet-align=1 

a=rtpmap: 102 H263-2000/90000 

a=fmtp 102 profile=0;level=10;QCIF=2 

a=curr qos local none 

a=des qos mandatory local sendrecv 

a=curr qos remote none 

a=des qos optional remote sendrecv 

a=conf qos remote sendrecv 

b=AS: 768 

 


Message 2 . 100 Trying 

As appendix B.2. 

 

Message 3 . 183 Prpgress (SDP Answer #1) 

As appendix B.2 with modified headers as in the INVITE plus video SDP in the message body. 

ÅcÅcÅcÅc 

P-Asserted-Service: urn:urn-7:3gpp-service.ims.icsi.mmtel 

Accept-Contact: : +g.3gpp.iari-ref=Åhurn:urn-7:3gpp-application.ims.iari.gsma-vs" 

Contact: <sip:10.10.0.1:5060>; +g.3gpp.iari-ref=Åhurn:urn-7:3gpp-application.ims.iari.gsma-vs" 

Content-Type: application/sdp 

Content-Length: 403 

v=0 

s=- 

o=- 0 0 IN IP4 10.10.1.1 

t=0 0 

c=IN IP4 10.10.1.1 

m=video 6000 RTP/AVP 101 

a=inactive 

a=rtpmap: 101 H264/90000 

a=fmtp: 101 profile-level-id=42C016; packetization-mode=1;sprop-parameter-sets=Z0LAFukDwKMg,aM4G4g== octet-align=1 

a=curr qos local none 

a=des qos mandatory local sendrecv 

a=curr qos remote none 

a=des qos optional remote sendrecv 

a=conf qos remote sendrecv 

b=AS: 768 

 


Message 4 . PRACK 

As appendix B.2. 

 

Message 5 . 200 OK (PRACK) 

As appendix B.2. 

 

Message 6 . UPDATE (SDP Offer #2) 

As appendix B.2 with only video media SDP in the message body and the media being uni-directional. 

ÅcÅcÅcÅcÅc. 

Content-Type: application/sdp 

Content-Length: 405 

v=0 

s=- 

o=- 0 0 IN IP4 10.0.1.1 

t=0 0 

c=IN IP4 10.0.1.1 

m=video 4000 RTP/AVP 101 

a=sendonly 

a=rtpmap: 101 H264/90000 

a=fmtp: 101 profile-level-id=42C016; packetization-mode=1;sprop-parameter-sets=Z0LAFukDwKMg,aM4G4g== octet-align=1 

a=curr qos local sendrecv 

a=des qos mandatory local sendrecv 

a=curr qos remote none 

a=des qos optional remote sendrecv 

a=conf qos remote sendrecv 

b=AS: 768 

 


Message 7 . 200 OK (UPDATE) (SDP Answer #2) 

As appendix B.2 with only single media video SDP in the message body. Also, the SDP answer 
reflects the unidirectional media flow. 

ÅcÅcÅcÅc. 

Content-Type: application/sdp 

Content-Length: 382 

v=0 

s=- 

o=- 0 0 IN IP4 10.10.1.1 

t=0 0 

c=IN IP4 10.10.1.1 

m=video 6000 RTP/AVP 101 

a=recvonly 

a=rtpmap: 101 H264/90000 

a=fmtp: 101 profile-level-id=42C016; packetization-mode=1;sprop-parameter-sets=Z0LAFukDwKMg,aM4G4g== octet-align=1 

a=curr qos local sendrecv 

a=des qos mandatory local sendrecv 

a=curr qos remote sendrecv 

a=des qos optional remote sendrecv 

b=AS: 768 

 

Message 8 . 180 Ringing 

As appendix B.2. with modified P-Asserted-Service, Contact & Accept-Contact headers. 

ÅcÅc.. 

P-Asserted-Service: urn:urn-7:3gpp-service.ims.icsi.mmtel 

Accept-Contact: +g.3gpp.iari-ref=Åhurn:urn-7:3gpp-application.ims.iari.gsma-vs" 

Contact: <sip:10.10.0.1:5060>; +g.3gpp.iari-ref=Åhurn:urn-7:3gpp-application.ims.iari.gsma-vs" 

 

Message 9 . 200 OK (INVITE) 

As appendix B.2. with modified P-Asserted-Service, Contact & Accept-Contact headers. 

ÅcÅc.. 

P-Asserted-Service: urn:urn-7:3gpp-service.ims.icsi.mmtel 

Accept-Contact: +g.3gpp.iari-ref=Åhurn:urn-7:3gpp-application.ims.iari.gsma-vs" 

Contact: <sip:10.10.0.1:5060>; +g.3gpp.iari-ref=Åhurn:urn-7:3gpp-application.ims.iari.gsma-vs" 

 


Message 10 . ACK 

As appendix B.2. 

 

Message 11 . BYE 

As appendix B.2. 

 

Message 12 . 200 OK (BYE) 

As appendix B.2. 

 


Appendix B.12 . RCS FT (CPM Based) 

It is assumed that a Capability Exchange has occurred. The tags Ågurn:urn-7:3gpp-
application.ims.iari.rcse.ftÅh and urn:urn-7:3gpp-application.ims.iari.rcs.ftthumbÅh indicate that 
either CPM or SIMPLE based FT is supported. This appendix covers the CPM case. This 
example also shows a thumbnail being transferred ahead of the FT itself and the use of the 
multipart/related message body. The message flow and numbering for the RCS CPM based 
FT is identical to appendix B.9. The main difference is in the feature tags that are 
exchanged and the contents of the SDP exchange and MSRP flow. These differences will be 
highlighted in this sub-appendix with references made to messages in appendix B.9. 

The message contents are shown below:- 

 

Message 1 . INVITE (SDP Offer) 

ÅcÅcÅc 

P-Asserted-Service: urn:urn-7:3gpp-service.ims.icsi.oma.cpm.filetransfer 

Accept-Contact: +g.3gpp.icsi-ref=Åhurn%3Aurn-7%3A3gpp-service.ims.icsi.oma.cpm.filetransferÅh 

Contact: <sip:10.0.0.1:5060>;+g.3gpp.icsi - ref="urn%3Aurn-7%3gpp-
service.ims.icsi.oma.cpm.filetransfer" 

Content-Type: multipart/related; type=Åhapplication/sdpÅh;boundary=boundary123 

Content-Length: 792 

--boundary123 

Content-Type: application/sdp 

Content-Length: 374 

v=0 

s=- 

o=- 0 0 IN IP4 10.0.1.1 

t=0 0 

c=IN IP4 10.0.1.1 

m=message 4000 TCP/MSRP * 

a=accept-types:message/cpim 

a=accept-wrapped-types: * 

a=path:msrp://10.0.1.1:4000/jshA7weztas;tcp 

a=sendonly 

a=setup:active 

a=file-selector:name:"sunrise.jpg" type:image/jpeg size:60000 

a=file-transfer-id:vBnG916bdberum2fF 

a=file-disposition:render 

a:file-icon:cid:icon12345 

--boundary123 

Content-Type: image/jpeg 

Content-Transfer-Encoding: binary 

Content-ID: <icon1234> 

Content-Length: 200 

 Content-Disposition: icon 

 [..small preview icon...] 

 --boundary123-- 


 

Message 2 . 100 Trying 

As appendix B.9 

 

Message 3 . 200 OK (INVITE) (SDP Answer) 

ÅcÅc.. 

P-Asserted-Service: urn:urn-7:3gpp-service.ims.icsi.oma.cpm.filetransfer 

Accept-Contact: +g.3gpp.icsi-ref=Åhurn%3Aurn-7%3A3gpp-service.ims.icsi.oma.cpm.filetransferÅh 

Contact: <sip:10.10.0.1:5060>;+g.3gpp.icsi - ref="urn%3Aurn-7%3gpp-
service.ims.icsi.oma.cpm.filetransfer" 

Content-Type: application/sdp 

Content-Length: 322 

v=0 

s=- 

o=- 0 0 IN IP4 10.10.1.1 

t=0 0 

c=IN IP4 10.10.1.1 

m=message 6000 TCP/MSRP * 

a=accept-types:message/cpim 

a=accept-wrapped-types: * 

a=path:msrp://10.10.1.1:6000/abcA7wept654;tcp 

a=recvonly 

a=setup:passive 

a=file-selector:name:"sunrise.jpg" type:image/jpeg size:60000 

a=file-transfer-id:vBnG916bdberum2fF 

 

Message 4 . ACK 

As appendix B.9 

 

Having exchanged the SDP, a TCP connection is created over which the MSRP messages 
will run (see IETF RFC 4975 [58]). Note that it is assumed that the maximum chunk size is 
500K bytes (as recommended in IR.90 [5]). In this case, multiple MSRP messages are 
exchanged until the file transfer is complete. The CPIM header shall appear only in the first 
chunk that is sent. 

 


Message 5 . MSRP SEND 

MSRP d93kswow SEND 

To-Path: msrp://10.10.1.1:6000/abcA7wept654;tcp 

From-Path: msrp://10.0.1.1:4000/jshA7weztas;tcp 

Message-ID: 12339sdqwer 

Byte-Range: 1-50000/60220 

Content-Type: message/cpim 

 

From: Fred <sip+397850316900@operatorA.com;user=phone> 

To: Bob <sip:+447960306800@operatorB.com;user=phone> 

DateTime: 2000-12-13T13:40:00-08:00 

Subject: Sunrise Picture 

 

Content-Type: image/jpeg 

Content-ID: <12345> 

(jpeg contents . first block) 

 -------d93kswow+ 

 

Message 6 . MSRP 200 OK 

MSRP d93kswow 200 OK 

To-Path: msrp://10.0.1.1:4000/jshA7weztas;tcp 

From-Path: msrp://10.10.1.1:6000/abcA7wept654;tcp 

-------d93kswow+ 

 

One more chunks would now be sent with the same MSRP Message-ID and including the rest of the 
JPEG file (and no CPIM headers). However, the MSRP Content-Type would still be set to 
message/cpim. 

 

Message 7 . BYE 

As appendix B.9. 

 

Message 8 . 200 OK (BYE) 

As appendix B.9. 

 


Appendix B.13 . RCS FT (SIMPLE Based) 

It is assumed that a Capability Exchange has occurred. The tags Ågurn:urn-7:3gpp-
application.ims.iari.rcse.ftÅh and urn:urn-7:3gpp-application.ims.iari.rcs.ftthumbÅh indicate that 
either CPM or SIMPLE based FT is supported. This appendix covers the SIMPLE case. This 
example also shows a thumbnail being transferred ahead of the FT itself and the use of the 
multipart/related message body. The message flow and numbering for the RCS SIMPLE 
based FT is identical to appendix B.9. The main difference is in the feature tags that are 
exchanged and the contents of the SDP exchange and MSRP flow. These differences will be 
highlighted in this sub-appendix with references made to messages in appendix B.9. 

The message contents are shown below:- 

 


Message 1 . INVITE (SDP Offer) 

The following headers are absent:- Contribution-ID, Conversation-ID & P-Asserted-Service. 

ÅcÅcÅc 

Accept-Contact: +g.oma.sip-im 

Contact: <sip:10.0.0.1:5060>;+g.oma.sip-im 

Content-Type: multipart/related; type=Åhapplication/sdpÅh;boundary=boundary123 

Content-Length: 766 

--boundary123 

Content-Type: application/sdp 

Content-Length: 343 

v=0 

s=- 

o=- 0 0 IN IP4 10.0.1.1 

t=0 0 

c=IN IP4 10.0.1.1 

m=message 4000 TCP/MSRP * 

a=accept-types:image/jpeg 

a=path:msrp://10.0.1.1:4000/jshA7weztas;tcp 

a=sendonly 

a=setup:active 

a=file-selector:name:"sunrise.jpg" type:image/jpeg size:60000 

a=file-transfer-id:vBnG916bdberum2fF 

a=file-disposition:render 

a:file-icon:cid:icon12345 

--boundary123 

Content-Type: image/jpeg 

Content-Transfer-Encoding: binary 

Content-ID: <icon1234> 

Content-Length: 200 

 Content-Disposition: icon 

 [..small preview icon...] 

 --boundary123-- 

 


Message 2 . 100 Trying 

As appendix B.9 

 

Message 3 . 200 OK (INVITE) (SDP Answer) 

The P-Asserted-Service header is absent. 

ÅcÅc.. 

Accept-Contact: +g.oma.sip-im 

Contact: <sip:10.10.0.1:5060>;+g.oma.sip-im 

Content-Type: application/sdp 

Content-Length: 298 

v=0 

s=- 

o=- 0 0 IN IP4 10.10.1.1 

t=0 0 

c=IN IP4 10.10.1.1 

m=message 6000 TCP/MSRP * 

a=accept-types:image/jpeg 

a=path:msrp://10.10.1.1:6000/abcA7wept654;tcp 

a=recvonly 

a=setup:passive 

a=file-selector:name:"sunrise.jpg" type:image/jpeg size:60000 

a=file-transfer-id:vBnG916bdberum2fF 

 

Message 4 . ACK 

As appendix B.9 

 

Having exchanged the SDP, a TCP connection is created over which the MSRP messages 
will run (see IETF RFC 4975 [58]) and multiple MSRP messages are exchanged the file 
transfer is complete (i.e. assuming the maximum chunk size of 50K bytes). 

 


Message 5 . MSRP SEND 

MSRP d93kswow SEND 

To-Path: msrp://10.10.1.1:6000/abcA7wept654;tcp 

From-Path: msrp://10.0.1.1:4000/jshA7weztas;tcp 

Message-ID: 12339sdqwer 

Byte-Range: 1-50000/60000 

Content-Type: image/jpeg 

 

 (jpeg contents) 

 -------d93kswow+ 

 

Message 6 . MSRP 200 OK 

MSRP d93kswow 200 OK 

To-Path: msrp://10.0.1.1:4000/jshA7weztas;tcp 

From-Path: msrp://10.10.1.1:6000/abcA7wept654;tcp 

-------d93kswow+ 

 

One more chunk would be sent with the same MSRP Message-ID and including the rest of the JPEG 
file. 

 

Message 7 . BYE 

As appendix B.9. 

 

Message 8 . 200 OK (BYE) 

As appendix B.9. 

 


Appendix B.14 . RCS 1-To-1 Chat (CPM Based) 

It is assumed that a Capability Exchange has occurred. The tag Ågurn:urn-7:3gpp-
application.ims.iari.rcse.imÅh indicates that either CPM or SIMPLE based IM/Chat is 
supported. This appendix covers the CPM case. The message flow and numbering for the 
RCS CPM based Chat is identical to appendix B.12. The main difference is in the feature 
tags that are exchanged and the contents of the SDP exchange and MSRP flow. These 
differences will be highlighted in this sub-appendix with references made to messages in 
appendix B.12. 

The message contents are shown below:- 

 

Message 1 . INVITE (SDP Offer) 

ÅcÅcÅc 

P-Asserted-Service: urn:urn-7:3gpp-service.ims.icsi.oma.cpm.session 

Accept-Contact: +g.3gpp.icsi-ref=Åhurn%3Aurn-7%3A3gpp-service.ims.icsi.oma.cpm.sessionÅh 

Contact: <sip:10.0.0.1:5060>;+g.3gpp.icsi - ref="urn%3Aurn-7%3gpp-
service.ims.icsi.oma.cpm.session" 

Content-Type: application/sdp 

Content-Length: 217 

v=0 

s=- 

o=- 0 0 IN IP4 10.0.1.1 

t=0 0 

c=IN IP4 10.0.1.1 

m=message 4000 TCP/MSRP * 

a=accept-types:message/cpim 

a=accept-wrapped-types: * 

a=path:msrp://10.0.1.1:4000/jshA7weztas;tcp 

a=sendrecv 

a=setup:active 

 

Message 2 . 100 Trying 

As appendix B.12 

 


Message 3 . 200 OK (INVITE) (SDP Answer) 

ÅcÅc.. 

P-Asserted-Service: urn:urn-7:3gpp-service.ims.icsi.oma.cpm.session 

Accept-Contact: +g.3gpp.icsi-ref=Åhurn%3Aurn-7%3A3gpp-service.ims.icsi.oma.cpm.sessionÅh 

Contact: <sip:10.10.0.1:5060>;+g.3gpp.icsi - ref="urn%3Aurn-7%3gpp-
service.ims.icsi.oma.cpm.session" 

Content-Type: application/sdp 

Content-Length: 244 

v=0 

s=- 

o=- 0 0 IN IP4 10.10.1.1 

t=0 0 

c=IN IP4 10.10.1.1 

m=message 6000 TCP/MSRP * 

a=accept-types:message/cpim 

a=accept-wrapped-types: * 

a=path:msrp://10.10.1.1:6000/abcA7wept654;tcp 

a=sendrecv 

a=setup:passive 

 

Message 4 . ACK 

As appendix B.12 

 

Having exchanged the SDP, a TCP connection is created over which the MSRP messages 
will run (see IETF RFC 4975 [58]). Since this is IM/Chat, each chunk shall contain a CPIM 
header and contents. 

 


Message 5 . MSRP SEND 

MSRP d93kswow SEND 

To-Path: msrp://10.10.1.1:6000/abcA7wept654;tcp 

From-Path: msrp://10.0.1.1:4000/jshA7weztas;tcp 

Message-ID: 12339sdqwer 

Byte-Range: 1-276 

Content-Type: message/cpim 

 

From: Fred <sip+397850316900@operatorA.com;user=phone> 

To: Bob <sip:+447960306800@operatorB.com;user=phone> 

DateTime: 2000-12-13T13:40:00-08:00 

Subject: How are you? 

 

Content-Type: text/plain; charset=utf8 

Content-ID: <56789> 

How are you? HavenÅft seen you for a while. 

 -------d93kswow+ 

 

Message 6 . MSRP 200 OK 

MSRP d93kswow 200 OK 

To-Path: msrp://10.0.1.1:4000/jshA7weztas;tcp 

From-Path: msrp://10.10.1.1:6000/abcA7wept654;tcp 

-------d93kswow+ 

 

Message 7 . BYE 

As appendix B.12. 

 

Message 8 . 200 OK (BYE) 

As appendix B.12. 

 


Appendix B.15 . RCS 1-To-1 Chat (SIMPLE Based) 

It is assumed that a Capability Exchange has occurred. The tag Ågurn:urn-7:3gpp-
application.ims.iari.rcse.imÅh indicates that either CPM or SIMPLE based IM/Chat is 
supported. This appendix covers the SIMPLE case. The message flow and numbering for 
the RCS CPM based Chat is identical to appendix B.13. The main difference is in the 
feature tags that are exchanged and the contents of the SDP exchange and MSRP flow. 
These differences will be highlighted in this sub-appendix with references made to 
messages in appendix B.13. 

The message contents are shown below:- 

 

Message 1 . INVITE (SDP Offer) 

ÅcÅcÅc 

Accept-Contact: +g.oma.sip-im 

Contact: <sip:10.0.0.1:5060>;+g.oma.sip-im 

Content-Type: application/sdp 

Content-Length: 179 

v=0 

s=- 

o=- 0 0 IN IP4 10.0.1.1 

t=0 0 

c=IN IP4 10.0.1.1 

m=message 4000 TCP/MSRP * 

a=accept-types:* 

a=path:msrp://10.0.1.1:4000/jshA7weztas;tcp 

a=sendrecv 

a=setup:active 

 


Message 2 . 100 Trying 

As appendix B.13 

 

Message 3 . 200 OK (INVITE) (SDP Answer) 

ÅcÅc.. 

Accept-Contact: +g.oma.sip-im 

Contact: <sip:10.10.0.1:5060>;+g.oma.sip-im 

Content-Type: application/sdp 

Content-Length: 184 

v=0 

s=- 

o=- 0 0 IN IP4 10.10.1.1 

t=0 0 

c=IN IP4 10.10.1.1 

m=message 6000 TCP/MSRP * 

a=accept-types:* 

a=path:msrp://10.10.1.1:6000/abcA7wept654;tcp 

a=sendrecv 

a=setup:passive 

 

Message 4 . ACK 

As appendix B.13 

 

Having exchanged the SDP, a TCP connection is created over which the MSRP messages 
will run (see IETF RFC 4975 [58]) and MSRP messages are exchanged to carry the chat 
session contents. 

 


Message 5 . MSRP SEND 

MSRP d93kswow SEND 

To-Path: msrp://10.10.1.1:6000/abcA7wept654;tcp 

From-Path: msrp://10.0.1.1:4000/jshA7weztas;tcp 

Message-ID: 12339sdqwer 

Byte-Range: 1-43 

Content-Type: text/plain; charset=utf8 

 

How are you? HavenÅft seen you for a while. 

 -------d93kswow+ 

 

Message 6 . MSRP 200 OK 

MSRP d93kswow 200 OK 

To-Path: msrp://10.0.1.1:4000/jshA7weztas;tcp 

From-Path: msrp://10.10.1.1:6000/abcA7wept654;tcp 

-------d93kswow+ 

 

Message 7 . BYE 

As appendix B.13 

 

Message 8 . 200 OK (BYE) 

As appendix B.13. 

 


Appendix B.16 . RCS Geolocation Push (CPM Based) 

It is assumed that a Capability Exchange has occurred. The tag Ågurn:urn-7:3gpp-
application.ims.iari.rcse.geopushÅh indicates that Geolocation information may be transferred 
via FT which can be CPM or SIMPLE based. In addition, the feature tag for FT must also 
have been exchanged (see appendix B.12), This appendix covers the CPM case. The 
message flow and numbering for the RCS CPM based Geolocation Push is identical to 
appendix B.12. The main difference is in the feature tags that are exchanged and the 
contents of the SDP exchange and MSRP flow. These differences will be highlighted in this 
sub-appendix with references made to messages in appendix B.12. The corresponding 
SIMPLE based Geolocation push flow may be derived by applying similar changes to the 
message contents in appendix B.13. 

The message contents are shown below:- 

Message 1 . INVITE (SDP Offer) 

ÅcÅcÅc 

Accept-Contact: +g.3gpp.iari-ref=Åhurn%3Aurn-7%3A3gpp-service.ims.iari.rcs.geopushÅh 

Contact: <sip:10.0.0.1:5060>;+g.3gpp.iari - ref="urn%3Aurn-7%3gpp-service.ims.iari.rcs.geopush" 

Content-Type: application/sdp 

Content-Length: 347 

v=0 

s=- 

o=- 0 0 IN IP4 10.0.1.1 

t=0 0 

c=IN IP4 10.0.1.1 

m=message 4000 TCP/MSRP * 

a=accept-types:message/cpim 

a=accept-wrapped-types: * 

a=path:msrp://10.0.1.1:4000/jshA7weztas;tcp 

a=sendonly 

a=setup:active 

a=file-selector: type:application/rcspushlocation+xml size:500 

a=file-transfer-id:vBnG916bdberum2fF 

a=file-disposition:render 

 

Message 2 . 100 Trying 

As appendix B.12 

 


Message 3 . 200 OK (INVITE) (SDP Answer) 

ÅcÅc.. 

Accept-Contact: +g.3gpp.iari-ref=Åhurn%3Aurn-7%3A3gpp-service.ims.iari.rcs.geopushÅh 

Contact: <sip:10.10.0.1:5060>;+g.3gpp.icsi - ref="urn%3Aurn-7%3gpp-service.ims.iari.rcs.geopush " 

Content-Type: application/sdp 

Content-Length: 324 

v=0 

s=- 

o=- 0 0 IN IP4 10.10.1.1 

t=0 0 

c=IN IP4 10.10.1.1 

m=message 6000 TCP/MSRP * 

a=accept-types:message/cpim 

a=accept-wrapped-types: * 

a=path:msrp://10.10.1.1:6000/abcA7wept654;tcp 

a=recvonly 

a=setup:passive 

a=file-selector: type:application/rcspushlocation+xml size:500 

a=file-transfer-id:vBnG916bdberum2fF 

 

Message 4 . ACK 

As appendix B.12 

 

Having exchanged the SDP, a TCP connection is created over which the MSRP messages 
will run (see IETF RFC 4975 [58]). 

 


Message 5 . MSRP SEND 

MSRP d93kswow SEND 

To-Path: msrp://10.10.1.1:6000/abcA7wept654;tcp 

From-Path: msrp://10.0.1.1:4000/jshA7weztas;tcp 

Message-ID: 12339sdqwer 

Byte-Range: 1-749 

Content-Type: message/cpim 

 

From: Fred <sip+397850316900@operatorA.com;user=phone> 

To: Bob <sip:+447960306800@operatorB.com;user=phone> 

DateTime: 2000-12-13T13:40:00-08:00 

Subject: My Location Information 

 

Content-Type: application/rcspushlocation+xml 

Content-ID: <56789> 

(location XML block . 500 octets) 

 -------d93kswow+ 

 

Message 6 . MSRP 200 OK 

MSRP d93kswow 200 OK 

To-Path: msrp://10.0.1.1:4000/jshA7weztas;tcp 

From-Path: msrp://10.10.1.1:6000/abcA7wept654;tcp 

-------d93kswow+ 

 

Message 7 . BYE 

As appendix B.12. 

 

Message 8 . 200 OK (BYE) 

As appendix B.12. 

 


Appendix B.17 . RCS Geolocation Pull (CPM Based) 

It is assumed that a Capability Exchange has occurred. The tag Ågurn:urn-7:3gpp-
application.ims.iari.rcse.geopullftÅh indicates that Geolocation information may be transferred 
via FT which can be CPM or SIMPLE based. In addition, the feature tag for FT must also 
have been exchanged (see appendix B.12), This appendix covers the CPM case. The 
message flow and numbering for the RCS CPM based Geolocation Pull is identical to 
appendix B.12. The main difference is in the feature tags that are exchanged and the 
contents of the SDP exchange and MSRP flow. These differences will be highlighted in this 
sub-appendix with references made to messages in appendix B.12. The corresponding 
SIMPLE based Geolocation pull flow may be derived by applying similar changes to the 
message contents in appendix B.13. 

The message contents are shown below:- 

Message 1 . INVITE (SDP Offer) 

ÅcÅcÅc 

Accept-Contact: +g.3gpp.iari-ref=Åhurn%3Aurn-7%3A3gpp-service.ims.iari.rcs.geopullftÅh 

Contact: <sip:10.0.0.1:5060>;+g.3gpp.iari - ref="urn%3Aurn-7%3gpp-service.ims.iari.rcs.geopullft" 

Content-Type: application/sdp 

Content-Length: 342 

v=0 

s=- 

o=- 0 0 IN IP4 10.0.1.1 

t=0 0 

c=IN IP4 10.0.1.1 

m=message 4000 TCP/MSRP * 

a=accept-types:message/cpim 

a=accept-wrapped-types: * 

a=path:msrp://10.0.1.1:4000/jshA7weztas;tcp 

a=recvonly 

a=setup:active 

a=file-selector: type:application/rcspushlocation+xml 

 

Message 2 . 100 Trying 

As appendix B.12 

 


Message 3 . 200 OK (INVITE) (SDP Answer) 

ÅcÅc.. 

Accept-Contact: +g.3gpp.iari-ref=Åhurn%3Aurn-7%3A3gpp-service.ims.iari.rcs.geopullftÅh 

Contact: <sip:10.10.0.1:5060>;+g.3gpp.icsi - ref="urn%3Aurn-7%3gpp-service.ims.iari.rcs.geopullft " 

Content-Type: application/sdp 

Content-Length: 325 

v=0 

s=- 

o=- 0 0 IN IP4 10.10.1.1 

t=0 0 

c=IN IP4 10.10.1.1 

m=message 6000 TCP/MSRP * 

a=accept-types:message/cpim 

a=accept-wrapped-types: * 

a=path:msrp://10.10.1.1:6000/abcA7wept654;tcp 

a=sendonly 

a=setup:passive 

a=file-selector: type:application/rcspushlocation+xml size: 520 

a=file-transfer-id:vBnG916bdberum2fF 

a=file-disposition:render 

 

Message 4 . ACK 

As appendix B.12 

 

Having exchanged the SDP, a TCP connection is created over which the MSRP messages 
will run (see IETF RFC 4975 [58]). 

 


Message 5 . MSRP SEND 

MSRP d93kswow SEND 

To-Path: msrp://10.0.1.1:4000/jshA7weztas;tcp 

From-Path: msrp://10.10.1.1:6000/abcA7wept654;tcp 

Message-ID: 12339sdqwer 

Byte-Range: 1-779 

Content-Type: message/cpim 

 

From: Bob <sip:+447960306800@operatorB.com;user=phone> 

To: Fred <sip+397850316900@operatorA.com;user=phone> 

DateTime: 2000-12-13T13:40:00-08:00 

Subject: My Requested Location Information 

 

Content-Type: application/rcspushlocation+xml 

Content-ID: <56789> 

(location XML block . 520 octets) 

 -------d93kswow+ 

 

Message 6 . MSRP 200 OK 

MSRP d93kswow 200 OK 

To-Path: msrp://10.10.1.1:6000/abcA7wept654;tcp 

From-Path: msrp://10.0.1.1:4000/jshA7weztas;tcp 

-------d93kswow+ 

 

Message 7 . BYE 

As appendix B.12. 

 

Message 8 . 200 OK (BYE) 

As appendix B.12. 

 


Appendix B.18 . Social Presence (Overview) 

The RCS Social Presence service consists of a number of discrete parts. To aid 
understanding, this appendix provides a brief overview of those constituent parts prior to 
each of the parts being described subsequently. 

The service consists of the following :- 

. A Capability Exchange between users to indicate mutual support of Social Presence 
(see appendix B.7), 
. The publication of a Presence Information Document onto the Presence Server by 
the Presentity (see appendix B.19), 
. The subscription of a Watcher to be notified of the Presence Information of the 
Presentity (see appendix B.20). 
. The subscription by the Presentity to be notified of the list of Watchers associated 
with the PresentityÅfs Presence Document (see appendix B.21) and to be able to 
verify that new watchers may be added to the list. 


 


PUBLISH (1) (DP Offer) 

200 OK (PUBLISH) (2) 
((((((P 
Offer) 

Appendix B.19 . Publication of Social Presence Information. 

This message interchange occurs across the roaming NNI only. It is assumed that the user 
is roaming and has previously registered and is an RCS user subscribing to the Social 
Presence service. The user uploads his Presence Information to the Presence Server 
(located in the home network). The message flow is shown in figure 18. 

. 

Operator- A Operator-B 

 

 

 

 

 

Figure 18 : Publication of Presence Information 


The message contents are shown below:- 

 


Message 1 . PUBLISH 

PUBLISH sip:+447960306800@operatorB.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=12345678778 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=56ad7111 

To: <sip:+447960306800@operatorB.com;user=phone> 

CSeq: 1 PUBLISH 

Call-ID: dgh1234567@operatorB.com 

P-Access-Network-Info:3GPP-E-UTRAN-FDD;e-utran-cell-id-3gpp=1234 

P-Asserted-Identity: sip:+447960306800@operatorB.com;user=phone 

Event: presence 

Expires: 3600 

Max-Forwards:70 

P-Charging-Vector: icid-value=Åhabch+236788aÅh; orig-ioi=operatorA.com; term-ioi=operatorB.com 
Route: sip:10.10.0.1:5060;lr 

Content-Type: application/pidf+xml 

Content-Length: xx 

 

[Presence XML Document] . see RFC 3863 [56]. 

 

Message 2 . 200 OK (PUBLISH) 

SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=12345678778 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=56ad7111 

To: <sip:+447960306800@operatorB.com;user=phone>;tag=34578231 

CSeq: 1 PUBLISH 

Call-ID: dgh1234567@operatorB.com 

SIP-Etag: dx400345w 

Expires: 3000 

P-Access-Network-Info:3GPP-E-UTRAN-FDD;e-utran-cell-id-3gpp=1234 

P-Asserted-Identity: sip:+447960306800@operatorB.com;user=phone 

P-Charging-Vector: icid-value=Åhabch+236788aÅh; orig-ioi=operatorA.com; term-ioi=operatorB.com 

Content-Length: 0 

 


SUBSCRIBE (1) (DP Offer) 

NOTIFY (5) (DP Offer) 

202 Accepted (SUBSCRIBE) (2) 
((((((P 
Offer) 

NOTIFY (3) (DP Offer) 

200 OK (NOTIFY) (4) (DP Offer) 

(Authorization via the Presentity) 

200 OK (NOTIFY) (6) (DP Offer) 

Appendix B.20 . Subscription to Social Presence Information. 

This interchange allows a user (the Watcher) to subscribe to and (post authorization) receive 
the Presence Information of the target Presentity. The message flow is shown in figure 19. 
In this flow, the new Watcher firstly receives a 202 Accepted response followed by a dummy 
notification. Following authorization via the Presentity (not shown below . see appendix 
B.21), a second notification is sent. 

. 

Operator- A Operator-B 

 

 

 

 

 

 

 

 

 

 

 

Figure 19 : Subscription to Presence Information 


 

The message contents are shown below:- 

 


Message 1 . SUBSCRIBE 

SUBSCRIBE sip:+447960306800@operatorB.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=12345678778 

From: <sip:+397850316900@operatorA @operatorA.com;user=phone>;tag=56ad7111 

To: <sip:+447960306800@operatorB.com;user=phone> 

CSeq: 1 SUBSCRIBE 

Call-ID: dgh1234567@operatorA.com 

P-Access-Network-Info:3GPP-E-UTRAN-FDD;e-utran-cell-id-3gpp=1234 

P-Asserted-Identity: sip:+3977850316900@operatorA.com;user=phone 

Event: presence 

Accept: application/pidf+xml 

Expires: 3600 

Max-Forwards:70 

P-Charging-Vector: icid-value=Åhabch+236788aÅh; orig-ioi=operatorA.com; term-ioi=operatorB.com 
Route: sip:10.10.0.1:5060;lr 

Contact: <sip:10.0.0.1:5060> 

Content-Length: 0 

 

Message 2 . 202 Accepted (SUBSCRIBE) 

SIP/2.0 202 Accepted 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=12345678778 

From: <sip:+397850316900@operatorA @operatorA.com;user=phone>;tag=56ad7111 

To: <sip:+447960306800@operatorB.com;user=phone>; tag=3467894a 

P-Charging-Vector: icid-value=Åhabch+236788aÅh; orig-ioi=operatorA.com; term-ioi=operatorB.com Call-
ID: dgh1234567@operatorA.com 

CSeq: 1 SUBSCRIBE 

Event:presence 

Expires: 3600 

Contact: <sip:10.10.0.1:5060> 

Content-Length: 0 

 


Message 3 . NOTIFY 

NOTIFY sip:+397850316900@operatorA.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.10.0.1:5060;branch=567891234a 

To: <sip:+397850316900@operatorA @operatorA.com;user=phone>;tag=56ad7111 

From: <sip:+447960306800@operatorB.com;user=phone>; tag=3467894a 

Call-ID: abc1234588@operatorB.com 

CSeq: 12 NOTIFY 

Max-Forwards: 70 

Subscription-State: Pending;Expires=3600 

Event: presence 

Accept: application/pidf+xml 

Route: sip:10.0.0.1:5060;lr 

Contact: <sip:10.10.0.1:5060> 

Content-Length: 0 

 

Message 4 . 200 OK (NOTIFY) 

SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.10.0.1:5060;branch=567891234a 

To: <sip:+397850316900@operatorA @operatorA.com;user=phone>;tag=56ad7111 

From: <sip:+447960306800@operatorB.com;user=phone>; tag=3467894a 

Call-ID: abc1234588@operatorB.com 

CSeq: 12 NOTIFY 

Contact: <sip:10.0.0.1:5060> 

Content-Length: 0 

Document Management 

 


Message 5 . NOTIFY 

NOTIFY sip:+397850316900@operatorA.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.10.0.1:5060;branch=567891234a 

To: <sip:+397850316900@operatorA @operatorA.com;user=phone>;tag=56ad7111 

From: <sip:+447960306800@operatorB.com;user=phone>; tag=3467894a 

Call-ID: abc1234588@operatorB.com 

CSeq: 13 NOTIFY 

Max-Forwards: 70 

Subscription-State: Active;Expires=3600 

Event: presence 

Accept: application/pidf+xml 

Route: sip:10.0.0.1:5060;lr 

Contact: <sip:10.10.0.1:5060> 

Content-Type: application/pidf+xml 

Content-Length: xx 

 

[Presence Information document] . see RFC 3863 [56]. 

 

Message 6 . 200 OK (NOTIFY) 

SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.10.0.1:5060;branch=567891234a 

To: <sip:+397850316900@operatorA @operatorA.com;user=phone>;tag=56ad7111 

From: <sip:+447960306800@operatorB.com;user=phone>; tag=3467894a 

Call-ID: abc1234588@operatorB.com 

CSeq: 13 NOTIFY 

Contact: <sip:10.0.0.1:5060> 

Content-Length: 0 

 


SUBSCRIBE (1) (DP Offer) 

NOTIFY (5) (DP Offer) 

200 OK (SUBSCRIBE) (2) 
((((((P 
Offer) 

NOTIFY (3) (DP Offer) 

200 OK (NOTIFY) (4) (DP Offer) 

(A new Watcher requests access to the Presence Info) 

200 OK (NOTIFY) (6) (DP Offer) 

Appendix B.21 . Subscription to Social Presence Watcher Information 

This interchange allows the Presentity to subscribe to and receive the information relating to 
the Watchers of the PresentityÅfs Presence Information. This enables the Presentity to be 
informed of newly arrived Watchers and authorize them to be permitted to receive the 
Presence Information. The message flow is shown in figure 20. This message interchange 
occurs across the roaming NNI only. It is assumed that the Presentity is roaming and has 
previously registered, is an RCS user subscribing to the Social Presence service and has 
also uploaded his Presence Information. In this flow, the Presentity Watcher firstly receives a 
200 OK response followed by a notification of existing watchers. Following the arrival of a 
new Watcher (not shown below), a second notification is sent requesting authorization of the 
new Watcher to receive the Presence Information. The authorization (or otherwise) is 
enabled by the uploading of a new Presence Document as in appendix B.19 (and is not 
shown below). 

. 

Operator- A Operator-B 

 

 

 

 

 

 

 

 

 

 

 

Figure 20 : Subscription to Presence Watcher Information 


 

The message contents are shown below:- 

 


Message 1 . SUBSCRIBE 

SUBSCRIBE sip:+447960306800@operatorB.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=12345678778 

From: <sip:+447960306800@operatorB.com;user=phone>;user=phone>;tag=56ad7111 

To: <sip:+447960306800@operatorB.com;user=phone> 

CSeq: 1 SUBSCRIBE 

Call-ID: dgh1234567@operatorB.com 

P-Access-Network-Info:3GPP-E-UTRAN-FDD;e-utran-cell-id-3gpp=1234 

P-Asserted-Identity: sip:+447960306800@operatorB.com;user=phone 

Event: presence.winfo 

Accept: application/watcherinfo+xml 

Expires: 3600 

Max-Forwards:70 

P-Charging-Vector: icid-value=Åhabch+236788aÅh; orig-ioi=operatorA.com; term-ioi=operatorB.com 
Route: sip:10.10.0.1:5060;lr 

Contact: <sip:10.0.0.1:5060> 

Content-Length: 0 

 

Message 2 . 200 OK (SUBSCRIBE) 

SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=12345678778 

From: <sip: <sip:+447960306800@operatorB.com;user=phone>;user=phone>;tag=56ad7111 

To: <sip:+447960306800@operatorB.com;user=phone>; tag=123456 

CSeq: 1 SUBSCRIBE 

Call-ID: dgh1234567@operatorB.com 

P-Charging-Vector: icid-value=Åhabch+236788aÅh; orig-ioi=operatorA.com; term-ioi=operatorB.com 

Event:presence.winfo 

Expires: 3600 

Contact: <sip:10.10.0.1:5060> 

Content-Length: 0 

 


Message 3 . NOTIFY 

NOTIFY sip:+447960306800@operatorB.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.10.0.1:5060;branch=567891234a 

To: <sip: <sip:+447960306800@operatorB.com;user=phone>;user=phone>;tag=56ad7111 

From: <sip:+447960306800@operatorB.com;user=phone>; tag=123456 

Call-ID: abc1234588@operatorB.com 

CSeq: 12 NOTIFY 

Max-Forwards: 70 

Subscription-State: Active;Expires=3600 

Event: presence.winfo 

Accept: application/watcherinfo+xml 

Route: sip:10.0.0.1:5060;lr 

Contact: <sip:10.10.0.1:5060> 

Content-Type: application/watcherinfo+xml 

Content-Length: xx 

 

[Watcher Info] . see RFC 3858 [55]. 

 

Message 4 . 200 OK (NOTIFY) 

SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.10.0.1:5060;branch=567891234a 

To: <sip:+447960306800@operatorB.com;user=phone>;user=phone>;tag=56ad7111 

From: <sip:+447960306800@operatorB.com;user=phone>; tag=123456 

Call-ID: abc1234588@operatorB.com 

CSeq: 12 NOTIFY 

Contact: <sip:10.0.0.1:5060> 

Content-Length: 0 

 

A new Watcher now subscribes to the Presence Information of the Presentity and a further notification 
is sent to the Presentity containing the identity of the new Watcher. 

 


Message 5 . NOTIFY 

NOTIFY sip:+447960306800@operatorB.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.10.0.1:5060;branch=567891234789 

To: <sip:+447960306800@operatorB.com;user=phone>;user=phone>;tag=56ad7111 

From: <sip:+447960306800@operatorB.com;user=phone>; tag=123456 

Call-ID: abc1234588@operatorB.com 

CSeq: 13 NOTIFY 

Max-Forwards: 70 

Subscription-State: Active;Expires=3600 

Event: presence.winfo 

Accept: application/watcherinfo+xml 

Route: sip:10.0.0.1:5060;lr 

Contact: <sip:10.10.0.1:5060> 

Content-Type: application/watcherinfo+xml 

Content-Length: xx 

 

[Watcher Info] . see RFC 3858 [55]. 

 

Message 6 . 200 OK (NOTIFY) 

SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.10.0.1:5060;branch=567891234789 

To: <sip:+447960306800@operatorB.com;user=phone>;user=phone>;tag=56ad7111 

From: <sip:+447960306800@operatorB.com;user=phone>; tag=123456 

Call-ID: abc1234588@operatorB.com 

CSeq: 13 NOTIFY 

Contact: <sip:10.0.0.1:5060> 

Content-Length: 0 

 

On being informed of the new Watcher, the Presentity may authorize or refuse the new Watcher 
access to the Presence Information. This is done via a new PUBLISH message (not shown). In 
addition, if the new Watcher is authorised, then a further NOTIFY message is sent to reflect that fact 
that the status of the new Watcher has changed from ÅgpendingÅh to ÅgactiveÅh (see RFC 3857 [54]). This 
further NOTIFY is also not shown. 

 


SUBSCRIBE (1) (DP Offer) 

200 OK (SUBSCRIBE) (2) 
((((((P 
Offer) 

NOTIFY (3) (DP Offer) 

200 OK (NOTIFY) (4) (DP Offer) 

Appendix B.22 . Capability Discovery by Presence 

It is also possible to perform Capability Discovery as a bi-laterally agreed option via Social 
Presence. This mechanism firstly requires a Capability Exchange via OPTIONS (see 
appendix B.7) and the exchange of the following tag :- 

. +g.3gpp.iari-ref="urn%3Aurn-7%3A3gpp-application.ims.iari.rcse.dp" 


Thereafter, the set of RCS Services are exchanged via Social Presence using an 
anonymous SUBSCRIBE message. The message flow is shown in figure 21. The service 
tags are included in the message body of the NOTIFY message. The correspondence 
between OPTIONS service tags and Presence service tags is documented in clause 
2.6.1.3.1 of the GSMA RCS v.5.1 Client & Services specification ([44]). 

. 

Operator- A Operator-B 

 

 

 

 

 

 

 

Figure 21 : Capability Discovery via Presence 


 

The message contents are shown below:- 

 


Message 1 . SUBSCRIBE 

SUBSCRIBE sip:+447960306800@operatorB.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=12345678778 

From: Anonymous <sip: Anonymous@anonymous.invalid>;tag=56ad7111 

To: <sip:+447960306800@operatorB.com;user=phone> 

CSeq: 1 SUBSCRIBE 

Call-ID: dgh1234567@operatorA.com 

P-Access-Network-Info:3GPP-E-UTRAN-FDD;e-utran-cell-id-3gpp=1234 

Event: presence 

Accept: application/pidf+xml 

Expires: 0 

Max-Forwards:70 

P-Charging-Vector: icid-value=Åhabch+236788aÅh; orig-ioi=operatorA.com; term-ioi=operatorB.com 
Route: sip:10.10.0.1:5060;lr 

Contact: <sip:10.0.0.1:5060> 

Content-Length: 0 

 

Message 2 . 200 OK (SUBSCRIBE) 

SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=12345678778 

From: Anonymous <sip: Anonymous@anonymous.invalid>;tag=56ad7111 

To: <sip:+447960306800@operatorB.com;user=phone>; tag=4567hj8 

CSeq: 1 SUBSCRIBE 

Call-ID: dgh1234567@operatorA.com 

P-Charging-Vector: icid-value=Åhabch+236788aÅh; orig-ioi=operatorA.com; term-ioi=operatorB.com 

Event: presence 

Expires: 0 

Contact: <sip:10.10.0.1:5060> 

Content-Length: 0 

 


Message 3 . NOTIFY 

NOTIFY sip: Anonymous@anonymous.invalid SIP/2.0 

Via: SIP/2.0/UDP 10.10.0.1:5060;branch=567891234a 

To: Anonymous <sip: Anonymous@anonymous.invalid>;tag=56ad7111 

From: <sip:+447960306800@operatorB.com;user=phone>; tag=4567hj8 

CSeq: 12 NOTIFY 

Call-ID: abc1234588@operatorB.com 

Max-Forwards: 70 

Subscription-State: Active;Expires=0 

Event: presence 

Accept: application/pidf+xml 

Route: sip:10.0.0.1:5060;lr 

Contact: <sip:10.10.0.1:5060> 

Content-Type: application/pidf+xml 

Content-Length: xx 

 

[Presence Service Info] . see RFCs 3856 [53] & 4479 [57]. 

 

Message 4 . 200 OK (NOTIFY) 

SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.10.0.1:5060;branch=567891234a 

 

To: Anonymous <sip: Anonymous@anonymous.invalid>;tag=56ad7111 

From: <sip:+447960306800@operatorB.com;user=phone>; tag=4567hj8 

CSeq: 12 NOTIFY 

Call-ID: abc1234588@operatorB.comFromntact: <sip:10.0.0.1:5060> 

Content-Length: 0 

 


INVITE (SDP Offer, URI-List) (1) (DP Offer) 

100 Trying (2) ((((2P 
Offer) 

200 OK (INVITE) (SDP Answer) (3) 
((((((P 
Offer) 

ACK (4) 

Appendix B.23 . RCS Group Chat (from start of session) 

This appendix shows the Group Chat service when it is created at the start of a session. A 
Group Chat (as 1:1 Chat) may be CPM based or SIMPLE based (see appendices 13 & 14). 
In this example, the latter is shown. Group Chat (from session start) is applicable only to the 
roaming NNI (i.e. UE in visited network and Chat Conference Factory in the home network). 
It is assumed that the initiating UE is roaming and registered and has performed a Capability 
Exchange with the other users in the group chat session (see appendix 14). In this example, 
the UE initiating the Group Chat session sends an INVITE to the Conference Factory which 
contains a multi-part body containing SDP and a URI-List of the other users in the group 
chat session (see RFCs 5364 [59] & 5366 [60]). The message flow is shown in figure 22. 

 

Operator- A Operator-B 

 

 

 

 

 

 

 

Figure 22 : Group Chat Establishment 


 

The message contents are shown below:- 

 


Message 1 . INVITE (SDP Offer, URI-List) 

INVITE sip:Chat-Factory2@operatorB.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

To: <sip:Chat-Factory2@opertaorB.com> 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=56784321 

CSeq: 1 INVITE 

Call-ID: dgh1234567@operatorB.com 

Allow: INVITE,PRACK,ACK, CANCEL, UPDATE, PUBLISH, OPTIONS, MESSAGE, BYE, REFER, 
SUBSCRIBE, NOTITY 

P-Asserted-Identity: Tel:+447960306800 

Privacy: none 

P-Charging-Vector: icid-value=Åhabch+23456yÅh; orig-ioi=operatorA.com; term-ioi=operatorB.com 

P-Access-Network-Info:3GPP-E-UTRAN-FDD;e-utran-cell-id-3gpp=1234 

Max-Forwards:70 

P-Early-Media: supported 

Supported: 100rel, timer, precondition, histinfo, from-change 

Session-Expires: 180;refresher=uac 

Min-SE:90 

Accept-Contact: +g.oma.sip-im 

Contact: <sip:10.0.0.1:5060>;+g.oma.sip-im 

Route: sip:10.10.0.1:5060;lr 

Allow-Events: dialog 

Accept: application/sdp, message/sipfrag 

Require: recipient-list-invite 

Content-Type: multipart/mixed;boundary="boundary1" 

Content-Length: 890 

--boundary1 

Content-Type: application/sdp 

v=0 

s=- 

o=- 0 0 IN IP4 10.0.1.1 

t=0 0 

c=IN IP4 10.0.1.1 

m=message 4000 TCP/MSRP * 

a=accept-types:* 

a=path:msrp://10.0.1.1:4000/jshA7weztas;tcp 

a=sendrecv 

a=setup:active 

b=AS: 45 

--boundary1 

Content-Type: application/resource-lists+xml 


 Content-Disposition: recipient-list 

 

 <?xml version="1.0" encoding="UTF-8"?> 

 <resource-lists xmlns="urn:ietf:params:xml:ns:resource-lists" 

 xmlns:cp="urn:ietf:params:xml:ns:copyControl"> 

 <list> 

 <entry uri="sip:+331234567890@operatorC.com;user=phone" cp:copyControl="to" /> 

 <entry uri="sip:+491234567890@operatorD.com;user=phone" cp:copyControl="to" 

 cp:anonymize="true"/> 

 <entry uri="sip:+391234567890@operatorE.com;user=phone" cp:copyControl="to"/> 

 </list> 

 </resource-lists> 

 --boundary1. 

 

The XML URI-List identifies 3 other parties for the group chat session, one of whom is 
indicated as being anonymized. This will impact on the XML blocks sent to the other users 
as will be seen subsequently when each of those users are invited into the group chat 
session by the Conference Server. 

 

Message 2 . 100 Trying 

SIP/2.0 100 Trying 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

To: <sip:Chat-Factory2@opertaorB.com>;tag=123456789 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=56784321 

CSeq: 1 INVITE 

Call-ID: dgh1234567@operatorB.com 

Content-Length: 0 

 


Message 3 . 200 OK (INVITE) 

SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

To: <sip:Chat-Factory2@opertaorB.com>;tag=123456789 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=56784321 

CSeq: 1 INVITE 

Call-ID: dgh1234567@operatorB.com 

Allow: INVITE,PRACK,ACK, CANCEL, UPDATE, PUBLISH, OPTIONS, MESSAGE, BYE, REFER, 
SUBSCRIBE, NOTIFY 

P-Asserted-Identity: Tel:+447960306800 

Privacy: none 

P-Access-Network-Info:3GPP-E-UTRAN-FDD;e-utran-cell-id-3gpp=5678910 

Supported: 100rel, timer, precondition, histinfo, from-change 

Session-Expires: 150;refresher=uac 

Require:timer 

Accept-Contact: +g.oma.sip-im 

Contact: <sip:10.10.0.1:5060>;+g.oma.sip-im 

Content-Type: application/sdp 

Content-Length: 184 

 

v=0 

s=- 

o=- 0 0 IN IP4 10.10.1.1 

t=0 0 

c=IN IP4 10.10.1.1 

m=message 6000 TCP/MSRP * 

a=accept-types:* 

a=path:msrp://10.10.1.1:6000/abcA7wept654;tcp 

a=sendrecv 

a=setup:passive 

 


Message 4 . ACK 

ACK sip:Chat-Factory2@operatorB.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

To: <sip:Chat-Factory2@opertaorB.com>;tag=123456789 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=56784321 

CSeq: 1 INVITE 

Call-ID: dgh1234567@operatorB.com 

Max-Forwards:70 

Route: sip:10.0.1.1:5060;lr 

Contact: <sip:10.0.0.1:5060> 

Content-Length:0 

 

There is now a session established between the initiating UE and Chat-Factory, and a TCP 
connection can be established to carry the MSRP (as shown in appendix 15) from the UE to 
the conference resource. 

The initiating UE will also subscribe to the conference event package to be notified of 
conference progress/changes. This is identical to the flow shown in figure 13. 

The next step is for the Conference-Factory to initiate sessions to the other 3 users into the 
group chat session. The message flow is shown in figure 23. 

 


100 Trying (2) ((((2P 
Offer) 

200 OK (INVITE) (SDP Answer) (3) 
((((((P 
Offer) 

ACK (4) 

Operator- B Operator-C/D/E 

 

 

 

 

 

 

 

Figure 23 : Inviting a Target User into a Group Chat 


 

The message contents for the user in Operator CÅfs network is shown below:- 

 


Message 1 . INVITE (SDP Offer, URI-List) 

INVITE sip:+331234567890@operatorC.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.10.0.1:5060;branch=5678910defg 

From: <sip:Chat-Factory2@opertaorB.com>; tag=89101112 

To: <sip:+331234567890@operatorC.com;user=phone> 

CSeq: 10 INVITE 

Call-ID: abc1234567@operatorB.com 

Allow: INVITE,PRACK,ACK, CANCEL, UPDATE, PUBLISH, OPTIONS, MESSAGE, BYE, REFER, 
SUBSCRIBE, NOTIFY 

P-Asserted-Identity: sip:Chat-Factory2@operatorB.com 

P-Charging-Vector: icid-value=Åh1adbg23456yÅh; orig-ioi=operatorB.com 

Max-Forwards:70 

P-Early-Media: supported 

Supported: 100rel, timer, precondition, histinfo, from-change 

Session-Expires: 180;refresher=uac 

Min-SE:90 

Accept-Contact: +g.oma.sip-im 

Contact: <sip:10.10.0.1:5060>;+g.oma.sip-im 

Route: sip:10.20.0.1:5060;lr 

Allow-Events: dialog, conference 

Accept: application/sdp, message/sipfrag 

Content-Type: multipart/mixed;boundary="boundary1" 

Content-Length: 888 

--boundary1 

Content-Type: application/sdp 

v=0 

s=- 

o=- 0 0 IN IP4 10.0.1.1 

t=0 0 

c=IN IP4 10.0.1.1 

m=message 4000 TCP/MSRP * 

a=accept-types:* 

a=path:msrp://10.10.1.1:4000/jshA7weztas;tcp 

a=sendrecv 

a=setup:active 

b=AS: 45 

--boundary1 

Content-Type: application/resource-lists+xml 

Content-Disposition: recipient-list-history; handling=optional 

 <?xml version="1.0" encoding="UTF-8"?> 

 <resource-lists xmlns="urn:ietf:params:xml:ns:resource-lists" 

 xmlns:cp="urn:ietf:params:xml:ns:copyControl"> 


 <list> 

 <entry uri="sip:+331234567890@operatorC.com" cp:copyControl="to" /> 

 <entry uri="sip:anonymous@anonymous.invalid" cp:copyControl="to" 

 cp:count="1"/> 

 <entry uri="sip:+391234567890@operatorE.com" cp:copyControl="to"/> 

 </list> 

 </resource-lists> 

 --boundary1. 

 

The XML URI-List has been modified to reflect that the content is a recipient list history plus 
the anonymity of the second user. 

 

Message 2 . 100 Trying 

SIP/2.0 100 Trying 

Via: SIP/2.0/UDP 10.10.0.1:5060;branch=5678910defg 

From: <sip:Chat-Factory2@opertaorB.com>; tag=89101112 

To: <sip:+331234567890@operatorC.com;user=phone>;tag=45678912 

CSeq: 10 INVITE 

Call-ID: abc1234567@operatorB.com 

Content-Length: 0 

 


Message 3 . 200 OK (INVITE) 

SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.10.0.1:5060;branch=5678910defg 

From: <sip:Chat-Factory2@opertaorB.com>; tag=89101112 

To: <sip:+331234567890@operatorC.com;user=phone>;tag=45678912 

CSeq: 10 INVITE 

Call-ID: abc1234567@operatorB.com 

Content-Length: 0 

Allow: INVITE,PRACK,ACK, CANCEL, UPDATE, MESSAGE, BYE, REFER, SUBSCRIBE, NOTIFY 

P-Asserted-Identity: Tel:+331234567890 

Privacy: none 

P-Access-Network-Info:3GPP-E-UTRAN-FDD;e-utran-cell-id-3gpp=1234568909 

P-Charging-Vector: icid-value=Åh1adbg23456yÅh; orig-ioi=operatorB.com; term-ioi=operatorC.com 

Supported: 100rel, timer, precondition, histinfo, from-change 

Session-Expires: 150;refresher=uac 

Require:timer 

Accept-Contact: +g.oma.sip-im 

Contact: <sip:10.20.0.1:5060>;+g.oma.sip-im 

Content-Type: application/sdp 

Content-Length: 184 

 

v=0 

s=- 

o=- 0 0 IN IP4 10.10.1.1 

t=0 0 

c=IN IP4 10.10.1.1 

m=message 6000 TCP/MSRP * 

a=accept-types:* 

a=path:msrp://10.20.1.1:6000/abcA7wept654;tcp 

a=sendrecv 

a=setup:passive 

 


Message 4 . ACK 

ACK sip:+331234567890@operatorC.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.10.0.1:5060;branch=5678910defg 

From: <sip:Chat-Factory2@opertaorB.com>; tag=89101112 

To: <sip:+331234567890@operatorC.com;user=phone>;tag=45678912 

CSeq: 10 INVITE 

Call-ID: abc1234567@operatorB.com 

Max-Forwards:70 

Route: sip:10.20.1.1:5060;lr 

Contact: <sip:10.10.0.1:5060> 

Content-Length:0 

Having exchanged the SDP, a TCP connection is created over which the MSRP messages 
will run (see IETF RFC 4975 [58]) and MSRP messages are exchanged to carry the chat 
session contents from the Conference Server to the target user. 

At this point, the Group Chat session is established and MSRP messages are sent into the 
Conference Server where they are replicated and forwarded to all other users in the Group 
Chat session. 

 

 


INVITE (SDP Offer) (1) (DP Offer) 

100 Trying (2) ((((2P 
Offer) 

200 OK (INVITE) (SDP Answer) (3) 
((((((P 
Offer) 

ACK (4) 

Appendix B.24 . RCS Group Chat (from initial 1:1 Chat) 

This appendix shows the Group Chat service when it is created from an initial 1:1 Chat. As 
stated previously, the Chat may be CPM based or SIMPLE based (see appendices 13 & 14). 
In this example, the latter is shown. Group Chat (from initial 1:1 Chat) is applicable only to 
the roaming NNI (i.e. UE in visited network and Chat Conference Factory in the home 
network). It is assumed that the initiating UE is roaming and registered and has already set 
up a 1:1 with another userr (see appendix 14). The UE, initiating the Group Chat session, 
initially sends an INVITE to the Conference Factory. Thereafter, the existing user will be 
moved by a REFER message onto the Group Chat and new users will be added to the 
Group Chat via another REFER message which contains a multi-part body containing SDP 
and a URI-List of the users to be added to the group chat session (see RFCs 5364 [59] & 
5368 [61]). The message flow to create the group chat session is shown in figure 24. 

 

Operator- A Operator-B 

 

 

 

 

 

 

 

Figure 24 : Group Chat Establishment 


 

The message contents are shown below:- 

 


Message 1 . INVITE (SDP Offer, URI-List) 

INVITE sip:Chat-Factory2@operatorB.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

To: <sip:Chat-Factory2@opertaorB.com> 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=56784321 

CSeq: 1 INVITE 

Call-ID: dgh1234567@operatorB.com 

Allow: INVITE,PRACK,ACK, CANCEL, UPDATE, PUBLISH, OPTIONS, MESSAGE, BYE, REFER, 
SUBSCRIBE, NOTITY 

P-Asserted-Identity: Tel:+447960306800 

Privacy: none 

P-Charging-Vector: icid-value=Åhabch+23456yÅh; orig-ioi=operatorA.com; term-ioi=operatorB.com 

P-Access-Network-Info:3GPP-E-UTRAN-FDD;e-utran-cell-id-3gpp=1234 

Max-Forwards:70 

P-Early-Media: supported 

Supported: 100rel, timer, precondition, histinfo, from-change 

Session-Expires: 180;refresher=uac 

Min-SE:90 

Accept-Contact: +g.oma.sip-im 

Contact: <sip:10.0.0.1:5060>;+g.oma.sip-im 

Route: sip:10.10.0.1:5060;lr 

Accept: application/sdp, message/sipfrag 

Content-Type: application/sdp 

Content-Length: 

v=0 

s=- 

o=- 0 0 IN IP4 10.0.1.1 

t=0 0 

c=IN IP4 10.0.1.1 

m=message 4000 TCP/MSRP * 

a=accept-types:* 

a=path:msrp://10.0.1.1:4000/jshA7weztas;tcp 

a=sendrecv 

a=setup:active 

b=AS: 45 

 


Message 2 . 100 Trying 

SIP/2.0 100 Trying 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

To: <sip:Chat-Factory2@opertaorB.com>;tag=123456789 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=56784321 

CSeq: 1 INVITE 

Call-ID: dgh1234567@operatorB.com 

Content-Length: 0 

 

 Message 3 . 200 OK (INVITE) 

SIP/2.0 200 OK 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

To: <sip:Chat-Factory2@opertaorB.com>;tag=123456789 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=56784321 

CSeq: 1 INVITE 

Call-ID: dgh1234567@operatorB.com 

Allow: INVITE,PRACK,ACK, CANCEL, UPDATE, PUBLISH, OPTIONS, MESSAGE, BYE, REFER, 
SUBSCRIBE, NOTIFY 

P-Asserted-Identity: Tel:+447960306800 

Privacy: none 

P-Access-Network-Info:3GPP-E-UTRAN-FDD;e-utran-cell-id-3gpp=5678910 

Supported: 100rel, timer, precondition, histinfo, from-change 

Session-Expires: 150;refresher=uac 

Require:timer 

Accept-Contact: +g.oma.sip-im 

Contact: <sip:10.10.0.1:5060>;+g.oma.sip-im 

Content-Type: application/sdp 

Content-Length: 184 

 

v=0 

s=- 

o=- 0 0 IN IP4 10.10.1.1 

t=0 0 

c=IN IP4 10.10.1.1 

m=message 6000 TCP/MSRP * 

a=accept-types:* 

a=path:msrp://10.10.1.1:6000/abcA7wept654;tcp 

a=sendrecv 

a=setup:passive 

 


REFER (1) (DP Offer) 

202 Accepted (REFER) (2) ((((2P 
Offer) 

Message 4 . ACK 

ACK sip:Chat-Factory2@operatorB.com;user=phone SIP/2.0 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

To: <sip:Chat-Factory2@opertaorB.com>;tag=123456789 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=56784321 

CSeq: 1 INVITE 

Call-ID: dgh1234567@operatorB.com 

Max-Forwards:70 

Route: sip:10.0.1.1:5060;lr 

Contact: <sip:10.0.0.1:5060> 

Content-Length:0 

 

There is now a session established between the initiating UE and Chat-Factory, and a TCP 
connection can be established to carry the MSRP (as shown in appendix 15) from the UE to 
the conference resource. 

The initiating UE will also subscribe to the conference event package to be notified of 
conference progress/changes. This is identical to the flow shown in figure 13. 

The next step is for the controlling UE to move the existing other user (on the 1:1 chat) to the 
group chat followed by adding new users to the group chat. Both are accomplished via a 
REFER message, as shown in figure 25. 

 

Operator- A Operator-B 

 

 

 

 

Figure 25 : Referring to a User In Conference 


 

The message contents are as shown below, and cover both cases (moving the existing user 
and adding new users). 

 


Message 1a . REFER (to an existing party) 

REFER sip: Chat-factory2@operatorB.com SIP/2.0 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=564321 

To: <sip:Chat-factory2@operatorB.com> 

P-Charging-Vector: icid-value=Åhabch+23456yÅh; orig-ioi=operatorA.com; term-ioi=operatorB.com 

Call-ID: 56789102@operatorB.com 

CSeq: 1 REFER 

P-Asserted-Identity: Tel:+447960306800 

P-Access-Network-Info:3GPP-E-UTRAN-FDD;e-utran-cell-id-3gpp=1234 

Privacy: Id 

Max-Forwards: 70 

Refer-To:<sip: 
+397850316900@operatorA.com;user=phone;method=INVITE?Replaces=dgh123456 %40operatorA.
com%3Bto-tag%3Dade2345%3Bfrom-tag%3D5678ab34?Require=replaces> 

Referred-By: sip:+447960306800@operatorB.com;user=phone 

Refer-Sub: false 

Accept: application/sdp, message/sipfrag 

Require: norefersub 

Route: sip:10.10.0.1:5060;lr 

Contact: <sip:10.0.0.1:5060> 

Content-Length: 0 

 

Message 2a . 202 ACCEPTED 

SIP/2.0 202 Accepted 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=564321 

To: <sip:conference-factory1@operatorB.com>;tag=7824567 

P-Charging-Vector: icid-value=Åhabch+23456yÅh; orig-ioi=operatorA.com; term-ioi=operatorB.com 

Refer-Sub: false 

Call-ID: 56789102@operatorB.com 

CSeq: 1 REFER 

Contact: <sip:10.10.0.1:5060> 

Content-Length: 0 

The above REFER message causes the chat factory to initiate a session to the cited (Refer-To) target 
which will contain the following headers (copied/derived from the REFER message). 

Require: replaces 

Referred-By: <sip:+447960306800@operatorB.com;user=phone> 

Replaces: dgh1234565@operatorA.com;to-tag=ade2345;from-tag=5678ab34 

Contact: <conference-factory1@operatorB.com>;isfocus 

 


The target will accept this session and redirect the existing media endpoint to the chat factory, prior to 
sending a BYE to terminate the previous 2-way session. 

In addition, the controlling UE will be notified of progress (having subscribed to the conference 
package . see figure 13). 

 

Message 1b . REFER (to new users) 

REFER sip: conference-factory1@operatorB.com SIP/2.0 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=564321 

To: <sip:conference-factory1@operatorB.com> 

P-Charging-Vector: icid-value=Åhabch+23456yÅh; orig-ioi=operatorA.com; term-ioi=operatorB.com 

Call-ID: 56789102@operatorB.com 

CSeq: 2 REFER 

P-Asserted-Identity: Tel:+447960306800 

P-Access-Network-Info:3GPP-E-UTRAN-FDD;e-utran-cell-id-3gpp=1234 

Privacy: Id 

Max-Forwards: 70 

Refer-To: cid:cn35t8jf02@operatorB.com 

Refer-Sub: false 

Accept: application/sdp, message/sipfrag 

Require: multiple-refer, norefersub 

Referred-By: <sip:+447960306800@operatorB.com;user=phone> 

Route: sip:10.10.0.1:5060;lr 

Contact: <sip:10.0.0.1:5060> 

Content-Type: application/resource-lists+xml 

Content-Disposition: recipient-list 

Content-ID: <cn35t8jf02@operatorB.com> 

Content-Length: 539 

 

 <?xml version="1.0" encoding="UTF-8"?> 

 <resource-lists xmlns="urn:ietf:params:xml:ns:resource-lists" 

 xmlns:cp="urn:ietf:params:xml:ns:copyControl"> 

 <list> 

 <entry uri="sip:+331234567890@operatorC.com;user=phone" cp:copyControl="to" /> 

 <entry uri="sip:+491234567890@operatorD.com;user=phone" cp:copyControl="to" 

 cp:anonymize="true"/> 

 <entry uri="sip:+391234567890@operatorE.com;user=phone" cp:copyControl="to"/> 

 </list> 

 </resource-lists> 

 

 

 


Message 2b . 202 ACCEPTED 

SIP/2.0 202 Accepted 

Via: SIP/2.0/UDP 10.0.0.1:5060;branch=1234567abcd 

From: <sip:+447960306800@operatorB.com;user=phone>;tag=564321 

To: <sip:conference-factory1@operatorB.com>;tag=7824567 

P-Charging-Vector: icid-value=Åhabch+23456yÅh; orig-ioi=operatorA.com; term-ioi=operatorB.com 

Refer-Sub: false 

Call-ID: 56789102@operatorB.com 

CSeq: 1 REFER 

Contact: <sip:10.10.0.1:5060> 

Content-Length: 0 

 

The above message causes the conference factory to initiate a session to the cited (Refer-To) targets 
which will add that party to the chat conference. The CONTACT header will contain the ÅgisfocusÅh 
parameter (RFC 3840 [52]). The addition of these parties is as shown in figure 23. In addition, the 
controlling user will be notified of conference progress via SIP NOTIFY messages (via subscription to 
conference event package). 

 


Appendix C The List of Selected Option Items for the NNI 
(Informative) 

This annex is provides a cross reference to annex C of 3GPP TS 29.165[1] which provides 
a list of items that are recommended to be selected by inter-operator agreements for the 
interconnection between IMS operators using the II-NNI. The applicability of option items are 
selected based on main body of this document. Table 34 provides the list of option items 
selected by this document. 

The format table 34 is as follows :- 

. The first column is the option item as listed in annex C of 3GPP TS 29.165 [1], 
. The second column provides a reference to the corresponding table in annex C of 
3GPP TS 29.165 [1]. 
. The third column describes the applicability of the option item in this profile in terms 
of ÅgyesÅh (applicable), ÅgnoÅh (not applicable) and ÅgoptionalÅh (items that are outside the 
scope of this profile but may be supported by bilateral agreement), 
. The fourth column provides further details / additional information including 
references to clauses in this document. 


 

Option Item 

Reference 

Applicability 

Details / Further info 

Roaming II-NNI 
support 

C.3.0.1 

Yes 

Roaming is supported in this profile. 

Local break out is assumed. 

RAVEL is applicable (subject to bilateral 
agreement between the HPLMN & 
VPLMN operators). 

Non roaming II-NNI 
support 

C.3.0.1 

Yes 

Interconnect NNI is supported. 

INFO Method 

C.3.1.1 

Optional 

See clause 4 of this profile. 

MESSAGE Method 

C.3.1.1 

Yes 

See clause 4 of this profile. Used for 
MMTEL and RCS services. 

REFER Method 

C.3.1.1 

Yes 

See clause 4 of this profile. Used for 
MMTEL and RCS services. 

SIP Overload Control 

C.3.1.A 

No 

 

Feedback Control 

C.3.1.A 

No 

 

Event Control 

C.3.1.A 

No 

 

Negotiation of 
resource reservation 
(precondition) 

C.3.1.2 

Yes 

See clause 10.1 of this profile. 

SIP Session Timer 

C.3.1.2.A 

Yes 

 

Replacing SIP 
Dialogs (replaces) 

C.3.1.3 

Yes 

Used for MMTel & RCS services. 

Session Participation 
(join) 

C.3.1.4 

No 

Not required for MMTel / RCS services 




Option Item 

Reference 

Applicability 

Details / Further info 

Conveying 
capabilities of UE 

C.3.1.5 

Yes 

 

Authorization of 
early media. 

C.3.1.5.A 

Yes 

P-Early-Media header is supported in this 
profile. 

Managing the 
indication of the 
asserted service 

(P-Asserted-Service 
header field) 

C.3.1.6 

Yes 

P-Asserted-Service header is supported 
in this profile . identifying MMTel and 
RCS services. 

Overlap signalling 

(in-dialog / multiple 
INVITE) 

C.3.1.7 

No 

Overlap signalling is not in scope. See 
clause 6. 

MIME Type 

C.3.1.7.A 

Yes 

See clause 8. 

Limitation of 
maximum length of a 
SIP message body 

C.3.1.7.B 

Yes 

See clause 8. 

UDP 

C.3.1.8 

Yes 

See clause 5. 

TCP 

C.3.1.8 

Yes 

See clause 5. 

SCTP 

C.3.1.8 

Optional 

See clause 5. 

Speech media 
(m=audio) 

C.3.1.9 

Yes 

Speech is supported (IR.92) 

Video media 
(m=video) 

C.3.1.9 

Yes 

Video is supported (IR.94, IR.90) 

Other Media 

C.3.1.9 

Yes 

Message & Text (T.140) are supported . 
see section 10. 

RTP/AVPF 

C.3.1.9 

Yes 

See clause 10. Used for video calls 
(IR.94) 

Transmission Control 
Protocol 

C.3.1.9 

Yes 

Used for MSRP support for RCS services. 

Other user plane 
protocols 

C.3.1.9 

No 

 

DTMF Transport 
(telephone-event) 

C.3.1.10 

Yes 

See clause 10.2.4. 

DTMF Transport 
(SIP INFO 
mechanism) 

C.3.1.10 

No 

 

Subaddress 

("isub" parameter) 

C.3.1.10A 

Optional 

Not a mandatory IR.92 service 

IPv4 

C.3.1.11 

Yes 

See clause 11 

IPv6 

C.3.1.11 

Yes 

See clause 11 

Malicious 
Communication 

C.3.1.12 

Optional 

Not a mandatory IR.92 service 




Option Item 

Reference 

Applicability 

Details / Further info 

Identification (MCID) 

Originating 
Identification 
Presentation (OIP) 
and Originating 
Identification 
Restriction (OIR) 

C.3.1.12 

Yes 

Mandatory IR.92 service 

Terminating 
Identification 
Presentation (TIP) 
and Terminating 
Identification 
Restriction (TIR) 

C.3.1.12 

Yes 

Mandatory IR.92 service 

Anonymous 
Communication 
Rejection (ACR) 

C.3.1.12 

Optional 

Not a mandatory IR.92 service 

Communication 
DIVersion (CDIV) 
excluding 
Communication 
Diversion Notification 
(CDIVN) 

C.3.1.12 

Yes 

Mandatory IR.92 service 

Communication 
Waiting (CW) 

C.3.1.12 

Yes 

Mandatory IR.92 service 

Communication 
HOLD (HOLD) 

C.3.1.12 

Yes 

Mandatory IR.92 service 

Message Waiting 
Indication (MWI) 

C.3.1.12 

Yes 

Mandatory IR.92 service 

Incoming 
Communication 
Barring (ICB) 

C.3.1.12 

Yes 

Mandatory IR.92 service 

Outgoing 
Communication 
Barring (OCB) 

C.3.1.12 

Yes 

Mandatory IR.92 service 

Completion of 
Communications to 
busy subscriber 
(CCBS) 

C.3.1.12 

Optional 

Not a mandatory IR.92 service 

Completion of 
Communications No 
Reply (CCNR) 

C.3.1.12 

Optional 

Not a mandatory IR.92 service 

Explicit 
Communication 
Transfer (ECT) 

C.3.1.12 

Optional 

Not a mandatory IR.92 service 

Customized Alerting 
Tone (CAT) 

C.3.1.12 

Optional 

Not a mandatory IR.92 service 




Option Item 

Reference 

Applicability 

Details / Further info 

Customized Ringing 
Signal (CRS) 

C.3.1.12 

Optional 

Not a mandatory IR.92 service 

Closed User Group 
(CUG) 

C.3.1.12 

Optional 

Not a mandatory IR.92 service 

Personal Network 
Management (PNM) 

C.3.1.12 

Optional 

Not a mandatory IR.92 service 

Three Party (3PTY) 

C.3.1.12 

Optional 

Not a mandatory IR.92 service 

Conference (CONF) 

C.3.1.12 

Yes 

Mandatory IR.92 service (Ad-Hoc 
Conference). 

Flexible Alerting (FA) 

C.3.1.12 

Optional 

Not a mandatory IR.92 service 

Announcements 
(during session 
establishment) 

C.3.1.12 

Yes 

Both P-Early-Media and Alert-Info 
headers are supported in this profile. 

Announcements 
(during established 
session) 

C.3.1.12 

Yes 

Media stream can be modified mid call in 
this profile. Also, Call-Info header is 
supported. 

Announcements 
(when 
communication 
request rejected) 

C.3.1.12 

Yes 

All 3 cited options in 3GPP TS 29.165 are 
supported in this profile. 

Advice of Charge 
(AOC) 

C.3.1.12 

Optional 

Not a mandatory IR.92 service 

Completion of 
Communications Not 
Logged In (CCNL) 

C.3.1.12 

Optional 

Not a mandatory IR.92 service 

Presence Service 

C.3.1.12 

Yes 

IR.90 service 

Messaging (Pager 
Mode) 

C.3.1.12 

Yes 

IR.90 service 

Messaging (Session 
Mode) 

C.3.1.12 

Yes 

IR.90 service 

Messaging (Session 
Mode Conferences) 

C.3.1.12 

Yes 

IR.90 service 

Delivery of original 
destination identity 

C.3.1.12 

No 

 

Other additional 
service using other 
SIP extensions 

C.3.1.12 

No 

None identified in this profile 

Optimal Media 
Routing 

C.3.1.13 

Yes 

OMR is applicable to this profile for 
RAVEL 

Applying Forking 

C.3.1.13 

Optional 

See clause 10.1. 

Transfer of IP 
multimedia service 

C.3.1.13 

Optional 

 




Option Item 

Reference 

Applicability 

Details / Further info 

tariff information 

m=line 

C.3.1.14 

Yes 

See clause 10.4. 

b=line 

C.3.1.14 

Yes 

See clause 10.4. 

a=line 

C.3.1.14 

Yes 

See clause 10.4. 

Public Safety 
Answering Point 
(PSAP) Callback 

C.3.1.15 

No 

PSAP callback is not in IR.92 

IMS AKA plus IPsec 
ESP 

C.3.2.1 

Yes 

Aligns with IR.92 

SIP digest plus 
check of IP 
association 

C.3.2.1 

Optional 

 

SIP digest plus Proxy 
Authentication 

C.3.2.1 

Optional 

 

SIP digest with TLS 

C.3.2.1 

Optional 

 

Inter-operator 
accounting 

C.3.2.1A 

Yes 

 

Inter-operator 
accounting for the 
transit scenario 

C.3.2.1A 

Yes 

 

The key of service 
profile for HSS query 
(P-Profile-Key 
header field) 

C.3.2.2 

Optional 

Optional header . see clause 4.5. 

Dial string 

( "user=dialstring " 
parameter) 

C.3.2.3 

No 

 

Communication 
Diversion Notification 
(CDIVN) 

C.3.2.4 

Optional 

Not in IR.92 

Unstructured 
Supplemnentary 
Service Data (USSD) 

C.3.2.4 

Optional 

Not in IR.92 

IMS Centralized 
Services (ICSI) 

C.3.2.5 

Yes 

 

PS to CS Single 
Radio Voice Call 
Continuity (SRVCC) 

C.3.2.5 

No 

 

Single Radio Video 
Call Continuity 

C.3.2.5 

No 

 

Inter-UE Transfer 
(IUT) 

C.3.2.5 

No 

 




Option Item 

Reference 

Applicability 

Details / Further info 

CS to PS Single 
Radio Voice Call 
Continuity (SRVCC) 

C.3.2.5 

No 

 

PS to CS Dual Radio 
Voice Call Continuity 
(DRVCC) 

C.3.2.5 

No 

 

CS to PCS Dual 
Radio Voice Call 
Continuity (DRVCC) 

C.3.2.5 

No 

 

Registration of bulk 
number contacts 

C.3.2.6 

No 

 

NOTIFY method 

C.3.3.1 

Yes 

See clause 4. Used in IMS registration, 
MMTEL and RCS services 

SUBSCRIBE method 

C.3.3.1 

Yes 

See clause 4. Used in IMS registration, 
MMTEL and RCS services 

PUBLISH method 

C.3.3.1 

Yes 

See clause 4. Used for RCS. 

Inter-operator 
accounting 

C.3.3.2 

Yes 

 

Inter-operator 
accounting for the 
transit sceenario 

C.3.3.2 

Yes 

 

Globally Routable 
User Agent URIs 
(gruu) 

C.3.3.3 

No 

 

Media Feature Tags 

C.3.3.4 

Yes 

See Appendix B. 

User to User Call 
Control Information 
in SIP for ISDN 
interworking (uui) 

C.3.3.5 

No 

Applicable if transit traffic between fixed 
line IMS cores . which is not in scope of 
this profile. 

Private network 
traffic 

(P-Private-Network-
Indication header 
field) 

C.3.3.6 

Optional 

 

SIP URI 

C.3.3.7 

Yes 

See clause 7. 

Tel URI 

C.3.3.7 

No 

See clause 7. 

IM URI 

C.3.3.7 

No 

See clause 7. 

PRES URI 

C.3.3.7 

No 

See clause 7. 




Option Item 

Reference 

Applicability 

Details / Further info 

Number Portability 
Routing Number 

("rn" and "npdi" 
parameter) 

C.3.3.7 

Optional 

 

Calling PartyÅfs 
Category 

("cpc" parameter) 

C.3.3.7 

Optional 

 

Originating Line 
Information 

("oli" parameter) 

C.3.3.7 

Optional 

 

Support of out-of-
dialog OPTIONS 
method 

C.3.3.8 

Yes. 

See clause 4. Applicable to RCS 
Capability Exchange 



Table 1: Option Items Selection 

 

 


Document Management 

Document History 

Version 

Date 

Brief Description of Change 

Approval 
Authority 

Editor / 
Company 

.1 

7 
November 
2014 

New DRAFT PRD submitted for 
IREG WG approval 

IREG67 

Mark McGinley, 
AT&T 

1.0 

16 
February 
2015 

PSMC Approval (post PSMC 
#130) 

PSMC 

Mark McGinley, 
AT&T 

 

 

 

 

 



Other Information 

Type 

Description 

Document Owner 

IREG 

Editor / Company 

Mark McGinley, AT&T 



 

It is our intention to provide a quality product for your use. If you find any errors or omissions, 
please contact us with your comments. You may notify us at prd@gsm.org 

Your comments or suggestions & questions are always welcome. 


